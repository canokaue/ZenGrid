{"version":3,"sources":["webpack:///./node_modules/xterm/lib/Viewport.js","webpack:///./node_modules/xterm/lib/ui/ScreenDprMonitor.js","webpack:///./node_modules/xterm/lib/WindowsMode.js","webpack:///./node_modules/xterm/lib/MouseZoneManager.js","webpack:///./node_modules/xterm/lib/renderer/atlas/Types.js","webpack:///./node_modules/xterm/lib/renderer/LinkRenderLayer.js","webpack:///./node_modules/xterm/lib/common/CircularList.js","webpack:///./node_modules/xterm/lib/SelectionModel.js","webpack:///./node_modules/xterm/lib/renderer/ColorManager.js","webpack:///./node_modules/xterm/lib/InputHandler.js","webpack:///./node_modules/xterm/lib/common/Lifecycle.js","webpack:///./node_modules/xterm/lib/common/Platform.js","webpack:///./node_modules/xterm/lib/CharMeasure.js","webpack:///./node_modules/xterm/lib/renderer/GridCache.js","webpack:///./node_modules/xterm/lib/BufferSet.js","webpack:///./node_modules/xterm/lib/renderer/CharacterJoinerRegistry.js","webpack:///./node_modules/xterm/lib/common/Clone.js","webpack:///./node_modules/xterm/lib/common/EventEmitter2.js","webpack:///./node_modules/xterm/lib/BufferReflow.js","webpack:///./node_modules/xterm/lib/renderer/dom/DomRendererRowFactory.js","webpack:///./node_modules/xterm/lib/renderer/BaseRenderLayer.js","webpack:///./node_modules/xterm/lib/BufferLine.js","webpack:///./node_modules/xterm/lib/Clipboard.js","webpack:///./node_modules/xterm/lib/AccessibilityManager.js","webpack:///./node_modules/xterm/lib/renderer/SelectionRenderLayer.js","webpack:///./node_modules/xterm/lib/ui/RenderDebouncer.js","webpack:///./node_modules/xterm/lib/renderer/dom/DomRenderer.js","webpack:///./node_modules/xterm/lib/Buffer.js","webpack:///./node_modules/xterm/lib/ui/Lifecycle.js","webpack:///./node_modules/xterm/lib/renderer/Renderer.js","webpack:///./node_modules/xterm/lib/core/input/Keyboard.js","webpack:///./node_modules/xterm/lib/renderer/atlas/CharAtlasCache.js","webpack:///./node_modules/xterm/lib/SoundManager.js","webpack:///./node_modules/xterm/lib/renderer/atlas/DynamicCharAtlas.js","webpack:///./node_modules/xterm/lib/public/Terminal.js","webpack:///./node_modules/xterm/lib/common/TypedArrayUtils.js","webpack:///./node_modules/xterm/lib/common/data/EscapeSequences.js","webpack:///./node_modules/xterm/lib/core/input/TextDecoder.js","webpack:///./node_modules/xterm/lib/renderer/atlas/NoneCharAtlas.js","webpack:///./node_modules/xterm/lib/renderer/atlas/BaseCharAtlas.js","webpack:///./node_modules/xterm/lib/Strings.js","webpack:///./node_modules/xterm/lib/renderer/TextRenderLayer.js","webpack:///./node_modules/xterm/lib/common/EventEmitter.js","webpack:///./node_modules/xterm/lib/SelectionManager.js","webpack:///./node_modules/xterm/lib/renderer/atlas/StaticCharAtlas.js","webpack:///./node_modules/xterm/lib/renderer/atlas/CharAtlasUtils.js","webpack:///./node_modules/@jupyterlab/terminal/lib/widget.js","webpack:///./node_modules/xterm/lib/renderer/CursorRenderLayer.js","webpack:///./node_modules/xterm/lib/renderer/atlas/CharAtlasGenerator.js","webpack:///./node_modules/xterm/lib/CompositionHelper.js","webpack:///./node_modules/xterm/lib/CharWidth.js","webpack:///./node_modules/xterm/lib/core/data/Charsets.js","webpack:///./node_modules/xterm/lib/Terminal.js","webpack:///./node_modules/xterm/lib/handlers/AltClickHandler.js","webpack:///./node_modules/xterm/lib/EscapeSequenceParser.js","webpack:///./node_modules/xterm/lib/renderer/atlas/LRUMap.js","webpack:///./node_modules/xterm/lib/Linkifier.js","webpack:///./node_modules/xterm/lib/MouseHelper.js","webpack:///./node_modules/xterm/lib/addons/fit/fit.js"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","Lifecycle_1","Lifecycle_2","FALLBACK_SCROLL_BAR_WIDTH","Viewport","_super","_terminal","_viewportElement","_scrollArea","_charMeasure","_this","call","scrollBarWidth","_currentRowHeight","_lastRecordedBufferLength","_lastRecordedViewportHeight","_lastRecordedBufferHeight","_lastScrollTop","_wheelPartialScroll","_refreshAnimationFrame","_ignoreNextScrollEvent","offsetWidth","register","addDisposableDomListener","_onScroll","bind","setTimeout","syncScrollArea","onThemeChanged","colors","style","backgroundColor","background","css","_refresh","requestAnimationFrame","_innerRefresh","height","renderer","dimensions","scaledCellHeight","window","devicePixelRatio","offsetHeight","newBufferHeight","Math","round","canvasHeight","scrollTop","buffer","ydisp","lines","length","newScrollTop","ev","offsetParent","newRow","diff","scrollLines","onWheel","amount","_getPixelsScrolled","preventDefault","deltaY","deltaMode","WheelEvent","DOM_DELTA_LINE","DOM_DELTA_PAGE","rows","getLinesScrolled","DOM_DELTA_PIXEL","floor","abs","onTouchStart","_lastTouchY","touches","pageY","onTouchMove","Disposable","ScreenDprMonitor","apply","arguments","_currentDevicePixelRatio","setListener","listener","_listener","clearListener","_outerListener","_updateDpr","dispose","_resolutionMediaMatchList","removeListener","matchMedia","addListener","undefined","Buffer_1","applyWindowsMode","terminal","onLineFeed","line","get","ybase","y","lastChar","cols","CHAR_DATA_CODE_INDEX","NULL_CELL_CODE","WHITESPACE_CELL_CODE","nextLine","isWrapped","HOVER_DURATION","MouseZoneManager","_zones","_areZonesActive","_tooltipTimeout","_currentZone","_lastHoverCoords","element","e","_onMouseDown","_mouseMoveListener","_onMouseMove","_mouseLeaveListener","_onMouseLeave","_clickListener","_onClick","_deactivate","add","zone","push","_activate","clearAll","start","end","i","y1","y2","leaveCallback","splice","addEventListener","removeEventListener","pageX","_onHover","_findZoneEventAt","clearTimeout","hoverCallback","_onTooltip","tooltipCallback","_initialSelectionLength","getSelection","willLinkActivate","stopImmediatePropagation","currentSelectionLength","clickCallback","coords","mouseHelper","getCoords","screenElement","charMeasure","x","x1","x2","MouseZone","DEFAULT_COLOR","INVERTED_DEFAULT_COLOR","DIM_OPACITY","CHAR_ATLAS_CELL_SPACING","BaseRenderLayer_1","Types_1","CharAtlasUtils_1","LinkRenderLayer","container","zIndex","_state","linkifier","onLinkHover","_onLinkHover","onLinkLeave","_onLinkLeave","resize","dim","reset","_clearCurrentLink","clearCells","middleRowCount","fg","_ctx","fillStyle","_colors","is256Color","ansi","foreground","fillBottomLineAtCells","BaseRenderLayer","EventEmitter2_1","CircularList","_maxLength","onDeleteEmitter","EventEmitter2","onInsertEmitter","onTrimEmitter","_array","_startIndex","_length","event","enumerable","configurable","set","newMaxLength","newArray","min","_getCyclicIndex","newLength","index","fire","recycle","Error","pop","deleteCount","items","_i","countToTrim","trimStart","count","shiftElements","offset","expandListBy","SelectionModel","clearSelection","selectionStart","selectionEnd","isSelectAllActive","selectionStartLength","areSelectionValuesReversed","startPlusLength","max","onTrim","DEFAULT_FOREGROUND","fromHex","DEFAULT_BACKGROUND","DEFAULT_CURSOR","DEFAULT_CURSOR_ACCENT","DEFAULT_SELECTION","rgba","DEFAULT_ANSI_COLORS","v","r","g","toPaddedHex","c","ch","parseInt","slice","s","toString","ColorManager","document","allowTransparency","canvas","createElement","width","getContext","globalCompositeOperation","_litmusColor","createLinearGradient","cursor","cursorAccent","selection","setTheme","theme","_parseColor","black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite","fallback","console","warn","fillRect","data","getImageData","EscapeSequences_1","Charsets_1","CharWidth_1","EscapeSequenceParser_1","TypedArrayUtils_1","TextDecoder_1","BufferLine_1","GLEVEL","DECRQSS","_data","Uint32Array","hook","collect","params","flag","put","concat","subarray","unhook","utf32ToString","handler","C0","ESC","pt","scrollBottom","STYLES","getOption","error","InputHandler","_parser","EscapeSequenceParser","_parseBuffer","_stringDecoder","StringToUtf32","_workCell","CellData","_onCursorMove","_onData","_onLineFeed","setCsiHandlerFallback","String","fromCharCode","setEscHandlerFallback","setExecuteHandlerFallback","code","setOscHandlerFallback","identifier","setPrintHandler","print","setCsiHandler","insertChars","cursorUp","cursorDown","cursorForward","cursorBackward","cursorNextLine","cursorPrecedingLine","cursorCharAbsolute","cursorPosition","cursorForwardTab","eraseInDisplay","eraseInLine","insertLines","deleteLines","deleteChars","scrollUp","scrollDown","eraseChars","cursorBackwardTab","charPosAbsolute","hPositionRelative","repeatPrecedingCharacter","sendDeviceAttributes","linePosAbsolute","vPositionRelative","hVPosition","tabClear","setMode","resetMode","charAttributes","deviceStatus","softReset","setCursorStyle","setScrollRegion","saveCursor","restoreCursor","setExecuteHandler","BEL","bell","LF","lineFeed","VT","FF","CR","carriageReturn","BS","backspace","HT","tab","SO","shiftOut","SI","shiftIn","C1","IND","NEL","HTS","tabSet","setOscHandler","setTitle","setEscHandler","reverseIndex","keypadApplicationMode","keypadNumericMode","setgLevel","selectDefaultCharset","_loop_1","this_1","selectCharset","CHARSETS","setErrorHandler","state","setDcsHandler","parse","cursorStartX","cursorStartY","debug","log","decode","chWidth","charset","screenReaderMode","options","wraparoundMode","insertMode","curAttr","curAttrData","bufferRow","updateRange","pos","wcwidth","charCodeAt","emit","stringFromCodePoint","getWidth","addCodepointToCell","scroll","insertCells","getNullCell","setCellFromCodePoint","NULL_CELL_WIDTH","bg","addCsiHandler","callback","addOscHandler","ident","convertEol","originalX","nextStop","eraseAttrData","param","col","row","_eraseInBufferLine","clearWrap","replaceCells","_resetBufferLine","j","scrollBackSize","scrollBottomRowsOffset","scrollBottomAbsolute","getBlankLine","deleteCells","DEFAULT_ATTR_DATA","prevStop","loadCell","content","is","tabs","applicationCursor","setgCharset","DEFAULT_CHARSET","savedCols","originMode","applicationKeypad","viewport","x10Mouse","vt200Mouse","normalMouse","mouseEvents","classList","selectionManager","disable","sendFocus","utfMouse","sgrMouse","urxvtMouse","cursorHidden","buffers","activateAltBuffer","refresh","showCursor","bracketedPasteMode","remove","enable","activateNormalBuffer","l","attr","AttributeData","fromColorRGB","glevel","charsets","setOption","isBlinking","savedX","savedY","savedCurAttrData","handleTitle","collectAndFlag","level","_disposables","_isDisposed","forEach","unregister","indexOf","isNode","navigator","userAgent","platform","isFirefox","isSafari","test","isMSIE","isMac","contains","isIpad","isIphone","isMSWindows","isLinux","arr","el","CharMeasure","parentElement","_onCharSizeChanged","_document","_parentElement","_measureElement","textContent","setAttribute","appendChild","_width","_height","measure","fontFamily","fontSize","geometry","getBoundingClientRect","adjustedHeight","ceil","GridCache","cache","clear","BufferSet","_onBufferActivate","_normal","Buffer","fillViewportRows","_alt","_activeBuffer","setupTabStops","activeBuffer","inactiveBuffer","fillAttr","newCols","newRows","JoinedCellData","firstCell","chars","combinedData","isCombined","getChars","getCode","setFromCharData","getAsCharData","CharacterJoinerRegistry","_characterJoiners","_nextCharacterJoinerId","registerCharacterJoiner","joiner","id","deregisterCharacterJoiner","joinerId","getJoinedCharacters","ranges","lineStr","translateToString","rangeStartColumn","currentStringIndex","rangeStartStringIndex","rangeAttrFG","getFg","rangeAttrBG","getBg","getTrimmedLength","joinedRanges","_getJoinedRanges","WHITESPACE_CELL_CHAR","startIndex","endIndex","lineData","startCol","text","substring","joinerRanges","_mergeRanges","_stringRangesToCellRanges","currentRangeIndex","currentRangeStarted","currentRange","length_1","getString","newRange","inRange","range","clone","val","depth","clonedObject","isArray","key","_listeners","_event","disposable","queue","reflowLargerGetLinesToRemove","oldCols","bufferAbsoluteY","nullCell","toRemove","wrappedLines","destLineIndex","destCol","getWrappedLineTrimmedLength","srcLineIndex","srcCol","srcTrimmedTineLength","srcRemainingCells","destRemainingCells","cellsToCopy","copyCellsFrom","setCell","countToRemove","i_1","reflowLargerCreateNewLayout","layout","nextToRemoveIndex","nextToRemoveStart","countRemovedSoFar","countRemoved","reflowLargerApplyNewLayout","newLayout","newLayoutLines","reflowSmallerGetNewLineLengths","newLineLengths","cellsNeeded","map","reduce","srcLine","cellsAvailable","oldTrimmedLength","endsWithWide","lineLength","endsInNull","hasContent","followingLineStartsWithWide","BOLD_CLASS","DIM_CLASS","ITALIC_CLASS","UNDERLINE_CLASS","CURSOR_CLASS","CURSOR_BLINK_CLASS","CURSOR_STYLE_BLOCK_CLASS","CURSOR_STYLE_BAR_CLASS","CURSOR_STYLE_UNDERLINE_CLASS","DomRendererRowFactory","_terminalOptions","createRow","isCursorRow","cursorStyle","cursorX","cursorBlink","cellWidth","fragment","createDocumentFragment","charElement","isBold","enableBold","isItalic","isDim","isUnderline","swapColor","isInverse","isFgRGB","getAttribute","toColorRGB","getFgColor","join","isFgPalette","drawBoldTextInBrightColors","isBgRGB","getBgColor","isBgPalette","CharAtlasCache_1","CharacterJoinerRegistry_1","_container","_alpha","_scaledCharWidth","_scaledCharHeight","_scaledCellWidth","_scaledCellHeight","_scaledCharLeft","_scaledCharTop","_currentGlyphIdentifier","bold","italic","_canvas","_initCanvas","removeChild","_charAtlas","alpha","onOptionsChanged","onBlur","onFocus","onCursorMove","onGridChanged","startRow","endRow","onSelectionChanged","columnSelectMode","colorSet","_refreshCharAtlas","setTransparency","oldCanvas","cloneNode","replaceChild","acquireCharAtlas","warmUp","scaledCellWidth","scaledCharWidth","scaledCharHeight","scaledCharLeft","scaledCharTop","scaledCanvasWidth","scaledCanvasHeight","canvasWidth","fillCells","fillLeftLineAtCell","strokeRectAtCell","lineWidth","strokeRect","clearRect","fillCharTrueColor","cell","font","_getFont","textBaseline","_clipRow","fillText","drawChars","_drawUncachedChars","isBgDefault","isFgDefault","drawInBrightColor","atlasDidDraw","draw","save","globalAlpha","restore","beginPath","rect","clip","fontWeight","fontWeightBold","fontStyle","CELL_SIZE","newObj","isBlink","isInvisible","getFgColorMode","getBgColorMode","fromCharData","obj","CHAR_DATA_ATTR_INDEX","combined","CHAR_DATA_CHAR_INDEX","second","CHAR_DATA_WIDTH_INDEX","BufferLine","fillCellData","_combined","NULL_CELL_CHAR","cp","hasWidth","getCodePoint","codePoint","n","keys","fill","copyFrom","newLine","src","applyInReverse","srcData","srcCombinedKeys","trimRight","endCol","result","prepareTextForTerminal","replace","bracketTextForPaste","copyHandler","term","browser","clipboardData","setData","selectionText","pasteHandler","stopPropagation","dispatchPaste","textarea","cancel","getData","moveTextAreaUnderMouseCursor","left","clientX","top","clientY","position","focus","rightClickHandler","shouldSelectWord","isClickInSelection","selectWordAtCursor","select","Strings","Platform_1","RenderDebouncer_1","MAX_ROWS_TO_READ","AccessibilityManager","_liveRegionLineCount","_charsToConsume","_accessibilityTreeRoot","_rowContainer","_rowElements","_createAccessibilityTreeNode","_topBoundaryFocusListener","_onBoundaryFocus","_bottomBoundaryFocusListener","_refreshRowsDimensions","_renderRowsDebouncer","RenderDebouncer","_renderRows","_refreshRows","_liveRegion","insertAdjacentElement","onResize","_onResize","onRender","onScroll","addDisposableListener","char","_onChar","spaceCount","_onTab","onKey","_onKey","_clearLiveRegion","onCanvasResize","boundaryElement","target","beforeBoundaryElement","posInSet","lastRowPos","relatedTarget","topBoundaryElement","bottomBoundaryElement","shift","newElement","unshift","children","tabIndex","_refreshRowDimensions","shiftedChar","_announceCharacter","tooMuchOutput","parentNode","keyChar","setSize","translateBufferLineToString","blankLine","actualCellHeight","innerHTML","SelectionRenderLayer","_clearState","_didStateChange","viewportStartRow","viewportEndRow","viewportCappedStartRow","viewportCappedEndRow","startRowEndCol","middleRowsCount","_areCoordinatesEqual","coord1","coord2","_renderCallback","_animationFrame","cancelAnimationFrame","rowStart","rowEnd","rowCount","_rowCount","_rowStart","_rowEnd","ColorManager_1","DomRendererRowFactory_1","TERMINAL_CLASS_PREFIX","ROW_CONTAINER_CLASS","FG_CLASS_PREFIX","BG_CLASS_PREFIX","FOCUS_CLASS","SELECTION_CLASS","nextTerminalId","DomRenderer","_terminalClass","_onCanvasResize","_onRender","colorManager","lineHeight","_refreshRowElements","_selectionContainer","actualCellWidth","_updateDimensions","_renderDebouncer","_rowFactory","_themeStyleElement","_dimensionsStyleElement","letterSpacing","overflow","styles","_terminalSelector","onWindowResize","onCharSizeChanged","documentFragment","_createSelectionElement","endCol_1","colStart","colEnd","refreshRows","cursorAbsoluteY","rowElement","_setCellUnderline","enabled","span","textDecoration","CircularList_1","BufferReflow_1","DEFAULT_ATTR","MAX_BUFFER_SIZE","WHITESPACE_CELL_WIDTH","_hasScrollback","markers","_nullCell","_whitespaceCell","_cols","_rows","getWhitespaceCell","maxLength","absoluteY","relativeY","_getCorrectBufferLength","correctBufferLength","scrollback","addToY","amountToTrim","_isReflowEnabled","_reflow","windowsMode","_reflowLarger","_reflowSmaller","newLayoutResult","_reflowLargerAdjustViewport","viewportAdjustments","toInsert","countToInsert","lastLineLength","destLineLengths","linesToAdd","trimmedLines","newLines","wrappedLinesIndex","insertEvents","originalLines","originalLinesLength","originalLineIndex","nextToInsertIndex","nextToInsert","countInsertedSoFar","nextI","insertCountEmitted","stringIndexToBufferIndex","lineIndex","stringIndex","getWrappedRangeForLine","first","last","tabStopWidth","addMarker","marker","Marker","onInsert","onDelete","onDispose","_removeMarker","iterator","startOverscan","endOverscan","BufferStringIterator","_id","_nextId","isDisposed","_onDispose","_buffer","_trimRight","_endIndex","_startOverscan","_endOverscan","_current","hasNext","next","node","type","useCapture","TextRenderLayer_1","SelectionRenderLayer_1","CursorRenderLayer_1","LinkRenderLayer_1","ScreenDprMonitor_1","Renderer","_isPaused","_needsFullRefresh","_characterJoinerRegistry","_renderLayers","TextRenderLayer","CursorRenderLayer","_devicePixelRatio","_screenDprMonitor","observer_1","IntersectionObserver","onIntersectionChange","threshold","observe","disconnect","entry","intersectionRatio","_runOperation","operation","KEYCODE_KEY_MAPPINGS","48","49","50","51","52","53","54","55","56","57","186","187","188","189","190","191","192","219","220","221","222","evaluateKeyboardEvent","applicationCursorMode","macOptionIsMeta","modifiers","shiftKey","altKey","ctrlKey","metaKey","keyCode","DEL","keyMapping","US","DynamicCharAtlas_1","NoneCharAtlas_1","StaticCharAtlas_1","charAtlasImplementations","default","charAtlasCache","newConfig","generateConfig","ownedByIndex","ownedBy","configEquals","config","atlas","newEntry","experimentalCharAtlas","removeTerminalFromCache","DEFAULT_BELL_SOUND","SoundManager","_audioContext","audioContextCtor","AudioContext","webkitAudioContext","playBellSound","ctx","audioContext","bellAudioSource","createBufferSource","decodeAudioData","_base64ToArrayBuffer","_removeMimeType","bellSound","connect","destination","base64","binaryString","atob","len","bytes","Uint8Array","dataURI","splitUri","split","BaseCharAtlas_1","CharAtlasGenerator_1","LRUMap_1","TEXTURE_WIDTH","TEXTURE_HEIGHT","TRANSPARENT_COLOR","FRAME_CACHE_DRAW_LIMIT","GLYPH_BITMAP_COMMIT_DELAY","getGlyphCacheKey","glyph","DynamicCharAtlas","_config","_drawToCacheCount","_glyphsWaitingOnBitmap","_bitmapCommitTimeout","_bitmap","_cacheCanvas","_cacheCtx","tmpCanvas","_tmpCtx","capacity","_cacheMap","prealloc","beginFrame","_canCache","glyphKey","cacheValue","_drawFromCache","size","peek","cacheValue_1","_drawToCache","_toCoordinateX","_toCoordinateY","isEmpty","cacheX","cacheY","drawImage","inBitmap","_getColorFromAnsiIndex","idx","_getBackgroundColor","_getForegroundColor","imageData","clearColor","putImageData","_addGlyphToBitmap","_generateBitmap","glyphsMovingToBitmap","createImageBitmap","then","bitmap","Terminal_1","Terminal","_core","onSelectionChange","onData","onTitleChange","blur","on","off","columns","writeln","open","parent","attachCustomKeyEventHandler","customKeyEventHandler","registerLinkMatcher","regex","deregisterLinkMatcher","matcherId","cursorYOffset","hasSelection","selectAll","selectLines","destroy","scrollPages","pageCount","scrollToTop","scrollToBottom","scrollToLine","write","applyAddon","addon","array","fillFallback","a","NUL","SOH","STX","ETX","EOT","ENQ","ACK","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","FS","GS","RS","SP","PAD","HOP","BPH","NBH","SSA","ESA","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","SGCI","SCI","CSI","ST","OSC","PM","APC","_interim","input","startPos","codepoint","NoneCharAtlas","BaseCharAtlas","_didWarmUp","_doWarmUp","promptLabel","GridCache_1","characterJoinerRegistry","_characterOverlapCache","terminalFont","_characterWidth","_characterFont","_forEachCell","firstRow","lastRow","joinerRegistry","isJoined","lastCharX","_isOverlapping","_drawBackground","startX","startY","prevFillStyle","nextFillStyle","_drawForeground","overlaps","measureText","EventEmitter","_events","disposed","removeAllListeners","args","emitMayRemoveListeners","listeners","MouseHelper_1","Browser","SelectionModel_1","AltClickHandler_1","DRAG_SCROLL_MAX_THRESHOLD","DRAG_SCROLL_MAX_SPEED","DRAG_SCROLL_INTERVAL","ALT_CLICK_MOVE_CURSOR_TIME","WORD_SEPARATORS","NON_BREAKING_SPACE_CHAR","ALL_NON_BREAKING_SPACE_REGEX","RegExp","SelectionManager","_enabled","_onLinuxMouseSelection","_onRedrawRequest","_onSelectionChange","_initListeners","_model","_activeSelectionMode","_removeMouseDownListeners","active","_mouseUpListener","_onMouseUp","initBuffersListeners","_trimListener","_onTrim","onBufferActivate","finalSelectionStart","finalSelectionEnd","lineText","bufferLine","formattedResult","isLinuxMouseSelection","_getMouseBufferCoords","_areCoordsInSelection","_selectWordAt","needsRefresh","_getMouseEventScrollAmount","MouseHelper","getCoordsRelativeToElement","terminalHeight","shouldForceSelection","macOptionClickForcesSelection","onMouseDown","_mouseDownTimeStamp","timeStamp","button","_dragScrollAmount","_onIncrementalClick","detail","_onSingleClick","_onDoubleClick","_onTripleClick","_addMouseDownListeners","ownerDocument","_dragScrollIntervalTimer","setInterval","_dragScroll","clearInterval","shouldColumnSelect","_selectLineAt","previousSelectionEnd","_selectToWordAt","timeElapsed","AltClickHandler","move","_convertViewportColToCharacterIndex","charIndex","setSelection","_getWordAt","allowWhitespaceOnlySelection","followWrappedLinesAbove","followWrappedLinesBelow","charOffset","leftWideCharCount","rightWideCharCount","leftLongCharOffset","rightLongCharOffset","charAt","length_2","_isCharWordSeparator","length_3","length_4","trim","previousBufferLine","previousLineWordPosition","nextBufferLine","nextLineWordPosition","wordPosition","wrappedRange","StaticCharAtlas","_canvasFactory","generateStaticCharAtlasTexture","HTMLCanvasElement","_texture","texture","_isCached","colorIndex","isAscii","isBasicColor","isDefaultColor","isDefaultBackground","charAtlasCellWidth","charAtlasCellHeight","clonedColors","colorCode","__rest","t","getOwnPropertySymbols","propertyIsEnumerable","TERMINAL_CLASS","TERMINAL_BODY_CLASS","session","super","_needsResize","_termOpened","_offsetWidth","_offsetHeight","_options","assign","defaultOptions","_a","initialCommand","other","xtermOptions","Private","getXTermTheme","addClass","_term","_initializeTerm","title","label","messageReceived","_onMessage","terminated","ready","name","_setSessionSize","send","option","update","shutdown","catch","reason","reconnect","msg","processMessage","onFitRequest","isVisible","isAttached","_resizeTerminal","ResizeMessage","UnknownSize","sendMessage","IS_MAC","pasteWithCtrlV","sender","lightTheme","darkTheme","inheritTheme","getComputedStyle","body","getPropertyValue","BLINK_INTERVAL","_cell","isFocused","_cursorRenderers","_renderBarCursor","_renderBlockCursor","_renderUnderlineCursor","_clearCursor","_cursorBlinkStateManager","pause","resume","CursorBlinkStateManager","_render","restartBlinkAnimation","isPaused","triggeredByAnimationFrame","cursorState","cursorY","viewportRelativeCursorY","_renderBlurCursor","isCursorVisible","strokeStyle","_restartInterval","_blinkStartTimeout","_blinkInterval","_animationTimeRestarted","Date","now","timeToStart","time","context","canvasFactory","cellHeight","getFont","charAtlasImageData","color","CompositionHelper","_textarea","_compositionView","_isComposing","_isSendingComposition","_compositionPosition","compositionstart","compositionupdate","updateCompositionElements","compositionend","_finalizeComposition","keydown","_handleAnyTextareaChanges","waitForPropagation","_clearTextareaPosition","currentCompositionPosition_1","oldValue","newValue","dontRecurse","isCursorInViewport","cursorTop","cursorLeft","compositionViewBounds","opts","COMBINING_BMP","COMBINING_HIGH","bisearch","ucs","mid","wcwidthHigh","control","table","nul","num","getStringCellWidth","BufferSet_1","CompositionHelper_1","EventEmitter_1","Viewport_1","Clipboard_1","InputHandler_1","Renderer_1","Linkifier_1","SelectionManager_1","CharMeasure_1","SoundManager_1","MouseZoneManager_1","AccessibilityManager_1","DomRenderer_1","Keyboard_1","Clone_1","WindowsMode_1","WRITE_BUFFER_PAUSE_THRESHOLD","WRITE_TIMEOUT_MS","MINIMUM_COLS","MINIMUM_ROWS","CONSTRUCTOR_ONLY_OPTIONS","DEFAULT_OPTIONS","termName","bellStyle","screenKeys","cancelEvents","disableStdin","useFlowControl","rightClickSelectsWord","rendererType","_blankLine","_onTitleChange","_setup","domEvent","_windowsMode","_customKeyEventHandler","_parent","gcharset","_eraseAttrData","currentParam","writeBuffer","_writeInProgress","_xoffSentToCatchUp","_userScrolling","_inputHandler","Linkifier","_mouseZoneManager","soundManager","preventScroll","activeElement","hasFocus","_setTheme","newBufferLength","_setupRenderer","_theme","setRenderer","_accessibilityManager","_onTextAreaFocus","updateCursorStyle","_onTextAreaBlur","_initGlobal","_bindKeys","pasteHandlerWrapper","self","_keyDown","_keyPress","wasModifierKeyOnlyEvent","_keyUp","_compositionHelper","_queueLinkification","_context","defaultView","dir","_viewportScrollArea","_helperContainer","attachToDom","onRedrawRequest","onLinuxMouseSelection","toggle","bindMouse","pressed","sendButton","getButton","getRawByteCoords","sendEvent","overrideType","sendMove","encode","_vt300Mouse","data_1","_decLocator","page","meta","ctrl","mod","which","moveHandler","hasScrollback","sequence","linkifyRows","eraseAttr","topRow","bottomRow","willBufferBeTrimmed","isFull","scrollRegionHeight","disp","suppressScrollEvent","oldYdisp","scrollAmount","_innerWrite","bufferOffset","startTime","_refreshStart","_refreshEnd","normal","scrollCount","_isThirdLevelShift","thirdLevelKey","charCode","_soundBell","_visualBell","_visualBellTimer","isNaN","maxRange","inputHandler","force","_mouseEvent","_lines","_startCol","_startRow","coordinates","coordinate","_endCol","_endRow","_arrowSequences","_resetStartingRow","_moveToRequestedRow","_moveToRequestedCol","_moveHorizontallyOnly","repeat","_bufferLine","_wrappedRowsForRow","_sequence","rowsToMove","_wrappedRowsCount","_verticalDirection","direction","_horizontalDirection","wrappedRows","currentRow","lineWraps","forward","currentCol","bufferStr","str","rpt","low","high","TransitionTable","action","addMany","codes","PRINTABLES","EXECUTABLES","NON_ASCII_PRINTABLE","VT500_TRANSITION_TABLE","states","DcsDummy","TRANSITIONS","initialState","currentState","_osc","_params","_collect","_printHandlerFb","_executeHandlerFb","_csiHandlerFb","_escHandlerFb","_oscHandlerFb","_dcsHandlerFb","_errorHandlerFb","_printHandler","_executeHandlers","_csiHandlers","_escHandlers","_oscHandlers","_dcsHandlers","_activeDcsHandler","_errorHandler","clearPrintHandler","clearExecuteHandler","handlerList","handlerIndex","clearCsiHandler","clearEscHandler","clearOscHandler","clearDcsHandler","setDcsHandlerFallback","clearErrorHandler","transition","dcs","osc","dcsHandler","inject","abort","handlers","j_1","handlers_1","j_2","LRUMap","_map","_head","_tail","_nodePool","_unlinkNode","prev","_appendNode","tail","nodePool","peekValue","head","_linkMatchers","_nextLinkMatcherId","_onLinkTooltip","_rowsToLinkify","mouseZoneManager","_rowsTimeoutId","_linkifyRows","TIME_BEFORE_LINKIFY","absoluteRowIndexStart","absoluteRowIndexEnd","overscanLineLimit","OVERSCAN_CHAR_LIMIT","_doLinkifyRow","matcher","matchIndex","validationCallback","hoverTooltipCallback","hoverLeaveCallback","priority","_addLinkMatcherToList","rowIndex","rex","source","flags","match","uri","lastIndex","bufferIndex","isValid","_addLink","exec","state_1","_createLinkHoverEvent","_renderer","colCount","isSelection","proposeGeometry","parentElementStyle","parentElementHeight","parentElementWidth","elementStyle","elementPadding","bottom","right","elementPaddingVer","elementPaddingHor","availableHeight","availableWidth","fit","terminalConstructor"],"mappings":"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AAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAAS,CAAC,KAAQ,MAC7C,CAAC,KAAQ,MAAS,CAAC,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","file":"3.2e8d3b4640d0ed9554e6.js","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Lifecycle_1 = require(\"./common/Lifecycle\");\nvar Lifecycle_2 = require(\"./ui/Lifecycle\");\nvar FALLBACK_SCROLL_BAR_WIDTH = 15;\nvar Viewport = (function (_super) {\n    __extends(Viewport, _super);\n    function Viewport(_terminal, _viewportElement, _scrollArea, _charMeasure) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._viewportElement = _viewportElement;\n        _this._scrollArea = _scrollArea;\n        _this._charMeasure = _charMeasure;\n        _this.scrollBarWidth = 0;\n        _this._currentRowHeight = 0;\n        _this._lastRecordedBufferLength = 0;\n        _this._lastRecordedViewportHeight = 0;\n        _this._lastRecordedBufferHeight = 0;\n        _this._lastScrollTop = 0;\n        _this._wheelPartialScroll = 0;\n        _this._refreshAnimationFrame = null;\n        _this._ignoreNextScrollEvent = false;\n        _this.scrollBarWidth = (_this._viewportElement.offsetWidth - _this._scrollArea.offsetWidth) || FALLBACK_SCROLL_BAR_WIDTH;\n        _this.register(Lifecycle_2.addDisposableDomListener(_this._viewportElement, 'scroll', _this._onScroll.bind(_this)));\n        setTimeout(function () { return _this.syncScrollArea(); }, 0);\n        return _this;\n    }\n    Viewport.prototype.onThemeChanged = function (colors) {\n        this._viewportElement.style.backgroundColor = colors.background.css;\n    };\n    Viewport.prototype._refresh = function () {\n        var _this = this;\n        if (this._refreshAnimationFrame === null) {\n            this._refreshAnimationFrame = requestAnimationFrame(function () { return _this._innerRefresh(); });\n        }\n    };\n    Viewport.prototype._innerRefresh = function () {\n        if (this._charMeasure.height > 0) {\n            this._currentRowHeight = this._terminal.renderer.dimensions.scaledCellHeight / window.devicePixelRatio;\n            this._lastRecordedViewportHeight = this._viewportElement.offsetHeight;\n            var newBufferHeight = Math.round(this._currentRowHeight * this._lastRecordedBufferLength) + (this._lastRecordedViewportHeight - this._terminal.renderer.dimensions.canvasHeight);\n            if (this._lastRecordedBufferHeight !== newBufferHeight) {\n                this._lastRecordedBufferHeight = newBufferHeight;\n                this._scrollArea.style.height = this._lastRecordedBufferHeight + 'px';\n            }\n        }\n        var scrollTop = this._terminal.buffer.ydisp * this._currentRowHeight;\n        if (this._viewportElement.scrollTop !== scrollTop) {\n            this._ignoreNextScrollEvent = true;\n            this._viewportElement.scrollTop = scrollTop;\n        }\n        this._refreshAnimationFrame = null;\n    };\n    Viewport.prototype.syncScrollArea = function () {\n        if (this._lastRecordedBufferLength !== this._terminal.buffer.lines.length) {\n            this._lastRecordedBufferLength = this._terminal.buffer.lines.length;\n            this._refresh();\n            return;\n        }\n        if (this._lastRecordedViewportHeight !== this._terminal.renderer.dimensions.canvasHeight) {\n            this._refresh();\n            return;\n        }\n        var newScrollTop = this._terminal.buffer.ydisp * this._currentRowHeight;\n        if (this._lastScrollTop !== newScrollTop) {\n            this._refresh();\n            return;\n        }\n        if (this._lastScrollTop !== this._viewportElement.scrollTop) {\n            this._refresh();\n            return;\n        }\n        if (this._terminal.renderer.dimensions.scaledCellHeight / window.devicePixelRatio !== this._currentRowHeight) {\n            this._refresh();\n            return;\n        }\n    };\n    Viewport.prototype._onScroll = function (ev) {\n        this._lastScrollTop = this._viewportElement.scrollTop;\n        if (!this._viewportElement.offsetParent) {\n            return;\n        }\n        if (this._ignoreNextScrollEvent) {\n            this._ignoreNextScrollEvent = false;\n            return;\n        }\n        var newRow = Math.round(this._lastScrollTop / this._currentRowHeight);\n        var diff = newRow - this._terminal.buffer.ydisp;\n        this._terminal.scrollLines(diff, true);\n    };\n    Viewport.prototype.onWheel = function (ev) {\n        var amount = this._getPixelsScrolled(ev);\n        if (amount === 0) {\n            return;\n        }\n        this._viewportElement.scrollTop += amount;\n        ev.preventDefault();\n    };\n    Viewport.prototype._getPixelsScrolled = function (ev) {\n        if (ev.deltaY === 0) {\n            return 0;\n        }\n        var amount = ev.deltaY;\n        if (ev.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n            amount *= this._currentRowHeight;\n        }\n        else if (ev.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n            amount *= this._currentRowHeight * this._terminal.rows;\n        }\n        return amount;\n    };\n    Viewport.prototype.getLinesScrolled = function (ev) {\n        if (ev.deltaY === 0) {\n            return 0;\n        }\n        var amount = ev.deltaY;\n        if (ev.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n            amount /= this._currentRowHeight + 0.0;\n            this._wheelPartialScroll += amount;\n            amount = Math.floor(Math.abs(this._wheelPartialScroll)) * (this._wheelPartialScroll > 0 ? 1 : -1);\n            this._wheelPartialScroll %= 1;\n        }\n        else if (ev.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n            amount *= this._terminal.rows;\n        }\n        return amount;\n    };\n    Viewport.prototype.onTouchStart = function (ev) {\n        this._lastTouchY = ev.touches[0].pageY;\n    };\n    Viewport.prototype.onTouchMove = function (ev) {\n        var deltaY = this._lastTouchY - ev.touches[0].pageY;\n        this._lastTouchY = ev.touches[0].pageY;\n        if (deltaY === 0) {\n            return;\n        }\n        this._viewportElement.scrollTop += deltaY;\n        ev.preventDefault();\n    };\n    return Viewport;\n}(Lifecycle_1.Disposable));\nexports.Viewport = Viewport;\n//# sourceMappingURL=Viewport.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Lifecycle_1 = require(\"../common/Lifecycle\");\nvar ScreenDprMonitor = (function (_super) {\n    __extends(ScreenDprMonitor, _super);\n    function ScreenDprMonitor() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._currentDevicePixelRatio = window.devicePixelRatio;\n        return _this;\n    }\n    ScreenDprMonitor.prototype.setListener = function (listener) {\n        var _this = this;\n        if (this._listener) {\n            this.clearListener();\n        }\n        this._listener = listener;\n        this._outerListener = function () {\n            if (!_this._listener) {\n                return;\n            }\n            _this._listener(window.devicePixelRatio, _this._currentDevicePixelRatio);\n            _this._updateDpr();\n        };\n        this._updateDpr();\n    };\n    ScreenDprMonitor.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.clearListener();\n    };\n    ScreenDprMonitor.prototype._updateDpr = function () {\n        if (!this._resolutionMediaMatchList || !this._outerListener) {\n            return;\n        }\n        this._resolutionMediaMatchList.removeListener(this._outerListener);\n        this._currentDevicePixelRatio = window.devicePixelRatio;\n        this._resolutionMediaMatchList = window.matchMedia(\"screen and (resolution: \" + window.devicePixelRatio + \"dppx)\");\n        this._resolutionMediaMatchList.addListener(this._outerListener);\n    };\n    ScreenDprMonitor.prototype.clearListener = function () {\n        if (!this._resolutionMediaMatchList || !this._listener || !this._outerListener) {\n            return;\n        }\n        this._resolutionMediaMatchList.removeListener(this._outerListener);\n        this._resolutionMediaMatchList = undefined;\n        this._listener = undefined;\n        this._outerListener = undefined;\n    };\n    return ScreenDprMonitor;\n}(Lifecycle_1.Disposable));\nexports.ScreenDprMonitor = ScreenDprMonitor;\n//# sourceMappingURL=ScreenDprMonitor.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"./Buffer\");\nfunction applyWindowsMode(terminal) {\n    return terminal.onLineFeed(function () {\n        var line = terminal.buffer.lines.get(terminal.buffer.ybase + terminal.buffer.y - 1);\n        var lastChar = line.get(terminal.cols - 1);\n        if (lastChar[Buffer_1.CHAR_DATA_CODE_INDEX] !== Buffer_1.NULL_CELL_CODE && lastChar[Buffer_1.CHAR_DATA_CODE_INDEX] !== Buffer_1.WHITESPACE_CELL_CODE) {\n            var nextLine = terminal.buffer.lines.get(terminal.buffer.ybase + terminal.buffer.y);\n            nextLine.isWrapped = true;\n        }\n    });\n}\nexports.applyWindowsMode = applyWindowsMode;\n//# sourceMappingURL=WindowsMode.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Lifecycle_1 = require(\"./common/Lifecycle\");\nvar Lifecycle_2 = require(\"./ui/Lifecycle\");\nvar HOVER_DURATION = 500;\nvar MouseZoneManager = (function (_super) {\n    __extends(MouseZoneManager, _super);\n    function MouseZoneManager(_terminal) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._zones = [];\n        _this._areZonesActive = false;\n        _this._tooltipTimeout = null;\n        _this._currentZone = null;\n        _this._lastHoverCoords = [null, null];\n        _this.register(Lifecycle_2.addDisposableDomListener(_this._terminal.element, 'mousedown', function (e) { return _this._onMouseDown(e); }));\n        _this._mouseMoveListener = function (e) { return _this._onMouseMove(e); };\n        _this._mouseLeaveListener = function (e) { return _this._onMouseLeave(e); };\n        _this._clickListener = function (e) { return _this._onClick(e); };\n        return _this;\n    }\n    MouseZoneManager.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._deactivate();\n    };\n    MouseZoneManager.prototype.add = function (zone) {\n        this._zones.push(zone);\n        if (this._zones.length === 1) {\n            this._activate();\n        }\n    };\n    MouseZoneManager.prototype.clearAll = function (start, end) {\n        if (this._zones.length === 0) {\n            return;\n        }\n        if (!end) {\n            start = 0;\n            end = this._terminal.rows - 1;\n        }\n        for (var i = 0; i < this._zones.length; i++) {\n            var zone = this._zones[i];\n            if ((zone.y1 > start && zone.y1 <= end + 1) ||\n                (zone.y2 > start && zone.y2 <= end + 1) ||\n                (zone.y1 < start && zone.y2 > end + 1)) {\n                if (this._currentZone && this._currentZone === zone) {\n                    this._currentZone.leaveCallback();\n                    this._currentZone = null;\n                }\n                this._zones.splice(i--, 1);\n            }\n        }\n        if (this._zones.length === 0) {\n            this._deactivate();\n        }\n    };\n    MouseZoneManager.prototype._activate = function () {\n        if (!this._areZonesActive) {\n            this._areZonesActive = true;\n            this._terminal.element.addEventListener('mousemove', this._mouseMoveListener);\n            this._terminal.element.addEventListener('mouseleave', this._mouseLeaveListener);\n            this._terminal.element.addEventListener('click', this._clickListener);\n        }\n    };\n    MouseZoneManager.prototype._deactivate = function () {\n        if (this._areZonesActive) {\n            this._areZonesActive = false;\n            this._terminal.element.removeEventListener('mousemove', this._mouseMoveListener);\n            this._terminal.element.removeEventListener('mouseleave', this._mouseLeaveListener);\n            this._terminal.element.removeEventListener('click', this._clickListener);\n        }\n    };\n    MouseZoneManager.prototype._onMouseMove = function (e) {\n        if (this._lastHoverCoords[0] !== e.pageX || this._lastHoverCoords[1] !== e.pageY) {\n            this._onHover(e);\n            this._lastHoverCoords = [e.pageX, e.pageY];\n        }\n    };\n    MouseZoneManager.prototype._onHover = function (e) {\n        var _this = this;\n        var zone = this._findZoneEventAt(e);\n        if (zone === this._currentZone) {\n            return;\n        }\n        if (this._currentZone) {\n            this._currentZone.leaveCallback();\n            this._currentZone = null;\n            if (this._tooltipTimeout) {\n                clearTimeout(this._tooltipTimeout);\n            }\n        }\n        if (!zone) {\n            return;\n        }\n        this._currentZone = zone;\n        if (zone.hoverCallback) {\n            zone.hoverCallback(e);\n        }\n        this._tooltipTimeout = setTimeout(function () { return _this._onTooltip(e); }, HOVER_DURATION);\n    };\n    MouseZoneManager.prototype._onTooltip = function (e) {\n        this._tooltipTimeout = null;\n        var zone = this._findZoneEventAt(e);\n        if (zone && zone.tooltipCallback) {\n            zone.tooltipCallback(e);\n        }\n    };\n    MouseZoneManager.prototype._onMouseDown = function (e) {\n        this._initialSelectionLength = this._terminal.getSelection().length;\n        if (!this._areZonesActive) {\n            return;\n        }\n        var zone = this._findZoneEventAt(e);\n        if (zone) {\n            if (zone.willLinkActivate(e)) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n            }\n        }\n    };\n    MouseZoneManager.prototype._onMouseLeave = function (e) {\n        if (this._currentZone) {\n            this._currentZone.leaveCallback();\n            this._currentZone = null;\n            if (this._tooltipTimeout) {\n                clearTimeout(this._tooltipTimeout);\n            }\n        }\n    };\n    MouseZoneManager.prototype._onClick = function (e) {\n        var zone = this._findZoneEventAt(e);\n        var currentSelectionLength = this._terminal.getSelection().length;\n        if (zone && currentSelectionLength === this._initialSelectionLength) {\n            zone.clickCallback(e);\n            e.preventDefault();\n            e.stopImmediatePropagation();\n        }\n    };\n    MouseZoneManager.prototype._findZoneEventAt = function (e) {\n        var coords = this._terminal.mouseHelper.getCoords(e, this._terminal.screenElement, this._terminal.charMeasure, this._terminal.cols, this._terminal.rows);\n        if (!coords) {\n            return null;\n        }\n        var x = coords[0];\n        var y = coords[1];\n        for (var i = 0; i < this._zones.length; i++) {\n            var zone = this._zones[i];\n            if (zone.y1 === zone.y2) {\n                if (y === zone.y1 && x >= zone.x1 && x < zone.x2) {\n                    return zone;\n                }\n            }\n            else {\n                if ((y === zone.y1 && x >= zone.x1) ||\n                    (y === zone.y2 && x < zone.x2) ||\n                    (y > zone.y1 && y < zone.y2)) {\n                    return zone;\n                }\n            }\n        }\n        return null;\n    };\n    return MouseZoneManager;\n}(Lifecycle_1.Disposable));\nexports.MouseZoneManager = MouseZoneManager;\nvar MouseZone = (function () {\n    function MouseZone(x1, y1, x2, y2, clickCallback, hoverCallback, tooltipCallback, leaveCallback, willLinkActivate) {\n        this.x1 = x1;\n        this.y1 = y1;\n        this.x2 = x2;\n        this.y2 = y2;\n        this.clickCallback = clickCallback;\n        this.hoverCallback = hoverCallback;\n        this.tooltipCallback = tooltipCallback;\n        this.leaveCallback = leaveCallback;\n        this.willLinkActivate = willLinkActivate;\n    }\n    return MouseZone;\n}());\nexports.MouseZone = MouseZone;\n//# sourceMappingURL=MouseZoneManager.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DEFAULT_COLOR = 256;\nexports.INVERTED_DEFAULT_COLOR = 257;\nexports.DIM_OPACITY = 0.5;\nexports.CHAR_ATLAS_CELL_SPACING = 1;\n//# sourceMappingURL=Types.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar Types_1 = require(\"./atlas/Types\");\nvar CharAtlasUtils_1 = require(\"./atlas/CharAtlasUtils\");\nvar LinkRenderLayer = (function (_super) {\n    __extends(LinkRenderLayer, _super);\n    function LinkRenderLayer(container, zIndex, colors, terminal) {\n        var _this = _super.call(this, container, 'link', zIndex, true, colors) || this;\n        _this._state = null;\n        terminal.linkifier.onLinkHover(function (e) { return _this._onLinkHover(e); });\n        terminal.linkifier.onLinkLeave(function (e) { return _this._onLinkLeave(e); });\n        return _this;\n    }\n    LinkRenderLayer.prototype.resize = function (terminal, dim) {\n        _super.prototype.resize.call(this, terminal, dim);\n        this._state = null;\n    };\n    LinkRenderLayer.prototype.reset = function (terminal) {\n        this._clearCurrentLink();\n    };\n    LinkRenderLayer.prototype._clearCurrentLink = function () {\n        if (this._state) {\n            this.clearCells(this._state.x1, this._state.y1, this._state.cols - this._state.x1, 1);\n            var middleRowCount = this._state.y2 - this._state.y1 - 1;\n            if (middleRowCount > 0) {\n                this.clearCells(0, this._state.y1 + 1, this._state.cols, middleRowCount);\n            }\n            this.clearCells(0, this._state.y2, this._state.x2, 1);\n            this._state = null;\n        }\n    };\n    LinkRenderLayer.prototype._onLinkHover = function (e) {\n        if (e.fg === Types_1.INVERTED_DEFAULT_COLOR) {\n            this._ctx.fillStyle = this._colors.background.css;\n        }\n        else if (CharAtlasUtils_1.is256Color(e.fg)) {\n            this._ctx.fillStyle = this._colors.ansi[e.fg].css;\n        }\n        else {\n            this._ctx.fillStyle = this._colors.foreground.css;\n        }\n        if (e.y1 === e.y2) {\n            this.fillBottomLineAtCells(e.x1, e.y1, e.x2 - e.x1);\n        }\n        else {\n            this.fillBottomLineAtCells(e.x1, e.y1, e.cols - e.x1);\n            for (var y = e.y1 + 1; y < e.y2; y++) {\n                this.fillBottomLineAtCells(0, y, e.cols);\n            }\n            this.fillBottomLineAtCells(0, e.y2, e.x2);\n        }\n        this._state = e;\n    };\n    LinkRenderLayer.prototype._onLinkLeave = function (e) {\n        this._clearCurrentLink();\n    };\n    return LinkRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.LinkRenderLayer = LinkRenderLayer;\n//# sourceMappingURL=LinkRenderLayer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter2_1 = require(\"./EventEmitter2\");\nvar CircularList = (function () {\n    function CircularList(_maxLength) {\n        this._maxLength = _maxLength;\n        this.onDeleteEmitter = new EventEmitter2_1.EventEmitter2();\n        this.onInsertEmitter = new EventEmitter2_1.EventEmitter2();\n        this.onTrimEmitter = new EventEmitter2_1.EventEmitter2();\n        this._array = new Array(this._maxLength);\n        this._startIndex = 0;\n        this._length = 0;\n    }\n    Object.defineProperty(CircularList.prototype, \"onDelete\", {\n        get: function () { return this.onDeleteEmitter.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"onInsert\", {\n        get: function () { return this.onInsertEmitter.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"onTrim\", {\n        get: function () { return this.onTrimEmitter.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"maxLength\", {\n        get: function () {\n            return this._maxLength;\n        },\n        set: function (newMaxLength) {\n            if (this._maxLength === newMaxLength) {\n                return;\n            }\n            var newArray = new Array(newMaxLength);\n            for (var i = 0; i < Math.min(newMaxLength, this.length); i++) {\n                newArray[i] = this._array[this._getCyclicIndex(i)];\n            }\n            this._array = newArray;\n            this._maxLength = newMaxLength;\n            this._startIndex = 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CircularList.prototype, \"length\", {\n        get: function () {\n            return this._length;\n        },\n        set: function (newLength) {\n            if (newLength > this._length) {\n                for (var i = this._length; i < newLength; i++) {\n                    this._array[i] = undefined;\n                }\n            }\n            this._length = newLength;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CircularList.prototype.get = function (index) {\n        return this._array[this._getCyclicIndex(index)];\n    };\n    CircularList.prototype.set = function (index, value) {\n        this._array[this._getCyclicIndex(index)] = value;\n    };\n    CircularList.prototype.push = function (value) {\n        this._array[this._getCyclicIndex(this._length)] = value;\n        if (this._length === this._maxLength) {\n            this._startIndex = ++this._startIndex % this._maxLength;\n            this.onTrimEmitter.fire(1);\n        }\n        else {\n            this._length++;\n        }\n    };\n    CircularList.prototype.recycle = function () {\n        if (this._length !== this._maxLength) {\n            throw new Error('Can only recycle when the buffer is full');\n        }\n        this._startIndex = ++this._startIndex % this._maxLength;\n        this.onTrimEmitter.fire(1);\n        return this._array[this._getCyclicIndex(this._length - 1)];\n    };\n    Object.defineProperty(CircularList.prototype, \"isFull\", {\n        get: function () {\n            return this._length === this._maxLength;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CircularList.prototype.pop = function () {\n        return this._array[this._getCyclicIndex(this._length-- - 1)];\n    };\n    CircularList.prototype.splice = function (start, deleteCount) {\n        var items = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            items[_i - 2] = arguments[_i];\n        }\n        if (deleteCount) {\n            for (var i = start; i < this._length - deleteCount; i++) {\n                this._array[this._getCyclicIndex(i)] = this._array[this._getCyclicIndex(i + deleteCount)];\n            }\n            this._length -= deleteCount;\n        }\n        for (var i = this._length - 1; i >= start; i--) {\n            this._array[this._getCyclicIndex(i + items.length)] = this._array[this._getCyclicIndex(i)];\n        }\n        for (var i = 0; i < items.length; i++) {\n            this._array[this._getCyclicIndex(start + i)] = items[i];\n        }\n        if (this._length + items.length > this._maxLength) {\n            var countToTrim = (this._length + items.length) - this._maxLength;\n            this._startIndex += countToTrim;\n            this._length = this._maxLength;\n            this.onTrimEmitter.fire(countToTrim);\n        }\n        else {\n            this._length += items.length;\n        }\n    };\n    CircularList.prototype.trimStart = function (count) {\n        if (count > this._length) {\n            count = this._length;\n        }\n        this._startIndex += count;\n        this._length -= count;\n        this.onTrimEmitter.fire(count);\n    };\n    CircularList.prototype.shiftElements = function (start, count, offset) {\n        if (count <= 0) {\n            return;\n        }\n        if (start < 0 || start >= this._length) {\n            throw new Error('start argument out of range');\n        }\n        if (start + offset < 0) {\n            throw new Error('Cannot shift elements in list beyond index 0');\n        }\n        if (offset > 0) {\n            for (var i = count - 1; i >= 0; i--) {\n                this.set(start + i + offset, this.get(start + i));\n            }\n            var expandListBy = (start + count + offset) - this._length;\n            if (expandListBy > 0) {\n                this._length += expandListBy;\n                while (this._length > this._maxLength) {\n                    this._length--;\n                    this._startIndex++;\n                    this.onTrimEmitter.fire(1);\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < count; i++) {\n                this.set(start + i + offset, this.get(start + i));\n            }\n        }\n    };\n    CircularList.prototype._getCyclicIndex = function (index) {\n        return (this._startIndex + index) % this._maxLength;\n    };\n    return CircularList;\n}());\nexports.CircularList = CircularList;\n//# sourceMappingURL=CircularList.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SelectionModel = (function () {\n    function SelectionModel(_terminal) {\n        this._terminal = _terminal;\n        this.clearSelection();\n    }\n    SelectionModel.prototype.clearSelection = function () {\n        this.selectionStart = null;\n        this.selectionEnd = null;\n        this.isSelectAllActive = false;\n        this.selectionStartLength = 0;\n    };\n    Object.defineProperty(SelectionModel.prototype, \"finalSelectionStart\", {\n        get: function () {\n            if (this.isSelectAllActive) {\n                return [0, 0];\n            }\n            if (!this.selectionEnd || !this.selectionStart) {\n                return this.selectionStart;\n            }\n            return this.areSelectionValuesReversed() ? this.selectionEnd : this.selectionStart;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionModel.prototype, \"finalSelectionEnd\", {\n        get: function () {\n            if (this.isSelectAllActive) {\n                return [this._terminal.cols, this._terminal.buffer.ybase + this._terminal.rows - 1];\n            }\n            if (!this.selectionStart) {\n                return null;\n            }\n            if (!this.selectionEnd || this.areSelectionValuesReversed()) {\n                var startPlusLength = this.selectionStart[0] + this.selectionStartLength;\n                if (startPlusLength > this._terminal.cols) {\n                    return [startPlusLength % this._terminal.cols, this.selectionStart[1] + Math.floor(startPlusLength / this._terminal.cols)];\n                }\n                return [startPlusLength, this.selectionStart[1]];\n            }\n            if (this.selectionStartLength) {\n                if (this.selectionEnd[1] === this.selectionStart[1]) {\n                    return [Math.max(this.selectionStart[0] + this.selectionStartLength, this.selectionEnd[0]), this.selectionEnd[1]];\n                }\n            }\n            return this.selectionEnd;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionModel.prototype.areSelectionValuesReversed = function () {\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        if (!start || !end) {\n            return false;\n        }\n        return start[1] > end[1] || (start[1] === end[1] && start[0] > end[0]);\n    };\n    SelectionModel.prototype.onTrim = function (amount) {\n        if (this.selectionStart) {\n            this.selectionStart[1] -= amount;\n        }\n        if (this.selectionEnd) {\n            this.selectionEnd[1] -= amount;\n        }\n        if (this.selectionEnd && this.selectionEnd[1] < 0) {\n            this.clearSelection();\n            return true;\n        }\n        if (this.selectionStart && this.selectionStart[1] < 0) {\n            this.selectionStart[1] = 0;\n        }\n        return false;\n    };\n    return SelectionModel;\n}());\nexports.SelectionModel = SelectionModel;\n//# sourceMappingURL=SelectionModel.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DEFAULT_FOREGROUND = fromHex('#ffffff');\nvar DEFAULT_BACKGROUND = fromHex('#000000');\nvar DEFAULT_CURSOR = fromHex('#ffffff');\nvar DEFAULT_CURSOR_ACCENT = fromHex('#000000');\nvar DEFAULT_SELECTION = {\n    css: 'rgba(255, 255, 255, 0.3)',\n    rgba: 0xFFFFFF77\n};\nexports.DEFAULT_ANSI_COLORS = (function () {\n    var colors = [\n        fromHex('#2e3436'),\n        fromHex('#cc0000'),\n        fromHex('#4e9a06'),\n        fromHex('#c4a000'),\n        fromHex('#3465a4'),\n        fromHex('#75507b'),\n        fromHex('#06989a'),\n        fromHex('#d3d7cf'),\n        fromHex('#555753'),\n        fromHex('#ef2929'),\n        fromHex('#8ae234'),\n        fromHex('#fce94f'),\n        fromHex('#729fcf'),\n        fromHex('#ad7fa8'),\n        fromHex('#34e2e2'),\n        fromHex('#eeeeec')\n    ];\n    var v = [0x00, 0x5f, 0x87, 0xaf, 0xd7, 0xff];\n    for (var i = 0; i < 216; i++) {\n        var r = v[(i / 36) % 6 | 0];\n        var g = v[(i / 6) % 6 | 0];\n        var b = v[i % 6];\n        colors.push({\n            css: \"#\" + toPaddedHex(r) + toPaddedHex(g) + toPaddedHex(b),\n            rgba: ((r << 24) | (g << 16) | (b << 8) | 0xFF) >>> 0\n        });\n    }\n    for (var i = 0; i < 24; i++) {\n        var c = 8 + i * 10;\n        var ch = toPaddedHex(c);\n        colors.push({\n            css: \"#\" + ch + ch + ch,\n            rgba: ((c << 24) | (c << 16) | (c << 8) | 0xFF) >>> 0\n        });\n    }\n    return colors;\n})();\nfunction fromHex(css) {\n    return {\n        css: css,\n        rgba: parseInt(css.slice(1), 16) << 8 | 0xFF\n    };\n}\nfunction toPaddedHex(c) {\n    var s = c.toString(16);\n    return s.length < 2 ? '0' + s : s;\n}\nvar ColorManager = (function () {\n    function ColorManager(document, allowTransparency) {\n        this.allowTransparency = allowTransparency;\n        var canvas = document.createElement('canvas');\n        canvas.width = 1;\n        canvas.height = 1;\n        this._ctx = canvas.getContext('2d');\n        this._ctx.globalCompositeOperation = 'copy';\n        this._litmusColor = this._ctx.createLinearGradient(0, 0, 1, 1);\n        this.colors = {\n            foreground: DEFAULT_FOREGROUND,\n            background: DEFAULT_BACKGROUND,\n            cursor: DEFAULT_CURSOR,\n            cursorAccent: DEFAULT_CURSOR_ACCENT,\n            selection: DEFAULT_SELECTION,\n            ansi: exports.DEFAULT_ANSI_COLORS.slice()\n        };\n    }\n    ColorManager.prototype.setTheme = function (theme) {\n        this.colors.foreground = this._parseColor(theme.foreground, DEFAULT_FOREGROUND);\n        this.colors.background = this._parseColor(theme.background, DEFAULT_BACKGROUND);\n        this.colors.cursor = this._parseColor(theme.cursor, DEFAULT_CURSOR, true);\n        this.colors.cursorAccent = this._parseColor(theme.cursorAccent, DEFAULT_CURSOR_ACCENT, true);\n        this.colors.selection = this._parseColor(theme.selection, DEFAULT_SELECTION, true);\n        this.colors.ansi[0] = this._parseColor(theme.black, exports.DEFAULT_ANSI_COLORS[0]);\n        this.colors.ansi[1] = this._parseColor(theme.red, exports.DEFAULT_ANSI_COLORS[1]);\n        this.colors.ansi[2] = this._parseColor(theme.green, exports.DEFAULT_ANSI_COLORS[2]);\n        this.colors.ansi[3] = this._parseColor(theme.yellow, exports.DEFAULT_ANSI_COLORS[3]);\n        this.colors.ansi[4] = this._parseColor(theme.blue, exports.DEFAULT_ANSI_COLORS[4]);\n        this.colors.ansi[5] = this._parseColor(theme.magenta, exports.DEFAULT_ANSI_COLORS[5]);\n        this.colors.ansi[6] = this._parseColor(theme.cyan, exports.DEFAULT_ANSI_COLORS[6]);\n        this.colors.ansi[7] = this._parseColor(theme.white, exports.DEFAULT_ANSI_COLORS[7]);\n        this.colors.ansi[8] = this._parseColor(theme.brightBlack, exports.DEFAULT_ANSI_COLORS[8]);\n        this.colors.ansi[9] = this._parseColor(theme.brightRed, exports.DEFAULT_ANSI_COLORS[9]);\n        this.colors.ansi[10] = this._parseColor(theme.brightGreen, exports.DEFAULT_ANSI_COLORS[10]);\n        this.colors.ansi[11] = this._parseColor(theme.brightYellow, exports.DEFAULT_ANSI_COLORS[11]);\n        this.colors.ansi[12] = this._parseColor(theme.brightBlue, exports.DEFAULT_ANSI_COLORS[12]);\n        this.colors.ansi[13] = this._parseColor(theme.brightMagenta, exports.DEFAULT_ANSI_COLORS[13]);\n        this.colors.ansi[14] = this._parseColor(theme.brightCyan, exports.DEFAULT_ANSI_COLORS[14]);\n        this.colors.ansi[15] = this._parseColor(theme.brightWhite, exports.DEFAULT_ANSI_COLORS[15]);\n    };\n    ColorManager.prototype._parseColor = function (css, fallback, allowTransparency) {\n        if (allowTransparency === void 0) { allowTransparency = this.allowTransparency; }\n        if (!css) {\n            return fallback;\n        }\n        this._ctx.fillStyle = this._litmusColor;\n        this._ctx.fillStyle = css;\n        if (typeof this._ctx.fillStyle !== 'string') {\n            console.warn(\"Color: \" + css + \" is invalid using fallback \" + fallback.css);\n            return fallback;\n        }\n        this._ctx.fillRect(0, 0, 1, 1);\n        var data = this._ctx.getImageData(0, 0, 1, 1).data;\n        if (!allowTransparency && data[3] !== 0xFF) {\n            console.warn(\"Color: \" + css + \" is using transparency, but allowTransparency is false. \" +\n                (\"Using fallback \" + fallback.css + \".\"));\n            return fallback;\n        }\n        return {\n            css: css,\n            rgba: (data[0] << 24 | data[1] << 16 | data[2] << 8 | data[3]) >>> 0\n        };\n    };\n    return ColorManager;\n}());\nexports.ColorManager = ColorManager;\n//# sourceMappingURL=ColorManager.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EscapeSequences_1 = require(\"./common/data/EscapeSequences\");\nvar Charsets_1 = require(\"./core/data/Charsets\");\nvar Buffer_1 = require(\"./Buffer\");\nvar CharWidth_1 = require(\"./CharWidth\");\nvar EscapeSequenceParser_1 = require(\"./EscapeSequenceParser\");\nvar Lifecycle_1 = require(\"./common/Lifecycle\");\nvar TypedArrayUtils_1 = require(\"./common/TypedArrayUtils\");\nvar TextDecoder_1 = require(\"./core/input/TextDecoder\");\nvar BufferLine_1 = require(\"./BufferLine\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar GLEVEL = { '(': 0, ')': 1, '*': 2, '+': 3, '-': 1, '.': 2 };\nvar DECRQSS = (function () {\n    function DECRQSS(_terminal) {\n        this._terminal = _terminal;\n        this._data = new Uint32Array(0);\n    }\n    DECRQSS.prototype.hook = function (collect, params, flag) {\n        this._data = new Uint32Array(0);\n    };\n    DECRQSS.prototype.put = function (data, start, end) {\n        this._data = TypedArrayUtils_1.concat(this._data, data.subarray(start, end));\n    };\n    DECRQSS.prototype.unhook = function () {\n        var data = TextDecoder_1.utf32ToString(this._data);\n        this._data = new Uint32Array(0);\n        switch (data) {\n            case '\"q':\n                return this._terminal.handler(EscapeSequences_1.C0.ESC + \"P1$r0\\\"q\" + EscapeSequences_1.C0.ESC + \"\\\\\");\n            case '\"p':\n                return this._terminal.handler(EscapeSequences_1.C0.ESC + \"P1$r61\\\"p\" + EscapeSequences_1.C0.ESC + \"\\\\\");\n            case 'r':\n                var pt = '' + (this._terminal.buffer.scrollTop + 1) +\n                    ';' + (this._terminal.buffer.scrollBottom + 1) + 'r';\n                return this._terminal.handler(EscapeSequences_1.C0.ESC + \"P1$r\" + pt + EscapeSequences_1.C0.ESC + \"\\\\\");\n            case 'm':\n                return this._terminal.handler(EscapeSequences_1.C0.ESC + \"P1$r0m\" + EscapeSequences_1.C0.ESC + \"\\\\\");\n            case ' q':\n                var STYLES = { 'block': 2, 'underline': 4, 'bar': 6 };\n                var style = STYLES[this._terminal.getOption('cursorStyle')];\n                style -= this._terminal.getOption('cursorBlink');\n                return this._terminal.handler(EscapeSequences_1.C0.ESC + \"P1$r\" + style + \" q\" + EscapeSequences_1.C0.ESC + \"\\\\\");\n            default:\n                this._terminal.error('Unknown DCS $q %s', data);\n                this._terminal.handler(EscapeSequences_1.C0.ESC + \"P0$r\" + EscapeSequences_1.C0.ESC + \"\\\\\");\n        }\n    };\n    return DECRQSS;\n}());\nvar InputHandler = (function (_super) {\n    __extends(InputHandler, _super);\n    function InputHandler(_terminal, _parser) {\n        if (_parser === void 0) { _parser = new EscapeSequenceParser_1.EscapeSequenceParser(); }\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._parser = _parser;\n        _this._parseBuffer = new Uint32Array(4096);\n        _this._stringDecoder = new TextDecoder_1.StringToUtf32();\n        _this._workCell = new BufferLine_1.CellData();\n        _this._onCursorMove = new EventEmitter2_1.EventEmitter2();\n        _this._onData = new EventEmitter2_1.EventEmitter2();\n        _this._onLineFeed = new EventEmitter2_1.EventEmitter2();\n        _this._onScroll = new EventEmitter2_1.EventEmitter2();\n        _this.register(_this._parser);\n        _this._parser.setCsiHandlerFallback(function (collect, params, flag) {\n            _this._terminal.error('Unknown CSI code: ', { collect: collect, params: params, flag: String.fromCharCode(flag) });\n        });\n        _this._parser.setEscHandlerFallback(function (collect, flag) {\n            _this._terminal.error('Unknown ESC code: ', { collect: collect, flag: String.fromCharCode(flag) });\n        });\n        _this._parser.setExecuteHandlerFallback(function (code) {\n            _this._terminal.error('Unknown EXECUTE code: ', { code: code });\n        });\n        _this._parser.setOscHandlerFallback(function (identifier, data) {\n            _this._terminal.error('Unknown OSC code: ', { identifier: identifier, data: data });\n        });\n        _this._parser.setPrintHandler(function (data, start, end) { return _this.print(data, start, end); });\n        _this._parser.setCsiHandler('@', function (params, collect) { return _this.insertChars(params); });\n        _this._parser.setCsiHandler('A', function (params, collect) { return _this.cursorUp(params); });\n        _this._parser.setCsiHandler('B', function (params, collect) { return _this.cursorDown(params); });\n        _this._parser.setCsiHandler('C', function (params, collect) { return _this.cursorForward(params); });\n        _this._parser.setCsiHandler('D', function (params, collect) { return _this.cursorBackward(params); });\n        _this._parser.setCsiHandler('E', function (params, collect) { return _this.cursorNextLine(params); });\n        _this._parser.setCsiHandler('F', function (params, collect) { return _this.cursorPrecedingLine(params); });\n        _this._parser.setCsiHandler('G', function (params, collect) { return _this.cursorCharAbsolute(params); });\n        _this._parser.setCsiHandler('H', function (params, collect) { return _this.cursorPosition(params); });\n        _this._parser.setCsiHandler('I', function (params, collect) { return _this.cursorForwardTab(params); });\n        _this._parser.setCsiHandler('J', function (params, collect) { return _this.eraseInDisplay(params); });\n        _this._parser.setCsiHandler('K', function (params, collect) { return _this.eraseInLine(params); });\n        _this._parser.setCsiHandler('L', function (params, collect) { return _this.insertLines(params); });\n        _this._parser.setCsiHandler('M', function (params, collect) { return _this.deleteLines(params); });\n        _this._parser.setCsiHandler('P', function (params, collect) { return _this.deleteChars(params); });\n        _this._parser.setCsiHandler('S', function (params, collect) { return _this.scrollUp(params); });\n        _this._parser.setCsiHandler('T', function (params, collect) { return _this.scrollDown(params, collect); });\n        _this._parser.setCsiHandler('X', function (params, collect) { return _this.eraseChars(params); });\n        _this._parser.setCsiHandler('Z', function (params, collect) { return _this.cursorBackwardTab(params); });\n        _this._parser.setCsiHandler('`', function (params, collect) { return _this.charPosAbsolute(params); });\n        _this._parser.setCsiHandler('a', function (params, collect) { return _this.hPositionRelative(params); });\n        _this._parser.setCsiHandler('b', function (params, collect) { return _this.repeatPrecedingCharacter(params); });\n        _this._parser.setCsiHandler('c', function (params, collect) { return _this.sendDeviceAttributes(params, collect); });\n        _this._parser.setCsiHandler('d', function (params, collect) { return _this.linePosAbsolute(params); });\n        _this._parser.setCsiHandler('e', function (params, collect) { return _this.vPositionRelative(params); });\n        _this._parser.setCsiHandler('f', function (params, collect) { return _this.hVPosition(params); });\n        _this._parser.setCsiHandler('g', function (params, collect) { return _this.tabClear(params); });\n        _this._parser.setCsiHandler('h', function (params, collect) { return _this.setMode(params, collect); });\n        _this._parser.setCsiHandler('l', function (params, collect) { return _this.resetMode(params, collect); });\n        _this._parser.setCsiHandler('m', function (params, collect) { return _this.charAttributes(params); });\n        _this._parser.setCsiHandler('n', function (params, collect) { return _this.deviceStatus(params, collect); });\n        _this._parser.setCsiHandler('p', function (params, collect) { return _this.softReset(params, collect); });\n        _this._parser.setCsiHandler('q', function (params, collect) { return _this.setCursorStyle(params, collect); });\n        _this._parser.setCsiHandler('r', function (params, collect) { return _this.setScrollRegion(params, collect); });\n        _this._parser.setCsiHandler('s', function (params, collect) { return _this.saveCursor(params); });\n        _this._parser.setCsiHandler('u', function (params, collect) { return _this.restoreCursor(params); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.BEL, function () { return _this.bell(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.LF, function () { return _this.lineFeed(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.VT, function () { return _this.lineFeed(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.FF, function () { return _this.lineFeed(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.CR, function () { return _this.carriageReturn(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.BS, function () { return _this.backspace(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.HT, function () { return _this.tab(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.SO, function () { return _this.shiftOut(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C0.SI, function () { return _this.shiftIn(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C1.IND, function () { return _this.index(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C1.NEL, function () { return _this.nextLine(); });\n        _this._parser.setExecuteHandler(EscapeSequences_1.C1.HTS, function () { return _this.tabSet(); });\n        _this._parser.setOscHandler(0, function (data) { return _this.setTitle(data); });\n        _this._parser.setOscHandler(2, function (data) { return _this.setTitle(data); });\n        _this._parser.setEscHandler('7', function () { return _this.saveCursor([]); });\n        _this._parser.setEscHandler('8', function () { return _this.restoreCursor([]); });\n        _this._parser.setEscHandler('D', function () { return _this.index(); });\n        _this._parser.setEscHandler('E', function () { return _this.nextLine(); });\n        _this._parser.setEscHandler('H', function () { return _this.tabSet(); });\n        _this._parser.setEscHandler('M', function () { return _this.reverseIndex(); });\n        _this._parser.setEscHandler('=', function () { return _this.keypadApplicationMode(); });\n        _this._parser.setEscHandler('>', function () { return _this.keypadNumericMode(); });\n        _this._parser.setEscHandler('c', function () { return _this.reset(); });\n        _this._parser.setEscHandler('n', function () { return _this.setgLevel(2); });\n        _this._parser.setEscHandler('o', function () { return _this.setgLevel(3); });\n        _this._parser.setEscHandler('|', function () { return _this.setgLevel(3); });\n        _this._parser.setEscHandler('}', function () { return _this.setgLevel(2); });\n        _this._parser.setEscHandler('~', function () { return _this.setgLevel(1); });\n        _this._parser.setEscHandler('%@', function () { return _this.selectDefaultCharset(); });\n        _this._parser.setEscHandler('%G', function () { return _this.selectDefaultCharset(); });\n        var _loop_1 = function (flag) {\n            this_1._parser.setEscHandler('(' + flag, function () { return _this.selectCharset('(' + flag); });\n            this_1._parser.setEscHandler(')' + flag, function () { return _this.selectCharset(')' + flag); });\n            this_1._parser.setEscHandler('*' + flag, function () { return _this.selectCharset('*' + flag); });\n            this_1._parser.setEscHandler('+' + flag, function () { return _this.selectCharset('+' + flag); });\n            this_1._parser.setEscHandler('-' + flag, function () { return _this.selectCharset('-' + flag); });\n            this_1._parser.setEscHandler('.' + flag, function () { return _this.selectCharset('.' + flag); });\n            this_1._parser.setEscHandler('/' + flag, function () { return _this.selectCharset('/' + flag); });\n        };\n        var this_1 = this;\n        for (var flag in Charsets_1.CHARSETS) {\n            _loop_1(flag);\n        }\n        _this._parser.setErrorHandler(function (state) {\n            _this._terminal.error('Parsing error: ', state);\n            return state;\n        });\n        _this._parser.setDcsHandler('$q', new DECRQSS(_this._terminal));\n        return _this;\n    }\n    Object.defineProperty(InputHandler.prototype, \"onCursorMove\", {\n        get: function () { return this._onCursorMove.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(InputHandler.prototype, \"onData\", {\n        get: function () { return this._onData.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(InputHandler.prototype, \"onLineFeed\", {\n        get: function () { return this._onLineFeed.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(InputHandler.prototype, \"onScroll\", {\n        get: function () { return this._onScroll.event; },\n        enumerable: true,\n        configurable: true\n    });\n    InputHandler.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._terminal = null;\n    };\n    InputHandler.prototype.parse = function (data) {\n        if (!this._terminal) {\n            return;\n        }\n        var buffer = this._terminal.buffer;\n        var cursorStartX = buffer.x;\n        var cursorStartY = buffer.y;\n        if (this._terminal.debug) {\n            this._terminal.log('data: ' + data);\n        }\n        if (this._parseBuffer.length < data.length) {\n            this._parseBuffer = new Uint32Array(data.length);\n        }\n        this._parser.parse(this._parseBuffer, this._stringDecoder.decode(data, this._parseBuffer));\n        buffer = this._terminal.buffer;\n        if (buffer.x !== cursorStartX || buffer.y !== cursorStartY) {\n            this._onCursorMove.fire();\n        }\n    };\n    InputHandler.prototype.print = function (data, start, end) {\n        var code;\n        var chWidth;\n        var buffer = this._terminal.buffer;\n        var charset = this._terminal.charset;\n        var screenReaderMode = this._terminal.options.screenReaderMode;\n        var cols = this._terminal.cols;\n        var wraparoundMode = this._terminal.wraparoundMode;\n        var insertMode = this._terminal.insertMode;\n        var curAttr = this._terminal.curAttrData;\n        var bufferRow = buffer.lines.get(buffer.y + buffer.ybase);\n        this._terminal.updateRange(buffer.y);\n        for (var pos = start; pos < end; ++pos) {\n            code = data[pos];\n            chWidth = CharWidth_1.wcwidth(code);\n            if (code < 127 && charset) {\n                var ch = charset[String.fromCharCode(code)];\n                if (ch) {\n                    code = ch.charCodeAt(0);\n                }\n            }\n            if (screenReaderMode) {\n                this._terminal.emit('a11y.char', TextDecoder_1.stringFromCodePoint(code));\n            }\n            if (!chWidth && buffer.x) {\n                if (!bufferRow.getWidth(buffer.x - 1)) {\n                    bufferRow.addCodepointToCell(buffer.x - 2, code);\n                }\n                else {\n                    bufferRow.addCodepointToCell(buffer.x - 1, code);\n                }\n                continue;\n            }\n            if (buffer.x + chWidth - 1 >= cols) {\n                if (wraparoundMode) {\n                    buffer.x = 0;\n                    buffer.y++;\n                    if (buffer.y > buffer.scrollBottom) {\n                        buffer.y--;\n                        this._terminal.scroll(true);\n                    }\n                    else {\n                        buffer.lines.get(buffer.y).isWrapped = true;\n                    }\n                    bufferRow = buffer.lines.get(buffer.y + buffer.ybase);\n                }\n                else {\n                    if (chWidth === 2) {\n                        continue;\n                    }\n                }\n            }\n            if (insertMode) {\n                bufferRow.insertCells(buffer.x, chWidth, buffer.getNullCell(curAttr));\n                if (bufferRow.getWidth(cols - 1) === 2) {\n                    bufferRow.setCellFromCodePoint(cols - 1, Buffer_1.NULL_CELL_CODE, Buffer_1.NULL_CELL_WIDTH, curAttr.fg, curAttr.bg);\n                }\n            }\n            bufferRow.setCellFromCodePoint(buffer.x++, code, chWidth, curAttr.fg, curAttr.bg);\n            if (chWidth > 0) {\n                while (--chWidth) {\n                    bufferRow.setCellFromCodePoint(buffer.x++, 0, 0, curAttr.fg, curAttr.bg);\n                }\n            }\n        }\n        this._terminal.updateRange(buffer.y);\n    };\n    InputHandler.prototype.addCsiHandler = function (flag, callback) {\n        return this._parser.addCsiHandler(flag, callback);\n    };\n    InputHandler.prototype.addOscHandler = function (ident, callback) {\n        return this._parser.addOscHandler(ident, callback);\n    };\n    InputHandler.prototype.bell = function () {\n        this._terminal.bell();\n    };\n    InputHandler.prototype.lineFeed = function () {\n        var buffer = this._terminal.buffer;\n        if (this._terminal.options.convertEol) {\n            buffer.x = 0;\n        }\n        buffer.y++;\n        if (buffer.y > buffer.scrollBottom) {\n            buffer.y--;\n            this._terminal.scroll();\n        }\n        if (buffer.x >= this._terminal.cols) {\n            buffer.x--;\n        }\n        this._onLineFeed.fire();\n    };\n    InputHandler.prototype.carriageReturn = function () {\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.backspace = function () {\n        if (this._terminal.buffer.x > 0) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.tab = function () {\n        var originalX = this._terminal.buffer.x;\n        this._terminal.buffer.x = this._terminal.buffer.nextStop();\n        if (this._terminal.options.screenReaderMode) {\n            this._terminal.emit('a11y.tab', this._terminal.buffer.x - originalX);\n        }\n    };\n    InputHandler.prototype.shiftOut = function () {\n        this._terminal.setgLevel(1);\n    };\n    InputHandler.prototype.shiftIn = function () {\n        this._terminal.setgLevel(0);\n    };\n    InputHandler.prototype.insertChars = function (params) {\n        this._terminal.buffer.lines.get(this._terminal.buffer.y + this._terminal.buffer.ybase).insertCells(this._terminal.buffer.x, params[0] || 1, this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));\n        this._terminal.updateRange(this._terminal.buffer.y);\n    };\n    InputHandler.prototype.cursorUp = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y -= param;\n        if (this._terminal.buffer.y < 0) {\n            this._terminal.buffer.y = 0;\n        }\n    };\n    InputHandler.prototype.cursorDown = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.cursorForward = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x += param;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.cursorBackward = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n        this._terminal.buffer.x -= param;\n        if (this._terminal.buffer.x < 0) {\n            this._terminal.buffer.x = 0;\n        }\n    };\n    InputHandler.prototype.cursorNextLine = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.cursorPrecedingLine = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y -= param;\n        if (this._terminal.buffer.y < 0) {\n            this._terminal.buffer.y = 0;\n        }\n        this._terminal.buffer.x = 0;\n    };\n    InputHandler.prototype.cursorCharAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x = param - 1;\n    };\n    InputHandler.prototype.cursorPosition = function (params) {\n        var col;\n        var row = params[0] - 1;\n        if (params.length >= 2) {\n            col = params[1] - 1;\n        }\n        else {\n            col = 0;\n        }\n        if (row < 0) {\n            row = 0;\n        }\n        else if (row >= this._terminal.rows) {\n            row = this._terminal.rows - 1;\n        }\n        if (col < 0) {\n            col = 0;\n        }\n        else if (col >= this._terminal.cols) {\n            col = this._terminal.cols - 1;\n        }\n        this._terminal.buffer.x = col;\n        this._terminal.buffer.y = row;\n    };\n    InputHandler.prototype.cursorForwardTab = function (params) {\n        var param = params[0] || 1;\n        while (param--) {\n            this._terminal.buffer.x = this._terminal.buffer.nextStop();\n        }\n    };\n    InputHandler.prototype._eraseInBufferLine = function (y, start, end, clearWrap) {\n        if (clearWrap === void 0) { clearWrap = false; }\n        var line = this._terminal.buffer.lines.get(this._terminal.buffer.ybase + y);\n        line.replaceCells(start, end, this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));\n        if (clearWrap) {\n            line.isWrapped = false;\n        }\n    };\n    InputHandler.prototype._resetBufferLine = function (y) {\n        this._eraseInBufferLine(y, 0, this._terminal.cols, true);\n    };\n    InputHandler.prototype.eraseInDisplay = function (params) {\n        var j;\n        switch (params[0]) {\n            case 0:\n                j = this._terminal.buffer.y;\n                this._terminal.updateRange(j);\n                this._eraseInBufferLine(j++, this._terminal.buffer.x, this._terminal.cols, this._terminal.buffer.x === 0);\n                for (; j < this._terminal.rows; j++) {\n                    this._resetBufferLine(j);\n                }\n                this._terminal.updateRange(j);\n                break;\n            case 1:\n                j = this._terminal.buffer.y;\n                this._terminal.updateRange(j);\n                this._eraseInBufferLine(j, 0, this._terminal.buffer.x + 1, true);\n                if (this._terminal.buffer.x + 1 >= this._terminal.cols) {\n                    this._terminal.buffer.lines.get(j + 1).isWrapped = false;\n                }\n                while (j--) {\n                    this._resetBufferLine(j);\n                }\n                this._terminal.updateRange(0);\n                break;\n            case 2:\n                j = this._terminal.rows;\n                this._terminal.updateRange(j - 1);\n                while (j--) {\n                    this._resetBufferLine(j);\n                }\n                this._terminal.updateRange(0);\n                break;\n            case 3:\n                var scrollBackSize = this._terminal.buffer.lines.length - this._terminal.rows;\n                if (scrollBackSize > 0) {\n                    this._terminal.buffer.lines.trimStart(scrollBackSize);\n                    this._terminal.buffer.ybase = Math.max(this._terminal.buffer.ybase - scrollBackSize, 0);\n                    this._terminal.buffer.ydisp = Math.max(this._terminal.buffer.ydisp - scrollBackSize, 0);\n                    this._onScroll.fire(0);\n                }\n                break;\n        }\n    };\n    InputHandler.prototype.eraseInLine = function (params) {\n        switch (params[0]) {\n            case 0:\n                this._eraseInBufferLine(this._terminal.buffer.y, this._terminal.buffer.x, this._terminal.cols);\n                break;\n            case 1:\n                this._eraseInBufferLine(this._terminal.buffer.y, 0, this._terminal.buffer.x + 1);\n                break;\n            case 2:\n                this._eraseInBufferLine(this._terminal.buffer.y, 0, this._terminal.cols);\n                break;\n        }\n        this._terminal.updateRange(this._terminal.buffer.y);\n    };\n    InputHandler.prototype.insertLines = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var buffer = this._terminal.buffer;\n        var row = buffer.y + buffer.ybase;\n        var scrollBottomRowsOffset = this._terminal.rows - 1 - buffer.scrollBottom;\n        var scrollBottomAbsolute = this._terminal.rows - 1 + buffer.ybase - scrollBottomRowsOffset + 1;\n        while (param--) {\n            buffer.lines.splice(scrollBottomAbsolute - 1, 1);\n            buffer.lines.splice(row, 0, buffer.getBlankLine(this._terminal.eraseAttrData()));\n        }\n        this._terminal.updateRange(buffer.y);\n        this._terminal.updateRange(buffer.scrollBottom);\n    };\n    InputHandler.prototype.deleteLines = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        var buffer = this._terminal.buffer;\n        var row = buffer.y + buffer.ybase;\n        var j;\n        j = this._terminal.rows - 1 - buffer.scrollBottom;\n        j = this._terminal.rows - 1 + buffer.ybase - j;\n        while (param--) {\n            buffer.lines.splice(row, 1);\n            buffer.lines.splice(j, 0, buffer.getBlankLine(this._terminal.eraseAttrData()));\n        }\n        this._terminal.updateRange(buffer.y);\n        this._terminal.updateRange(buffer.scrollBottom);\n    };\n    InputHandler.prototype.deleteChars = function (params) {\n        this._terminal.buffer.lines.get(this._terminal.buffer.y + this._terminal.buffer.ybase).deleteCells(this._terminal.buffer.x, params[0] || 1, this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));\n        this._terminal.updateRange(this._terminal.buffer.y);\n    };\n    InputHandler.prototype.scrollUp = function (params) {\n        var param = params[0] || 1;\n        var buffer = this._terminal.buffer;\n        while (param--) {\n            buffer.lines.splice(buffer.ybase + buffer.scrollTop, 1);\n            buffer.lines.splice(buffer.ybase + buffer.scrollBottom, 0, buffer.getBlankLine(Buffer_1.DEFAULT_ATTR_DATA));\n        }\n        this._terminal.updateRange(buffer.scrollTop);\n        this._terminal.updateRange(buffer.scrollBottom);\n    };\n    InputHandler.prototype.scrollDown = function (params, collect) {\n        if (params.length < 2 && !collect) {\n            var param = params[0] || 1;\n            var buffer = this._terminal.buffer;\n            while (param--) {\n                buffer.lines.splice(buffer.ybase + buffer.scrollBottom, 1);\n                buffer.lines.splice(buffer.ybase + buffer.scrollTop, 0, buffer.getBlankLine(Buffer_1.DEFAULT_ATTR_DATA));\n            }\n            this._terminal.updateRange(buffer.scrollTop);\n            this._terminal.updateRange(buffer.scrollBottom);\n        }\n    };\n    InputHandler.prototype.eraseChars = function (params) {\n        this._terminal.buffer.lines.get(this._terminal.buffer.y + this._terminal.buffer.ybase).replaceCells(this._terminal.buffer.x, this._terminal.buffer.x + (params[0] || 1), this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));\n    };\n    InputHandler.prototype.cursorBackwardTab = function (params) {\n        var param = params[0] || 1;\n        var buffer = this._terminal.buffer;\n        while (param--) {\n            buffer.x = buffer.prevStop();\n        }\n    };\n    InputHandler.prototype.charPosAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x = param - 1;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.hPositionRelative = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.x += param;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.repeatPrecedingCharacter = function (params) {\n        var buffer = this._terminal.buffer;\n        var line = buffer.lines.get(buffer.ybase + buffer.y);\n        line.loadCell(buffer.x - 1, this._workCell);\n        line.replaceCells(buffer.x, buffer.x + (params[0] || 1), (this._workCell.content !== undefined) ? this._workCell : buffer.getNullCell(Buffer_1.DEFAULT_ATTR_DATA));\n    };\n    InputHandler.prototype.sendDeviceAttributes = function (params, collect) {\n        if (params[0] > 0) {\n            return;\n        }\n        if (!collect) {\n            if (this._terminal.is('xterm') || this._terminal.is('rxvt-unicode') || this._terminal.is('screen')) {\n                this._terminal.handler(EscapeSequences_1.C0.ESC + '[?1;2c');\n            }\n            else if (this._terminal.is('linux')) {\n                this._terminal.handler(EscapeSequences_1.C0.ESC + '[?6c');\n            }\n        }\n        else if (collect === '>') {\n            if (this._terminal.is('xterm')) {\n                this._terminal.handler(EscapeSequences_1.C0.ESC + '[>0;276;0c');\n            }\n            else if (this._terminal.is('rxvt-unicode')) {\n                this._terminal.handler(EscapeSequences_1.C0.ESC + '[>85;95;0c');\n            }\n            else if (this._terminal.is('linux')) {\n                this._terminal.handler(params[0] + 'c');\n            }\n            else if (this._terminal.is('screen')) {\n                this._terminal.handler(EscapeSequences_1.C0.ESC + '[>83;40003;0c');\n            }\n        }\n    };\n    InputHandler.prototype.linePosAbsolute = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y = param - 1;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n    };\n    InputHandler.prototype.vPositionRelative = function (params) {\n        var param = params[0];\n        if (param < 1) {\n            param = 1;\n        }\n        this._terminal.buffer.y += param;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x--;\n        }\n    };\n    InputHandler.prototype.hVPosition = function (params) {\n        if (params[0] < 1)\n            params[0] = 1;\n        if (params[1] < 1)\n            params[1] = 1;\n        this._terminal.buffer.y = params[0] - 1;\n        if (this._terminal.buffer.y >= this._terminal.rows) {\n            this._terminal.buffer.y = this._terminal.rows - 1;\n        }\n        this._terminal.buffer.x = params[1] - 1;\n        if (this._terminal.buffer.x >= this._terminal.cols) {\n            this._terminal.buffer.x = this._terminal.cols - 1;\n        }\n    };\n    InputHandler.prototype.tabClear = function (params) {\n        var param = params[0];\n        if (param <= 0) {\n            delete this._terminal.buffer.tabs[this._terminal.buffer.x];\n        }\n        else if (param === 3) {\n            this._terminal.buffer.tabs = {};\n        }\n    };\n    InputHandler.prototype.setMode = function (params, collect) {\n        if (params.length > 1) {\n            for (var i = 0; i < params.length; i++) {\n                this.setMode([params[i]]);\n            }\n            return;\n        }\n        if (!collect) {\n            switch (params[0]) {\n                case 4:\n                    this._terminal.insertMode = true;\n                    break;\n                case 20:\n                    break;\n            }\n        }\n        else if (collect === '?') {\n            switch (params[0]) {\n                case 1:\n                    this._terminal.applicationCursor = true;\n                    break;\n                case 2:\n                    this._terminal.setgCharset(0, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(1, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(2, Charsets_1.DEFAULT_CHARSET);\n                    this._terminal.setgCharset(3, Charsets_1.DEFAULT_CHARSET);\n                    break;\n                case 3:\n                    this._terminal.savedCols = this._terminal.cols;\n                    this._terminal.resize(132, this._terminal.rows);\n                    break;\n                case 6:\n                    this._terminal.originMode = true;\n                    break;\n                case 7:\n                    this._terminal.wraparoundMode = true;\n                    break;\n                case 12:\n                    break;\n                case 66:\n                    this._terminal.log('Serial port requested application keypad.');\n                    this._terminal.applicationKeypad = true;\n                    if (this._terminal.viewport) {\n                        this._terminal.viewport.syncScrollArea();\n                    }\n                    break;\n                case 9:\n                case 1000:\n                case 1002:\n                case 1003:\n                    this._terminal.x10Mouse = params[0] === 9;\n                    this._terminal.vt200Mouse = params[0] === 1000;\n                    this._terminal.normalMouse = params[0] > 1000;\n                    this._terminal.mouseEvents = true;\n                    if (this._terminal.element) {\n                        this._terminal.element.classList.add('enable-mouse-events');\n                    }\n                    if (this._terminal.selectionManager) {\n                        this._terminal.selectionManager.disable();\n                    }\n                    this._terminal.log('Binding to mouse events.');\n                    break;\n                case 1004:\n                    this._terminal.sendFocus = true;\n                    break;\n                case 1005:\n                    this._terminal.utfMouse = true;\n                    break;\n                case 1006:\n                    this._terminal.sgrMouse = true;\n                    break;\n                case 1015:\n                    this._terminal.urxvtMouse = true;\n                    break;\n                case 25:\n                    this._terminal.cursorHidden = false;\n                    break;\n                case 1048:\n                    this.saveCursor(params);\n                    break;\n                case 1049:\n                    this.saveCursor(params);\n                case 47:\n                case 1047:\n                    this._terminal.buffers.activateAltBuffer(this._terminal.eraseAttrData());\n                    this._terminal.refresh(0, this._terminal.rows - 1);\n                    if (this._terminal.viewport) {\n                        this._terminal.viewport.syncScrollArea();\n                    }\n                    this._terminal.showCursor();\n                    break;\n                case 2004:\n                    this._terminal.bracketedPasteMode = true;\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.resetMode = function (params, collect) {\n        if (params.length > 1) {\n            for (var i = 0; i < params.length; i++) {\n                this.resetMode([params[i]]);\n            }\n            return;\n        }\n        if (!collect) {\n            switch (params[0]) {\n                case 4:\n                    this._terminal.insertMode = false;\n                    break;\n                case 20:\n                    break;\n            }\n        }\n        else if (collect === '?') {\n            switch (params[0]) {\n                case 1:\n                    this._terminal.applicationCursor = false;\n                    break;\n                case 3:\n                    if (this._terminal.cols === 132 && this._terminal.savedCols) {\n                        this._terminal.resize(this._terminal.savedCols, this._terminal.rows);\n                    }\n                    delete this._terminal.savedCols;\n                    break;\n                case 6:\n                    this._terminal.originMode = false;\n                    break;\n                case 7:\n                    this._terminal.wraparoundMode = false;\n                    break;\n                case 12:\n                    break;\n                case 66:\n                    this._terminal.log('Switching back to normal keypad.');\n                    this._terminal.applicationKeypad = false;\n                    if (this._terminal.viewport) {\n                        this._terminal.viewport.syncScrollArea();\n                    }\n                    break;\n                case 9:\n                case 1000:\n                case 1002:\n                case 1003:\n                    this._terminal.x10Mouse = false;\n                    this._terminal.vt200Mouse = false;\n                    this._terminal.normalMouse = false;\n                    this._terminal.mouseEvents = false;\n                    if (this._terminal.element) {\n                        this._terminal.element.classList.remove('enable-mouse-events');\n                    }\n                    if (this._terminal.selectionManager) {\n                        this._terminal.selectionManager.enable();\n                    }\n                    break;\n                case 1004:\n                    this._terminal.sendFocus = false;\n                    break;\n                case 1005:\n                    this._terminal.utfMouse = false;\n                    break;\n                case 1006:\n                    this._terminal.sgrMouse = false;\n                    break;\n                case 1015:\n                    this._terminal.urxvtMouse = false;\n                    break;\n                case 25:\n                    this._terminal.cursorHidden = true;\n                    break;\n                case 1048:\n                    this.restoreCursor(params);\n                    break;\n                case 1049:\n                case 47:\n                case 1047:\n                    this._terminal.buffers.activateNormalBuffer();\n                    if (params[0] === 1049) {\n                        this.restoreCursor(params);\n                    }\n                    this._terminal.refresh(0, this._terminal.rows - 1);\n                    if (this._terminal.viewport) {\n                        this._terminal.viewport.syncScrollArea();\n                    }\n                    this._terminal.showCursor();\n                    break;\n                case 2004:\n                    this._terminal.bracketedPasteMode = false;\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.charAttributes = function (params) {\n        if (params.length === 1 && params[0] === 0) {\n            this._terminal.curAttrData.fg = Buffer_1.DEFAULT_ATTR_DATA.fg;\n            this._terminal.curAttrData.bg = Buffer_1.DEFAULT_ATTR_DATA.bg;\n            return;\n        }\n        var l = params.length;\n        var p;\n        var attr = this._terminal.curAttrData;\n        for (var i = 0; i < l; i++) {\n            p = params[i];\n            if (p >= 30 && p <= 37) {\n                attr.fg &= ~(50331648 | 255);\n                attr.fg |= 16777216 | (p - 30);\n            }\n            else if (p >= 40 && p <= 47) {\n                attr.bg &= ~(50331648 | 255);\n                attr.bg |= 16777216 | (p - 40);\n            }\n            else if (p >= 90 && p <= 97) {\n                attr.fg &= ~(50331648 | 255);\n                attr.fg |= 16777216 | (p - 90) | 8;\n            }\n            else if (p >= 100 && p <= 107) {\n                attr.bg &= ~(50331648 | 255);\n                attr.bg |= 16777216 | (p - 100) | 8;\n            }\n            else if (p === 0) {\n                attr.fg = Buffer_1.DEFAULT_ATTR_DATA.fg;\n                attr.bg = Buffer_1.DEFAULT_ATTR_DATA.bg;\n            }\n            else if (p === 1) {\n                attr.fg |= 134217728;\n            }\n            else if (p === 3) {\n                attr.bg |= 67108864;\n            }\n            else if (p === 4) {\n                attr.fg |= 268435456;\n            }\n            else if (p === 5) {\n                attr.fg |= 536870912;\n            }\n            else if (p === 7) {\n                attr.fg |= 67108864;\n            }\n            else if (p === 8) {\n                attr.fg |= 1073741824;\n            }\n            else if (p === 2) {\n                attr.bg |= 134217728;\n            }\n            else if (p === 22) {\n                attr.fg &= ~134217728;\n                attr.bg &= ~134217728;\n            }\n            else if (p === 23) {\n                attr.bg &= ~67108864;\n            }\n            else if (p === 24) {\n                attr.fg &= ~268435456;\n            }\n            else if (p === 25) {\n                attr.fg &= ~536870912;\n            }\n            else if (p === 27) {\n                attr.fg &= ~67108864;\n            }\n            else if (p === 28) {\n                attr.fg &= ~1073741824;\n            }\n            else if (p === 39) {\n                attr.fg &= ~(50331648 | 16777215);\n                attr.fg |= Buffer_1.DEFAULT_ATTR_DATA.fg & (255 | 16777215);\n            }\n            else if (p === 49) {\n                attr.bg &= ~(50331648 | 16777215);\n                attr.bg |= Buffer_1.DEFAULT_ATTR_DATA.bg & (255 | 16777215);\n            }\n            else if (p === 38) {\n                if (params[i + 1] === 2) {\n                    i += 2;\n                    attr.fg |= 50331648;\n                    attr.fg &= ~16777215;\n                    attr.fg |= BufferLine_1.AttributeData.fromColorRGB([params[i], params[i + 1], params[i + 2]]);\n                    i += 2;\n                }\n                else if (params[i + 1] === 5) {\n                    i += 2;\n                    p = params[i] & 0xff;\n                    attr.fg &= ~255;\n                    attr.fg |= 33554432 | p;\n                }\n            }\n            else if (p === 48) {\n                if (params[i + 1] === 2) {\n                    i += 2;\n                    attr.bg |= 50331648;\n                    attr.bg &= ~16777215;\n                    attr.bg |= BufferLine_1.AttributeData.fromColorRGB([params[i], params[i + 1], params[i + 2]]);\n                    i += 2;\n                }\n                else if (params[i + 1] === 5) {\n                    i += 2;\n                    p = params[i] & 0xff;\n                    attr.bg &= ~255;\n                    attr.bg |= 33554432 | p;\n                }\n            }\n            else if (p === 100) {\n                attr.fg &= ~(50331648 | 16777215);\n                attr.fg |= Buffer_1.DEFAULT_ATTR_DATA.fg & (255 | 16777215);\n                attr.bg &= ~(50331648 | 16777215);\n                attr.bg |= Buffer_1.DEFAULT_ATTR_DATA.bg & (255 | 16777215);\n            }\n            else {\n                this._terminal.error('Unknown SGR attribute: %d.', p);\n            }\n        }\n    };\n    InputHandler.prototype.deviceStatus = function (params, collect) {\n        if (!collect) {\n            switch (params[0]) {\n                case 5:\n                    this._onData.fire(EscapeSequences_1.C0.ESC + \"[0n\");\n                    break;\n                case 6:\n                    var y = this._terminal.buffer.y + 1;\n                    var x = this._terminal.buffer.x + 1;\n                    this._onData.fire(EscapeSequences_1.C0.ESC + \"[\" + y + \";\" + x + \"R\");\n                    break;\n            }\n        }\n        else if (collect === '?') {\n            switch (params[0]) {\n                case 6:\n                    var y = this._terminal.buffer.y + 1;\n                    var x = this._terminal.buffer.x + 1;\n                    this._onData.fire(EscapeSequences_1.C0.ESC + \"[?\" + y + \";\" + x + \"R\");\n                    break;\n                case 15:\n                    break;\n                case 25:\n                    break;\n                case 26:\n                    break;\n                case 53:\n                    break;\n            }\n        }\n    };\n    InputHandler.prototype.softReset = function (params, collect) {\n        if (collect === '!') {\n            this._terminal.cursorHidden = false;\n            this._terminal.insertMode = false;\n            this._terminal.originMode = false;\n            this._terminal.wraparoundMode = true;\n            this._terminal.applicationKeypad = false;\n            if (this._terminal.viewport) {\n                this._terminal.viewport.syncScrollArea();\n            }\n            this._terminal.applicationCursor = false;\n            this._terminal.buffer.scrollTop = 0;\n            this._terminal.buffer.scrollBottom = this._terminal.rows - 1;\n            this._terminal.curAttrData = Buffer_1.DEFAULT_ATTR_DATA;\n            this._terminal.buffer.x = this._terminal.buffer.y = 0;\n            this._terminal.charset = null;\n            this._terminal.glevel = 0;\n            this._terminal.charsets = [null];\n        }\n    };\n    InputHandler.prototype.setCursorStyle = function (params, collect) {\n        if (collect === ' ') {\n            var param = params[0] < 1 ? 1 : params[0];\n            switch (param) {\n                case 1:\n                case 2:\n                    this._terminal.setOption('cursorStyle', 'block');\n                    break;\n                case 3:\n                case 4:\n                    this._terminal.setOption('cursorStyle', 'underline');\n                    break;\n                case 5:\n                case 6:\n                    this._terminal.setOption('cursorStyle', 'bar');\n                    break;\n            }\n            var isBlinking = param % 2 === 1;\n            this._terminal.setOption('cursorBlink', isBlinking);\n        }\n    };\n    InputHandler.prototype.setScrollRegion = function (params, collect) {\n        if (collect) {\n            return;\n        }\n        this._terminal.buffer.scrollTop = (params[0] || 1) - 1;\n        this._terminal.buffer.scrollBottom = (params[1] && params[1] <= this._terminal.rows ? params[1] : this._terminal.rows) - 1;\n        this._terminal.buffer.x = 0;\n        this._terminal.buffer.y = 0;\n    };\n    InputHandler.prototype.saveCursor = function (params) {\n        this._terminal.buffer.savedX = this._terminal.buffer.x;\n        this._terminal.buffer.savedY = this._terminal.buffer.y;\n        this._terminal.buffer.savedCurAttrData.fg = this._terminal.curAttrData.fg;\n        this._terminal.buffer.savedCurAttrData.bg = this._terminal.curAttrData.bg;\n    };\n    InputHandler.prototype.restoreCursor = function (params) {\n        this._terminal.buffer.x = this._terminal.buffer.savedX || 0;\n        this._terminal.buffer.y = this._terminal.buffer.savedY || 0;\n        this._terminal.curAttrData.fg = this._terminal.buffer.savedCurAttrData.fg;\n        this._terminal.curAttrData.bg = this._terminal.buffer.savedCurAttrData.bg;\n    };\n    InputHandler.prototype.setTitle = function (data) {\n        this._terminal.handleTitle(data);\n    };\n    InputHandler.prototype.nextLine = function () {\n        this._terminal.buffer.x = 0;\n        this.index();\n    };\n    InputHandler.prototype.keypadApplicationMode = function () {\n        this._terminal.log('Serial port requested application keypad.');\n        this._terminal.applicationKeypad = true;\n        if (this._terminal.viewport) {\n            this._terminal.viewport.syncScrollArea();\n        }\n    };\n    InputHandler.prototype.keypadNumericMode = function () {\n        this._terminal.log('Switching back to normal keypad.');\n        this._terminal.applicationKeypad = false;\n        if (this._terminal.viewport) {\n            this._terminal.viewport.syncScrollArea();\n        }\n    };\n    InputHandler.prototype.selectDefaultCharset = function () {\n        this._terminal.setgLevel(0);\n        this._terminal.setgCharset(0, Charsets_1.DEFAULT_CHARSET);\n    };\n    InputHandler.prototype.selectCharset = function (collectAndFlag) {\n        if (collectAndFlag.length !== 2) {\n            this.selectDefaultCharset();\n            return;\n        }\n        if (collectAndFlag[0] === '/') {\n            return;\n        }\n        this._terminal.setgCharset(GLEVEL[collectAndFlag[0]], Charsets_1.CHARSETS[collectAndFlag[1]] || Charsets_1.DEFAULT_CHARSET);\n        return;\n    };\n    InputHandler.prototype.index = function () {\n        this._terminal.index();\n    };\n    InputHandler.prototype.tabSet = function () {\n        this._terminal.tabSet();\n    };\n    InputHandler.prototype.reverseIndex = function () {\n        this._terminal.reverseIndex();\n    };\n    InputHandler.prototype.reset = function () {\n        this._parser.reset();\n        this._terminal.reset();\n    };\n    InputHandler.prototype.setgLevel = function (level) {\n        this._terminal.setgLevel(level);\n    };\n    return InputHandler;\n}(Lifecycle_1.Disposable));\nexports.InputHandler = InputHandler;\n//# sourceMappingURL=InputHandler.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Disposable = (function () {\n    function Disposable() {\n        this._disposables = [];\n        this._isDisposed = false;\n    }\n    Disposable.prototype.dispose = function () {\n        this._isDisposed = true;\n        this._disposables.forEach(function (d) { return d.dispose(); });\n        this._disposables.length = 0;\n    };\n    Disposable.prototype.register = function (d) {\n        this._disposables.push(d);\n    };\n    Disposable.prototype.unregister = function (d) {\n        var index = this._disposables.indexOf(d);\n        if (index !== -1) {\n            this._disposables.splice(index, 1);\n        }\n    };\n    return Disposable;\n}());\nexports.Disposable = Disposable;\n//# sourceMappingURL=Lifecycle.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isNode = (typeof navigator === 'undefined') ? true : false;\nvar userAgent = (isNode) ? 'node' : navigator.userAgent;\nvar platform = (isNode) ? 'node' : navigator.platform;\nexports.isFirefox = !!~userAgent.indexOf('Firefox');\nexports.isSafari = /^((?!chrome|android).)*safari/i.test(userAgent);\nexports.isMSIE = !!~userAgent.indexOf('MSIE') || !!~userAgent.indexOf('Trident');\nexports.isMac = contains(['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'], platform);\nexports.isIpad = platform === 'iPad';\nexports.isIphone = platform === 'iPhone';\nexports.isMSWindows = contains(['Windows', 'Win16', 'Win32', 'WinCE'], platform);\nexports.isLinux = platform.indexOf('Linux') >= 0;\nfunction contains(arr, el) {\n    return arr.indexOf(el) >= 0;\n}\n//# sourceMappingURL=Platform.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar CharMeasure = (function () {\n    function CharMeasure(document, parentElement) {\n        this._onCharSizeChanged = new EventEmitter2_1.EventEmitter2();\n        this._document = document;\n        this._parentElement = parentElement;\n        this._measureElement = this._document.createElement('span');\n        this._measureElement.classList.add('xterm-char-measure-element');\n        this._measureElement.textContent = 'W';\n        this._measureElement.setAttribute('aria-hidden', 'true');\n        this._parentElement.appendChild(this._measureElement);\n    }\n    Object.defineProperty(CharMeasure.prototype, \"onCharSizeChanged\", {\n        get: function () { return this._onCharSizeChanged.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CharMeasure.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CharMeasure.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CharMeasure.prototype.measure = function (options) {\n        this._measureElement.style.fontFamily = options.fontFamily;\n        this._measureElement.style.fontSize = options.fontSize + \"px\";\n        var geometry = this._measureElement.getBoundingClientRect();\n        if (geometry.width === 0 || geometry.height === 0) {\n            return;\n        }\n        var adjustedHeight = Math.ceil(geometry.height);\n        if (this._width !== geometry.width || this._height !== adjustedHeight) {\n            this._width = geometry.width;\n            this._height = adjustedHeight;\n            this._onCharSizeChanged.fire();\n        }\n    };\n    return CharMeasure;\n}());\nexports.CharMeasure = CharMeasure;\n//# sourceMappingURL=CharMeasure.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GridCache = (function () {\n    function GridCache() {\n        this.cache = [];\n    }\n    GridCache.prototype.resize = function (width, height) {\n        for (var x = 0; x < width; x++) {\n            if (this.cache.length <= x) {\n                this.cache.push([]);\n            }\n            for (var y = this.cache[x].length; y < height; y++) {\n                this.cache[x].push(null);\n            }\n            this.cache[x].length = height;\n        }\n        this.cache.length = width;\n    };\n    GridCache.prototype.clear = function () {\n        for (var x = 0; x < this.cache.length; x++) {\n            for (var y = 0; y < this.cache[x].length; y++) {\n                this.cache[x][y] = null;\n            }\n        }\n    };\n    return GridCache;\n}());\nexports.GridCache = GridCache;\n//# sourceMappingURL=GridCache.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"./Buffer\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar BufferSet = (function () {\n    function BufferSet(_terminal) {\n        this._terminal = _terminal;\n        this._onBufferActivate = new EventEmitter2_1.EventEmitter2();\n        this._normal = new Buffer_1.Buffer(this._terminal, true);\n        this._normal.fillViewportRows();\n        this._alt = new Buffer_1.Buffer(this._terminal, false);\n        this._activeBuffer = this._normal;\n        this.setupTabStops();\n    }\n    Object.defineProperty(BufferSet.prototype, \"onBufferActivate\", {\n        get: function () { return this._onBufferActivate.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BufferSet.prototype, \"alt\", {\n        get: function () {\n            return this._alt;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BufferSet.prototype, \"active\", {\n        get: function () {\n            return this._activeBuffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BufferSet.prototype, \"normal\", {\n        get: function () {\n            return this._normal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BufferSet.prototype.activateNormalBuffer = function () {\n        if (this._activeBuffer === this._normal) {\n            return;\n        }\n        this._normal.x = this._alt.x;\n        this._normal.y = this._alt.y;\n        this._alt.clear();\n        this._activeBuffer = this._normal;\n        this._onBufferActivate.fire({\n            activeBuffer: this._normal,\n            inactiveBuffer: this._alt\n        });\n    };\n    BufferSet.prototype.activateAltBuffer = function (fillAttr) {\n        if (this._activeBuffer === this._alt) {\n            return;\n        }\n        this._alt.fillViewportRows(fillAttr);\n        this._alt.x = this._normal.x;\n        this._alt.y = this._normal.y;\n        this._activeBuffer = this._alt;\n        this._onBufferActivate.fire({\n            activeBuffer: this._alt,\n            inactiveBuffer: this._normal\n        });\n    };\n    BufferSet.prototype.resize = function (newCols, newRows) {\n        this._normal.resize(newCols, newRows);\n        this._alt.resize(newCols, newRows);\n    };\n    BufferSet.prototype.setupTabStops = function (i) {\n        this._normal.setupTabStops(i);\n        this._alt.setupTabStops(i);\n    };\n    return BufferSet;\n}());\nexports.BufferSet = BufferSet;\n//# sourceMappingURL=BufferSet.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BufferLine_1 = require(\"../BufferLine\");\nvar Buffer_1 = require(\"../Buffer\");\nvar JoinedCellData = (function (_super) {\n    __extends(JoinedCellData, _super);\n    function JoinedCellData(firstCell, chars, width) {\n        var _this = _super.call(this) || this;\n        _this.content = 0;\n        _this.combinedData = '';\n        _this.fg = firstCell.fg;\n        _this.bg = firstCell.bg;\n        _this.combinedData = chars;\n        _this._width = width;\n        return _this;\n    }\n    JoinedCellData.prototype.isCombined = function () {\n        return 2097152;\n    };\n    JoinedCellData.prototype.getWidth = function () {\n        return this._width;\n    };\n    JoinedCellData.prototype.getChars = function () {\n        return this.combinedData;\n    };\n    JoinedCellData.prototype.getCode = function () {\n        return 0x1FFFFF;\n    };\n    JoinedCellData.prototype.setFromCharData = function (value) {\n        throw new Error('not implemented');\n    };\n    JoinedCellData.prototype.getAsCharData = function () {\n        return [this.fg, this.getChars(), this.getWidth(), this.getCode()];\n    };\n    return JoinedCellData;\n}(BufferLine_1.AttributeData));\nexports.JoinedCellData = JoinedCellData;\nvar CharacterJoinerRegistry = (function () {\n    function CharacterJoinerRegistry(_terminal) {\n        this._terminal = _terminal;\n        this._characterJoiners = [];\n        this._nextCharacterJoinerId = 0;\n        this._workCell = new BufferLine_1.CellData();\n    }\n    CharacterJoinerRegistry.prototype.registerCharacterJoiner = function (handler) {\n        var joiner = {\n            id: this._nextCharacterJoinerId++,\n            handler: handler\n        };\n        this._characterJoiners.push(joiner);\n        return joiner.id;\n    };\n    CharacterJoinerRegistry.prototype.deregisterCharacterJoiner = function (joinerId) {\n        for (var i = 0; i < this._characterJoiners.length; i++) {\n            if (this._characterJoiners[i].id === joinerId) {\n                this._characterJoiners.splice(i, 1);\n                return true;\n            }\n        }\n        return false;\n    };\n    CharacterJoinerRegistry.prototype.getJoinedCharacters = function (row) {\n        if (this._characterJoiners.length === 0) {\n            return [];\n        }\n        var line = this._terminal.buffer.lines.get(row);\n        if (line.length === 0) {\n            return [];\n        }\n        var ranges = [];\n        var lineStr = line.translateToString(true);\n        var rangeStartColumn = 0;\n        var currentStringIndex = 0;\n        var rangeStartStringIndex = 0;\n        var rangeAttrFG = line.getFg(0);\n        var rangeAttrBG = line.getBg(0);\n        for (var x = 0; x < line.getTrimmedLength(); x++) {\n            line.loadCell(x, this._workCell);\n            if (this._workCell.getWidth() === 0) {\n                continue;\n            }\n            if (this._workCell.fg !== rangeAttrFG || this._workCell.bg !== rangeAttrBG) {\n                if (x - rangeStartColumn > 1) {\n                    var joinedRanges = this._getJoinedRanges(lineStr, rangeStartStringIndex, currentStringIndex, line, rangeStartColumn);\n                    for (var i = 0; i < joinedRanges.length; i++) {\n                        ranges.push(joinedRanges[i]);\n                    }\n                }\n                rangeStartColumn = x;\n                rangeStartStringIndex = currentStringIndex;\n                rangeAttrFG = this._workCell.fg;\n                rangeAttrBG = this._workCell.bg;\n            }\n            currentStringIndex += this._workCell.getChars().length || Buffer_1.WHITESPACE_CELL_CHAR.length;\n        }\n        if (this._terminal.cols - rangeStartColumn > 1) {\n            var joinedRanges = this._getJoinedRanges(lineStr, rangeStartStringIndex, currentStringIndex, line, rangeStartColumn);\n            for (var i = 0; i < joinedRanges.length; i++) {\n                ranges.push(joinedRanges[i]);\n            }\n        }\n        return ranges;\n    };\n    CharacterJoinerRegistry.prototype._getJoinedRanges = function (line, startIndex, endIndex, lineData, startCol) {\n        var text = line.substring(startIndex, endIndex);\n        var joinedRanges = this._characterJoiners[0].handler(text);\n        for (var i = 1; i < this._characterJoiners.length; i++) {\n            var joinerRanges = this._characterJoiners[i].handler(text);\n            for (var j = 0; j < joinerRanges.length; j++) {\n                CharacterJoinerRegistry._mergeRanges(joinedRanges, joinerRanges[j]);\n            }\n        }\n        this._stringRangesToCellRanges(joinedRanges, lineData, startCol);\n        return joinedRanges;\n    };\n    CharacterJoinerRegistry.prototype._stringRangesToCellRanges = function (ranges, line, startCol) {\n        var currentRangeIndex = 0;\n        var currentRangeStarted = false;\n        var currentStringIndex = 0;\n        var currentRange = ranges[currentRangeIndex];\n        if (!currentRange) {\n            return;\n        }\n        for (var x = startCol; x < this._terminal.cols; x++) {\n            var width = line.getWidth(x);\n            var length_1 = line.getString(x).length || Buffer_1.WHITESPACE_CELL_CHAR.length;\n            if (width === 0) {\n                continue;\n            }\n            if (!currentRangeStarted && currentRange[0] <= currentStringIndex) {\n                currentRange[0] = x;\n                currentRangeStarted = true;\n            }\n            if (currentRange[1] <= currentStringIndex) {\n                currentRange[1] = x;\n                currentRange = ranges[++currentRangeIndex];\n                if (!currentRange) {\n                    break;\n                }\n                if (currentRange[0] <= currentStringIndex) {\n                    currentRange[0] = x;\n                    currentRangeStarted = true;\n                }\n                else {\n                    currentRangeStarted = false;\n                }\n            }\n            currentStringIndex += length_1;\n        }\n        if (currentRange) {\n            currentRange[1] = this._terminal.cols;\n        }\n    };\n    CharacterJoinerRegistry._mergeRanges = function (ranges, newRange) {\n        var inRange = false;\n        for (var i = 0; i < ranges.length; i++) {\n            var range = ranges[i];\n            if (!inRange) {\n                if (newRange[1] <= range[0]) {\n                    ranges.splice(i, 0, newRange);\n                    return ranges;\n                }\n                if (newRange[1] <= range[1]) {\n                    range[0] = Math.min(newRange[0], range[0]);\n                    return ranges;\n                }\n                if (newRange[0] < range[1]) {\n                    range[0] = Math.min(newRange[0], range[0]);\n                    inRange = true;\n                }\n                continue;\n            }\n            else {\n                if (newRange[1] <= range[0]) {\n                    ranges[i - 1][1] = newRange[1];\n                    return ranges;\n                }\n                if (newRange[1] <= range[1]) {\n                    ranges[i - 1][1] = Math.max(newRange[1], range[1]);\n                    ranges.splice(i, 1);\n                    inRange = false;\n                    return ranges;\n                }\n                ranges.splice(i, 1);\n                i--;\n            }\n        }\n        if (inRange) {\n            ranges[ranges.length - 1][1] = newRange[1];\n        }\n        else {\n            ranges.push(newRange);\n        }\n        return ranges;\n    };\n    return CharacterJoinerRegistry;\n}());\nexports.CharacterJoinerRegistry = CharacterJoinerRegistry;\n//# sourceMappingURL=CharacterJoinerRegistry.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction clone(val, depth) {\n    if (depth === void 0) { depth = 5; }\n    if (typeof val !== 'object') {\n        return val;\n    }\n    if (val === null) {\n        return null;\n    }\n    var clonedObject = Array.isArray(val) ? [] : {};\n    for (var key in val) {\n        clonedObject[key] = depth <= 1 ? val[key] : clone(val[key], depth - 1);\n    }\n    return clonedObject;\n}\nexports.clone = clone;\n//# sourceMappingURL=Clone.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter2 = (function () {\n    function EventEmitter2() {\n        this._listeners = [];\n    }\n    Object.defineProperty(EventEmitter2.prototype, \"event\", {\n        get: function () {\n            var _this = this;\n            if (!this._event) {\n                this._event = function (listener) {\n                    _this._listeners.push(listener);\n                    var disposable = {\n                        dispose: function () {\n                            for (var i = 0; i < _this._listeners.length; i++) {\n                                if (_this._listeners[i] === listener) {\n                                    _this._listeners.splice(i, 1);\n                                    return;\n                                }\n                            }\n                        }\n                    };\n                    return disposable;\n                };\n            }\n            return this._event;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    EventEmitter2.prototype.fire = function (data) {\n        var queue = [];\n        for (var i = 0; i < this._listeners.length; i++) {\n            queue.push(this._listeners[i]);\n        }\n        for (var i = 0; i < queue.length; i++) {\n            queue[i].call(undefined, data);\n        }\n    };\n    return EventEmitter2;\n}());\nexports.EventEmitter2 = EventEmitter2;\n//# sourceMappingURL=EventEmitter2.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction reflowLargerGetLinesToRemove(lines, oldCols, newCols, bufferAbsoluteY, nullCell) {\n    var toRemove = [];\n    for (var y = 0; y < lines.length - 1; y++) {\n        var i = y;\n        var nextLine = lines.get(++i);\n        if (!nextLine.isWrapped) {\n            continue;\n        }\n        var wrappedLines = [lines.get(y)];\n        while (i < lines.length && nextLine.isWrapped) {\n            wrappedLines.push(nextLine);\n            nextLine = lines.get(++i);\n        }\n        if (bufferAbsoluteY >= y && bufferAbsoluteY < i) {\n            y += wrappedLines.length - 1;\n            continue;\n        }\n        var destLineIndex = 0;\n        var destCol = getWrappedLineTrimmedLength(wrappedLines, destLineIndex, oldCols);\n        var srcLineIndex = 1;\n        var srcCol = 0;\n        while (srcLineIndex < wrappedLines.length) {\n            var srcTrimmedTineLength = getWrappedLineTrimmedLength(wrappedLines, srcLineIndex, oldCols);\n            var srcRemainingCells = srcTrimmedTineLength - srcCol;\n            var destRemainingCells = newCols - destCol;\n            var cellsToCopy = Math.min(srcRemainingCells, destRemainingCells);\n            wrappedLines[destLineIndex].copyCellsFrom(wrappedLines[srcLineIndex], srcCol, destCol, cellsToCopy, false);\n            destCol += cellsToCopy;\n            if (destCol === newCols) {\n                destLineIndex++;\n                destCol = 0;\n            }\n            srcCol += cellsToCopy;\n            if (srcCol === srcTrimmedTineLength) {\n                srcLineIndex++;\n                srcCol = 0;\n            }\n            if (destCol === 0 && destLineIndex !== 0) {\n                if (wrappedLines[destLineIndex - 1].getWidth(newCols - 1) === 2) {\n                    wrappedLines[destLineIndex].copyCellsFrom(wrappedLines[destLineIndex - 1], newCols - 1, destCol++, 1, false);\n                    wrappedLines[destLineIndex - 1].setCell(newCols - 1, nullCell);\n                }\n            }\n        }\n        wrappedLines[destLineIndex].replaceCells(destCol, newCols, nullCell);\n        var countToRemove = 0;\n        for (var i_1 = wrappedLines.length - 1; i_1 > 0; i_1--) {\n            if (i_1 > destLineIndex || wrappedLines[i_1].getTrimmedLength() === 0) {\n                countToRemove++;\n            }\n            else {\n                break;\n            }\n        }\n        if (countToRemove > 0) {\n            toRemove.push(y + wrappedLines.length - countToRemove);\n            toRemove.push(countToRemove);\n        }\n        y += wrappedLines.length - 1;\n    }\n    return toRemove;\n}\nexports.reflowLargerGetLinesToRemove = reflowLargerGetLinesToRemove;\nfunction reflowLargerCreateNewLayout(lines, toRemove) {\n    var layout = [];\n    var nextToRemoveIndex = 0;\n    var nextToRemoveStart = toRemove[nextToRemoveIndex];\n    var countRemovedSoFar = 0;\n    for (var i = 0; i < lines.length; i++) {\n        if (nextToRemoveStart === i) {\n            var countToRemove = toRemove[++nextToRemoveIndex];\n            lines.onDeleteEmitter.fire({\n                index: i - countRemovedSoFar,\n                amount: countToRemove\n            });\n            i += countToRemove - 1;\n            countRemovedSoFar += countToRemove;\n            nextToRemoveStart = toRemove[++nextToRemoveIndex];\n        }\n        else {\n            layout.push(i);\n        }\n    }\n    return {\n        layout: layout,\n        countRemoved: countRemovedSoFar\n    };\n}\nexports.reflowLargerCreateNewLayout = reflowLargerCreateNewLayout;\nfunction reflowLargerApplyNewLayout(lines, newLayout) {\n    var newLayoutLines = [];\n    for (var i = 0; i < newLayout.length; i++) {\n        newLayoutLines.push(lines.get(newLayout[i]));\n    }\n    for (var i = 0; i < newLayoutLines.length; i++) {\n        lines.set(i, newLayoutLines[i]);\n    }\n    lines.length = newLayout.length;\n}\nexports.reflowLargerApplyNewLayout = reflowLargerApplyNewLayout;\nfunction reflowSmallerGetNewLineLengths(wrappedLines, oldCols, newCols) {\n    var newLineLengths = [];\n    var cellsNeeded = wrappedLines.map(function (l, i) { return getWrappedLineTrimmedLength(wrappedLines, i, oldCols); }).reduce(function (p, c) { return p + c; });\n    var srcCol = 0;\n    var srcLine = 0;\n    var cellsAvailable = 0;\n    while (cellsAvailable < cellsNeeded) {\n        if (cellsNeeded - cellsAvailable < newCols) {\n            newLineLengths.push(cellsNeeded - cellsAvailable);\n            break;\n        }\n        srcCol += newCols;\n        var oldTrimmedLength = getWrappedLineTrimmedLength(wrappedLines, srcLine, oldCols);\n        if (srcCol > oldTrimmedLength) {\n            srcCol -= oldTrimmedLength;\n            srcLine++;\n        }\n        var endsWithWide = wrappedLines[srcLine].getWidth(srcCol - 1) === 2;\n        if (endsWithWide) {\n            srcCol--;\n        }\n        var lineLength = endsWithWide ? newCols - 1 : newCols;\n        newLineLengths.push(lineLength);\n        cellsAvailable += lineLength;\n    }\n    return newLineLengths;\n}\nexports.reflowSmallerGetNewLineLengths = reflowSmallerGetNewLineLengths;\nfunction getWrappedLineTrimmedLength(lines, i, cols) {\n    if (i === lines.length - 1) {\n        return lines[i].getTrimmedLength();\n    }\n    var endsInNull = !(lines[i].hasContent(cols - 1)) && lines[i].getWidth(cols - 1) === 1;\n    var followingLineStartsWithWide = lines[i + 1].getWidth(0) === 2;\n    if (endsInNull && followingLineStartsWithWide) {\n        return cols - 1;\n    }\n    return cols;\n}\nexports.getWrappedLineTrimmedLength = getWrappedLineTrimmedLength;\n//# sourceMappingURL=BufferReflow.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"../../Buffer\");\nvar Types_1 = require(\"../atlas/Types\");\nvar BufferLine_1 = require(\"../../BufferLine\");\nexports.BOLD_CLASS = 'xterm-bold';\nexports.DIM_CLASS = 'xterm-dim';\nexports.ITALIC_CLASS = 'xterm-italic';\nexports.UNDERLINE_CLASS = 'xterm-underline';\nexports.CURSOR_CLASS = 'xterm-cursor';\nexports.CURSOR_BLINK_CLASS = 'xterm-cursor-blink';\nexports.CURSOR_STYLE_BLOCK_CLASS = 'xterm-cursor-block';\nexports.CURSOR_STYLE_BAR_CLASS = 'xterm-cursor-bar';\nexports.CURSOR_STYLE_UNDERLINE_CLASS = 'xterm-cursor-underline';\nvar DomRendererRowFactory = (function () {\n    function DomRendererRowFactory(_terminalOptions, _document) {\n        this._terminalOptions = _terminalOptions;\n        this._document = _document;\n        this._workCell = new BufferLine_1.CellData();\n    }\n    DomRendererRowFactory.prototype.createRow = function (lineData, isCursorRow, cursorStyle, cursorX, cursorBlink, cellWidth, cols) {\n        var fragment = this._document.createDocumentFragment();\n        var lineLength = 0;\n        for (var x = Math.min(lineData.length, cols) - 1; x >= 0; x--) {\n            if (lineData.loadCell(x, this._workCell).getCode() !== Buffer_1.NULL_CELL_CODE || (isCursorRow && x === cursorX)) {\n                lineLength = x + 1;\n                break;\n            }\n        }\n        for (var x = 0; x < lineLength; x++) {\n            lineData.loadCell(x, this._workCell);\n            var width = this._workCell.getWidth();\n            if (width === 0) {\n                continue;\n            }\n            var charElement = this._document.createElement('span');\n            if (width > 1) {\n                charElement.style.width = cellWidth * width + \"px\";\n            }\n            if (isCursorRow && x === cursorX) {\n                charElement.classList.add(exports.CURSOR_CLASS);\n                if (cursorBlink) {\n                    charElement.classList.add(exports.CURSOR_BLINK_CLASS);\n                }\n                switch (cursorStyle) {\n                    case 'bar':\n                        charElement.classList.add(exports.CURSOR_STYLE_BAR_CLASS);\n                        break;\n                    case 'underline':\n                        charElement.classList.add(exports.CURSOR_STYLE_UNDERLINE_CLASS);\n                        break;\n                    default:\n                        charElement.classList.add(exports.CURSOR_STYLE_BLOCK_CLASS);\n                        break;\n                }\n            }\n            if (this._workCell.isBold() && this._terminalOptions.enableBold) {\n                charElement.classList.add(exports.BOLD_CLASS);\n            }\n            if (this._workCell.isItalic()) {\n                charElement.classList.add(exports.ITALIC_CLASS);\n            }\n            if (this._workCell.isDim()) {\n                charElement.classList.add(exports.DIM_CLASS);\n            }\n            if (this._workCell.isUnderline()) {\n                charElement.classList.add(exports.UNDERLINE_CLASS);\n            }\n            charElement.textContent = this._workCell.getChars() || Buffer_1.WHITESPACE_CELL_CHAR;\n            var swapColor = this._workCell.isInverse();\n            if (this._workCell.isFgRGB()) {\n                var style = charElement.getAttribute('style') || '';\n                style += (swapColor ? 'background-' : '') + \"color:rgb(\" + (BufferLine_1.AttributeData.toColorRGB(this._workCell.getFgColor())).join(',') + \");\";\n                charElement.setAttribute('style', style);\n            }\n            else if (this._workCell.isFgPalette()) {\n                var fg = this._workCell.getFgColor();\n                if (this._workCell.isBold() && fg < 8 && !swapColor &&\n                    this._terminalOptions.enableBold && this._terminalOptions.drawBoldTextInBrightColors) {\n                    fg += 8;\n                }\n                charElement.classList.add(\"xterm-\" + (swapColor ? 'b' : 'f') + \"g-\" + fg);\n            }\n            else if (swapColor) {\n                charElement.classList.add(\"xterm-bg-\" + Types_1.INVERTED_DEFAULT_COLOR);\n            }\n            if (this._workCell.isBgRGB()) {\n                var style = charElement.getAttribute('style') || '';\n                style += (swapColor ? '' : 'background-') + \"color:rgb(\" + (BufferLine_1.AttributeData.toColorRGB(this._workCell.getBgColor())).join(',') + \");\";\n                charElement.setAttribute('style', style);\n            }\n            else if (this._workCell.isBgPalette()) {\n                charElement.classList.add(\"xterm-\" + (swapColor ? 'f' : 'b') + \"g-\" + this._workCell.getBgColor());\n            }\n            else if (swapColor) {\n                charElement.classList.add(\"xterm-fg-\" + Types_1.INVERTED_DEFAULT_COLOR);\n            }\n            fragment.appendChild(charElement);\n        }\n        return fragment;\n    };\n    return DomRendererRowFactory;\n}());\nexports.DomRendererRowFactory = DomRendererRowFactory;\n//# sourceMappingURL=DomRendererRowFactory.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Types_1 = require(\"./atlas/Types\");\nvar CharAtlasCache_1 = require(\"./atlas/CharAtlasCache\");\nvar BufferLine_1 = require(\"../BufferLine\");\nvar Buffer_1 = require(\"../Buffer\");\nvar CharacterJoinerRegistry_1 = require(\"./CharacterJoinerRegistry\");\nvar BaseRenderLayer = (function () {\n    function BaseRenderLayer(_container, id, zIndex, _alpha, _colors) {\n        this._container = _container;\n        this._alpha = _alpha;\n        this._colors = _colors;\n        this._scaledCharWidth = 0;\n        this._scaledCharHeight = 0;\n        this._scaledCellWidth = 0;\n        this._scaledCellHeight = 0;\n        this._scaledCharLeft = 0;\n        this._scaledCharTop = 0;\n        this._currentGlyphIdentifier = {\n            chars: '',\n            code: 0,\n            bg: 0,\n            fg: 0,\n            bold: false,\n            dim: false,\n            italic: false\n        };\n        this._canvas = document.createElement('canvas');\n        this._canvas.classList.add(\"xterm-\" + id + \"-layer\");\n        this._canvas.style.zIndex = zIndex.toString();\n        this._initCanvas();\n        this._container.appendChild(this._canvas);\n    }\n    BaseRenderLayer.prototype.dispose = function () {\n        this._container.removeChild(this._canvas);\n        if (this._charAtlas) {\n            this._charAtlas.dispose();\n        }\n    };\n    BaseRenderLayer.prototype._initCanvas = function () {\n        this._ctx = this._canvas.getContext('2d', { alpha: this._alpha });\n        if (!this._alpha) {\n            this.clearAll();\n        }\n    };\n    BaseRenderLayer.prototype.onOptionsChanged = function (terminal) { };\n    BaseRenderLayer.prototype.onBlur = function (terminal) { };\n    BaseRenderLayer.prototype.onFocus = function (terminal) { };\n    BaseRenderLayer.prototype.onCursorMove = function (terminal) { };\n    BaseRenderLayer.prototype.onGridChanged = function (terminal, startRow, endRow) { };\n    BaseRenderLayer.prototype.onSelectionChanged = function (terminal, start, end, columnSelectMode) {\n        if (columnSelectMode === void 0) { columnSelectMode = false; }\n    };\n    BaseRenderLayer.prototype.onThemeChanged = function (terminal, colorSet) {\n        this._refreshCharAtlas(terminal, colorSet);\n    };\n    BaseRenderLayer.prototype.setTransparency = function (terminal, alpha) {\n        if (alpha === this._alpha) {\n            return;\n        }\n        var oldCanvas = this._canvas;\n        this._alpha = alpha;\n        this._canvas = this._canvas.cloneNode();\n        this._initCanvas();\n        this._container.replaceChild(this._canvas, oldCanvas);\n        this._refreshCharAtlas(terminal, this._colors);\n        this.onGridChanged(terminal, 0, terminal.rows - 1);\n    };\n    BaseRenderLayer.prototype._refreshCharAtlas = function (terminal, colorSet) {\n        if (this._scaledCharWidth <= 0 && this._scaledCharHeight <= 0) {\n            return;\n        }\n        this._charAtlas = CharAtlasCache_1.acquireCharAtlas(terminal, colorSet, this._scaledCharWidth, this._scaledCharHeight);\n        this._charAtlas.warmUp();\n    };\n    BaseRenderLayer.prototype.resize = function (terminal, dim) {\n        this._scaledCellWidth = dim.scaledCellWidth;\n        this._scaledCellHeight = dim.scaledCellHeight;\n        this._scaledCharWidth = dim.scaledCharWidth;\n        this._scaledCharHeight = dim.scaledCharHeight;\n        this._scaledCharLeft = dim.scaledCharLeft;\n        this._scaledCharTop = dim.scaledCharTop;\n        this._canvas.width = dim.scaledCanvasWidth;\n        this._canvas.height = dim.scaledCanvasHeight;\n        this._canvas.style.width = dim.canvasWidth + \"px\";\n        this._canvas.style.height = dim.canvasHeight + \"px\";\n        if (!this._alpha) {\n            this.clearAll();\n        }\n        this._refreshCharAtlas(terminal, this._colors);\n    };\n    BaseRenderLayer.prototype.fillCells = function (x, y, width, height) {\n        this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n    };\n    BaseRenderLayer.prototype.fillBottomLineAtCells = function (x, y, width) {\n        if (width === void 0) { width = 1; }\n        this._ctx.fillRect(x * this._scaledCellWidth, (y + 1) * this._scaledCellHeight - window.devicePixelRatio - 1, width * this._scaledCellWidth, window.devicePixelRatio);\n    };\n    BaseRenderLayer.prototype.fillLeftLineAtCell = function (x, y) {\n        this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, window.devicePixelRatio, this._scaledCellHeight);\n    };\n    BaseRenderLayer.prototype.strokeRectAtCell = function (x, y, width, height) {\n        this._ctx.lineWidth = window.devicePixelRatio;\n        this._ctx.strokeRect(x * this._scaledCellWidth + window.devicePixelRatio / 2, y * this._scaledCellHeight + (window.devicePixelRatio / 2), width * this._scaledCellWidth - window.devicePixelRatio, (height * this._scaledCellHeight) - window.devicePixelRatio);\n    };\n    BaseRenderLayer.prototype.clearAll = function () {\n        if (this._alpha) {\n            this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n        }\n        else {\n            this._ctx.fillStyle = this._colors.background.css;\n            this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n        }\n    };\n    BaseRenderLayer.prototype.clearCells = function (x, y, width, height) {\n        if (this._alpha) {\n            this._ctx.clearRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n        }\n        else {\n            this._ctx.fillStyle = this._colors.background.css;\n            this._ctx.fillRect(x * this._scaledCellWidth, y * this._scaledCellHeight, width * this._scaledCellWidth, height * this._scaledCellHeight);\n        }\n    };\n    BaseRenderLayer.prototype.fillCharTrueColor = function (terminal, cell, x, y) {\n        this._ctx.font = this._getFont(terminal, false, false);\n        this._ctx.textBaseline = 'middle';\n        this._clipRow(terminal, y);\n        this._ctx.fillText(cell.getChars(), x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop + this._scaledCharHeight / 2);\n    };\n    BaseRenderLayer.prototype.drawChars = function (terminal, cell, x, y) {\n        if (cell.isFgRGB() || cell.isBgRGB() || cell instanceof CharacterJoinerRegistry_1.JoinedCellData) {\n            this._drawUncachedChars(terminal, cell, x, y);\n            return;\n        }\n        var fg;\n        var bg;\n        if (cell.isInverse()) {\n            fg = (cell.isBgDefault()) ? Types_1.INVERTED_DEFAULT_COLOR : cell.getBgColor();\n            bg = (cell.isFgDefault()) ? Types_1.INVERTED_DEFAULT_COLOR : cell.getFgColor();\n        }\n        else {\n            bg = (cell.isBgDefault()) ? Types_1.DEFAULT_COLOR : cell.getBgColor();\n            fg = (cell.isFgDefault()) ? Types_1.DEFAULT_COLOR : cell.getFgColor();\n        }\n        var drawInBrightColor = terminal.options.drawBoldTextInBrightColors && cell.isBold() && fg < 8 && fg !== Types_1.INVERTED_DEFAULT_COLOR;\n        fg += drawInBrightColor ? 8 : 0;\n        this._currentGlyphIdentifier.chars = cell.getChars() || Buffer_1.WHITESPACE_CELL_CHAR;\n        this._currentGlyphIdentifier.code = cell.getCode() || Buffer_1.WHITESPACE_CELL_CODE;\n        this._currentGlyphIdentifier.bg = bg;\n        this._currentGlyphIdentifier.fg = fg;\n        this._currentGlyphIdentifier.bold = cell.isBold() && terminal.options.enableBold;\n        this._currentGlyphIdentifier.dim = !!cell.isDim();\n        this._currentGlyphIdentifier.italic = !!cell.isItalic();\n        var atlasDidDraw = this._charAtlas && this._charAtlas.draw(this._ctx, this._currentGlyphIdentifier, x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop);\n        if (!atlasDidDraw) {\n            this._drawUncachedChars(terminal, cell, x, y);\n        }\n    };\n    BaseRenderLayer.prototype._drawUncachedChars = function (terminal, cell, x, y) {\n        this._ctx.save();\n        this._ctx.font = this._getFont(terminal, cell.isBold() && terminal.options.enableBold, !!cell.isItalic());\n        this._ctx.textBaseline = 'middle';\n        if (cell.isInverse()) {\n            if (cell.isBgDefault()) {\n                this._ctx.fillStyle = this._colors.background.css;\n            }\n            else if (cell.isBgRGB()) {\n                this._ctx.fillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getBgColor()).join(',') + \")\";\n            }\n            else {\n                this._ctx.fillStyle = this._colors.ansi[cell.getBgColor()].css;\n            }\n        }\n        else {\n            if (cell.isFgDefault()) {\n                this._ctx.fillStyle = this._colors.foreground.css;\n            }\n            else if (cell.isFgRGB()) {\n                this._ctx.fillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getFgColor()).join(',') + \")\";\n            }\n            else {\n                var fg = cell.getFgColor();\n                if (terminal.options.drawBoldTextInBrightColors && cell.isBold() && fg < 8) {\n                    fg += 8;\n                }\n                this._ctx.fillStyle = this._colors.ansi[fg].css;\n            }\n        }\n        this._clipRow(terminal, y);\n        if (cell.isDim()) {\n            this._ctx.globalAlpha = Types_1.DIM_OPACITY;\n        }\n        this._ctx.fillText(cell.getChars(), x * this._scaledCellWidth + this._scaledCharLeft, y * this._scaledCellHeight + this._scaledCharTop + this._scaledCharHeight / 2);\n        this._ctx.restore();\n    };\n    BaseRenderLayer.prototype._clipRow = function (terminal, y) {\n        this._ctx.beginPath();\n        this._ctx.rect(0, y * this._scaledCellHeight, terminal.cols * this._scaledCellWidth, this._scaledCellHeight);\n        this._ctx.clip();\n    };\n    BaseRenderLayer.prototype._getFont = function (terminal, isBold, isItalic) {\n        var fontWeight = isBold ? terminal.options.fontWeightBold : terminal.options.fontWeight;\n        var fontStyle = isItalic ? 'italic' : '';\n        return fontStyle + \" \" + fontWeight + \" \" + terminal.options.fontSize * window.devicePixelRatio + \"px \" + terminal.options.fontFamily;\n    };\n    return BaseRenderLayer;\n}());\nexports.BaseRenderLayer = BaseRenderLayer;\n//# sourceMappingURL=BaseRenderLayer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"./Buffer\");\nvar TextDecoder_1 = require(\"./core/input/TextDecoder\");\nvar CELL_SIZE = 3;\nvar AttributeData = (function () {\n    function AttributeData() {\n        this.fg = 0;\n        this.bg = 0;\n    }\n    AttributeData.toColorRGB = function (value) {\n        return [\n            value >>> 16 & 255,\n            value >>> 8 & 255,\n            value & 255\n        ];\n    };\n    AttributeData.fromColorRGB = function (value) {\n        return (value[0] & 255) << 16 | (value[1] & 255) << 8 | value[2] & 255;\n    };\n    AttributeData.prototype.clone = function () {\n        var newObj = new AttributeData();\n        newObj.fg = this.fg;\n        newObj.bg = this.bg;\n        return newObj;\n    };\n    AttributeData.prototype.isInverse = function () { return this.fg & 67108864; };\n    AttributeData.prototype.isBold = function () { return this.fg & 134217728; };\n    AttributeData.prototype.isUnderline = function () { return this.fg & 268435456; };\n    AttributeData.prototype.isBlink = function () { return this.fg & 536870912; };\n    AttributeData.prototype.isInvisible = function () { return this.fg & 1073741824; };\n    AttributeData.prototype.isItalic = function () { return this.bg & 67108864; };\n    AttributeData.prototype.isDim = function () { return this.bg & 134217728; };\n    AttributeData.prototype.getFgColorMode = function () { return this.fg & 50331648; };\n    AttributeData.prototype.getBgColorMode = function () { return this.bg & 50331648; };\n    AttributeData.prototype.isFgRGB = function () { return (this.fg & 50331648) === 50331648; };\n    AttributeData.prototype.isBgRGB = function () { return (this.bg & 50331648) === 50331648; };\n    AttributeData.prototype.isFgPalette = function () { return (this.fg & 50331648) === 16777216 || (this.fg & 50331648) === 33554432; };\n    AttributeData.prototype.isBgPalette = function () { return (this.bg & 50331648) === 16777216 || (this.bg & 50331648) === 33554432; };\n    AttributeData.prototype.isFgDefault = function () { return (this.fg & 50331648) === 0; };\n    AttributeData.prototype.isBgDefault = function () { return (this.bg & 50331648) === 0; };\n    AttributeData.prototype.getFgColor = function () {\n        switch (this.fg & 50331648) {\n            case 16777216:\n            case 33554432: return this.fg & 255;\n            case 50331648: return this.fg & 16777215;\n            default: return -1;\n        }\n    };\n    AttributeData.prototype.getBgColor = function () {\n        switch (this.bg & 50331648) {\n            case 16777216:\n            case 33554432: return this.bg & 255;\n            case 50331648: return this.bg & 16777215;\n            default: return -1;\n        }\n    };\n    return AttributeData;\n}());\nexports.AttributeData = AttributeData;\nvar CellData = (function (_super) {\n    __extends(CellData, _super);\n    function CellData() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.content = 0;\n        _this.fg = 0;\n        _this.bg = 0;\n        _this.combinedData = '';\n        return _this;\n    }\n    CellData.fromCharData = function (value) {\n        var obj = new CellData();\n        obj.setFromCharData(value);\n        return obj;\n    };\n    CellData.prototype.isCombined = function () {\n        return this.content & 2097152;\n    };\n    CellData.prototype.getWidth = function () {\n        return this.content >> 22;\n    };\n    CellData.prototype.getChars = function () {\n        if (this.content & 2097152) {\n            return this.combinedData;\n        }\n        if (this.content & 2097151) {\n            return TextDecoder_1.stringFromCodePoint(this.content & 2097151);\n        }\n        return '';\n    };\n    CellData.prototype.getCode = function () {\n        return (this.isCombined())\n            ? this.combinedData.charCodeAt(this.combinedData.length - 1)\n            : this.content & 2097151;\n    };\n    CellData.prototype.setFromCharData = function (value) {\n        this.fg = value[Buffer_1.CHAR_DATA_ATTR_INDEX];\n        this.bg = 0;\n        var combined = false;\n        if (value[Buffer_1.CHAR_DATA_CHAR_INDEX].length > 2) {\n            combined = true;\n        }\n        else if (value[Buffer_1.CHAR_DATA_CHAR_INDEX].length === 2) {\n            var code = value[Buffer_1.CHAR_DATA_CHAR_INDEX].charCodeAt(0);\n            if (0xD800 <= code && code <= 0xDBFF) {\n                var second = value[Buffer_1.CHAR_DATA_CHAR_INDEX].charCodeAt(1);\n                if (0xDC00 <= second && second <= 0xDFFF) {\n                    this.content = ((code - 0xD800) * 0x400 + second - 0xDC00 + 0x10000) | (value[Buffer_1.CHAR_DATA_WIDTH_INDEX] << 22);\n                }\n                else {\n                    combined = true;\n                }\n            }\n            else {\n                combined = true;\n            }\n        }\n        else {\n            this.content = value[Buffer_1.CHAR_DATA_CHAR_INDEX].charCodeAt(0) | (value[Buffer_1.CHAR_DATA_WIDTH_INDEX] << 22);\n        }\n        if (combined) {\n            this.combinedData = value[Buffer_1.CHAR_DATA_CHAR_INDEX];\n            this.content = 2097152 | (value[Buffer_1.CHAR_DATA_WIDTH_INDEX] << 22);\n        }\n    };\n    CellData.prototype.getAsCharData = function () {\n        return [this.fg, this.getChars(), this.getWidth(), this.getCode()];\n    };\n    return CellData;\n}(AttributeData));\nexports.CellData = CellData;\nvar BufferLine = (function () {\n    function BufferLine(cols, fillCellData, isWrapped) {\n        if (isWrapped === void 0) { isWrapped = false; }\n        this.isWrapped = isWrapped;\n        this._data = null;\n        this._combined = {};\n        if (cols) {\n            this._data = new Uint32Array(cols * CELL_SIZE);\n            var cell = fillCellData || CellData.fromCharData([0, Buffer_1.NULL_CELL_CHAR, Buffer_1.NULL_CELL_WIDTH, Buffer_1.NULL_CELL_CODE]);\n            for (var i = 0; i < cols; ++i) {\n                this.setCell(i, cell);\n            }\n        }\n        this.length = cols;\n    }\n    BufferLine.prototype.get = function (index) {\n        var content = this._data[index * CELL_SIZE + 0];\n        var cp = content & 2097151;\n        return [\n            this._data[index * CELL_SIZE + 1],\n            (content & 2097152)\n                ? this._combined[index]\n                : (cp) ? TextDecoder_1.stringFromCodePoint(cp) : '',\n            content >> 22,\n            (content & 2097152)\n                ? this._combined[index].charCodeAt(this._combined[index].length - 1)\n                : cp\n        ];\n    };\n    BufferLine.prototype.set = function (index, value) {\n        this._data[index * CELL_SIZE + 1] = value[Buffer_1.CHAR_DATA_ATTR_INDEX];\n        if (value[Buffer_1.CHAR_DATA_CHAR_INDEX].length > 1) {\n            this._combined[index] = value[1];\n            this._data[index * CELL_SIZE + 0] = index | 2097152 | (value[Buffer_1.CHAR_DATA_WIDTH_INDEX] << 22);\n        }\n        else {\n            this._data[index * CELL_SIZE + 0] = value[Buffer_1.CHAR_DATA_CHAR_INDEX].charCodeAt(0) | (value[Buffer_1.CHAR_DATA_WIDTH_INDEX] << 22);\n        }\n    };\n    BufferLine.prototype.getWidth = function (index) {\n        return this._data[index * CELL_SIZE + 0] >> 22;\n    };\n    BufferLine.prototype.hasWidth = function (index) {\n        return this._data[index * CELL_SIZE + 0] & 12582912;\n    };\n    BufferLine.prototype.getFg = function (index) {\n        return this._data[index * CELL_SIZE + 1];\n    };\n    BufferLine.prototype.getBg = function (index) {\n        return this._data[index * CELL_SIZE + 2];\n    };\n    BufferLine.prototype.hasContent = function (index) {\n        return this._data[index * CELL_SIZE + 0] & 4194303;\n    };\n    BufferLine.prototype.getCodePoint = function (index) {\n        var content = this._data[index * CELL_SIZE + 0];\n        if (content & 2097152) {\n            return this._combined[index].charCodeAt(this._combined[index].length - 1);\n        }\n        return content & 2097151;\n    };\n    BufferLine.prototype.isCombined = function (index) {\n        return this._data[index * CELL_SIZE + 0] & 2097152;\n    };\n    BufferLine.prototype.getString = function (index) {\n        var content = this._data[index * CELL_SIZE + 0];\n        if (content & 2097152) {\n            return this._combined[index];\n        }\n        if (content & 2097151) {\n            return TextDecoder_1.stringFromCodePoint(content & 2097151);\n        }\n        return '';\n    };\n    BufferLine.prototype.loadCell = function (index, cell) {\n        var startIndex = index * CELL_SIZE;\n        cell.content = this._data[startIndex + 0];\n        cell.fg = this._data[startIndex + 1];\n        cell.bg = this._data[startIndex + 2];\n        if (cell.content & 2097152) {\n            cell.combinedData = this._combined[index];\n        }\n        return cell;\n    };\n    BufferLine.prototype.setCell = function (index, cell) {\n        if (cell.content & 2097152) {\n            this._combined[index] = cell.combinedData;\n        }\n        this._data[index * CELL_SIZE + 0] = cell.content;\n        this._data[index * CELL_SIZE + 1] = cell.fg;\n        this._data[index * CELL_SIZE + 2] = cell.bg;\n    };\n    BufferLine.prototype.setCellFromCodePoint = function (index, codePoint, width, fg, bg) {\n        this._data[index * CELL_SIZE + 0] = codePoint | (width << 22);\n        this._data[index * CELL_SIZE + 1] = fg;\n        this._data[index * CELL_SIZE + 2] = bg;\n    };\n    BufferLine.prototype.addCodepointToCell = function (index, codePoint) {\n        var content = this._data[index * CELL_SIZE + 0];\n        if (content & 2097152) {\n            this._combined[index] += TextDecoder_1.stringFromCodePoint(codePoint);\n        }\n        else {\n            if (content & 2097151) {\n                this._combined[index] = TextDecoder_1.stringFromCodePoint(content & 2097151) + TextDecoder_1.stringFromCodePoint(codePoint);\n                content &= ~2097151;\n                content |= 2097152;\n            }\n            else {\n                content = codePoint | (1 << 22);\n            }\n            this._data[index * CELL_SIZE + 0] = content;\n        }\n    };\n    BufferLine.prototype.insertCells = function (pos, n, fillCellData) {\n        pos %= this.length;\n        if (n < this.length - pos) {\n            var cell = new CellData();\n            for (var i = this.length - pos - n - 1; i >= 0; --i) {\n                this.setCell(pos + n + i, this.loadCell(pos + i, cell));\n            }\n            for (var i = 0; i < n; ++i) {\n                this.setCell(pos + i, fillCellData);\n            }\n        }\n        else {\n            for (var i = pos; i < this.length; ++i) {\n                this.setCell(i, fillCellData);\n            }\n        }\n    };\n    BufferLine.prototype.deleteCells = function (pos, n, fillCellData) {\n        pos %= this.length;\n        if (n < this.length - pos) {\n            var cell = new CellData();\n            for (var i = 0; i < this.length - pos - n; ++i) {\n                this.setCell(pos + i, this.loadCell(pos + n + i, cell));\n            }\n            for (var i = this.length - n; i < this.length; ++i) {\n                this.setCell(i, fillCellData);\n            }\n        }\n        else {\n            for (var i = pos; i < this.length; ++i) {\n                this.setCell(i, fillCellData);\n            }\n        }\n    };\n    BufferLine.prototype.replaceCells = function (start, end, fillCellData) {\n        while (start < end && start < this.length) {\n            this.setCell(start++, fillCellData);\n        }\n    };\n    BufferLine.prototype.resize = function (cols, fillCellData) {\n        if (cols === this.length) {\n            return;\n        }\n        if (cols > this.length) {\n            var data = new Uint32Array(cols * CELL_SIZE);\n            if (this.length) {\n                if (cols * CELL_SIZE < this._data.length) {\n                    data.set(this._data.subarray(0, cols * CELL_SIZE));\n                }\n                else {\n                    data.set(this._data);\n                }\n            }\n            this._data = data;\n            for (var i = this.length; i < cols; ++i) {\n                this.setCell(i, fillCellData);\n            }\n        }\n        else {\n            if (cols) {\n                var data = new Uint32Array(cols * CELL_SIZE);\n                data.set(this._data.subarray(0, cols * CELL_SIZE));\n                this._data = data;\n                var keys = Object.keys(this._combined);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = parseInt(keys[i], 10);\n                    if (key >= cols) {\n                        delete this._combined[key];\n                    }\n                }\n            }\n            else {\n                this._data = null;\n                this._combined = {};\n            }\n        }\n        this.length = cols;\n    };\n    BufferLine.prototype.fill = function (fillCellData) {\n        this._combined = {};\n        for (var i = 0; i < this.length; ++i) {\n            this.setCell(i, fillCellData);\n        }\n    };\n    BufferLine.prototype.copyFrom = function (line) {\n        if (this.length !== line.length) {\n            this._data = new Uint32Array(line._data);\n        }\n        else {\n            this._data.set(line._data);\n        }\n        this.length = line.length;\n        this._combined = {};\n        for (var el in line._combined) {\n            this._combined[el] = line._combined[el];\n        }\n        this.isWrapped = line.isWrapped;\n    };\n    BufferLine.prototype.clone = function () {\n        var newLine = new BufferLine(0);\n        newLine._data = new Uint32Array(this._data);\n        newLine.length = this.length;\n        for (var el in this._combined) {\n            newLine._combined[el] = this._combined[el];\n        }\n        newLine.isWrapped = this.isWrapped;\n        return newLine;\n    };\n    BufferLine.prototype.getTrimmedLength = function () {\n        for (var i = this.length - 1; i >= 0; --i) {\n            if ((this._data[i * CELL_SIZE + 0] & 4194303)) {\n                return i + (this._data[i * CELL_SIZE + 0] >> 22);\n            }\n        }\n        return 0;\n    };\n    BufferLine.prototype.copyCellsFrom = function (src, srcCol, destCol, length, applyInReverse) {\n        var srcData = src._data;\n        if (applyInReverse) {\n            for (var cell = length - 1; cell >= 0; cell--) {\n                for (var i = 0; i < CELL_SIZE; i++) {\n                    this._data[(destCol + cell) * CELL_SIZE + i] = srcData[(srcCol + cell) * CELL_SIZE + i];\n                }\n            }\n        }\n        else {\n            for (var cell = 0; cell < length; cell++) {\n                for (var i = 0; i < CELL_SIZE; i++) {\n                    this._data[(destCol + cell) * CELL_SIZE + i] = srcData[(srcCol + cell) * CELL_SIZE + i];\n                }\n            }\n        }\n        var srcCombinedKeys = Object.keys(src._combined);\n        for (var i = 0; i < srcCombinedKeys.length; i++) {\n            var key = parseInt(srcCombinedKeys[i], 10);\n            if (key >= srcCol) {\n                this._combined[key - srcCol + destCol] = src._combined[key];\n            }\n        }\n    };\n    BufferLine.prototype.translateToString = function (trimRight, startCol, endCol) {\n        if (trimRight === void 0) { trimRight = false; }\n        if (startCol === void 0) { startCol = 0; }\n        if (endCol === void 0) { endCol = this.length; }\n        if (trimRight) {\n            endCol = Math.min(endCol, this.getTrimmedLength());\n        }\n        var result = '';\n        while (startCol < endCol) {\n            var content = this._data[startCol * CELL_SIZE + 0];\n            var cp = content & 2097151;\n            result += (content & 2097152) ? this._combined[startCol] : (cp) ? TextDecoder_1.stringFromCodePoint(cp) : Buffer_1.WHITESPACE_CELL_CHAR;\n            startCol += (content >> 22) || 1;\n        }\n        return result;\n    };\n    return BufferLine;\n}());\nexports.BufferLine = BufferLine;\n//# sourceMappingURL=BufferLine.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction prepareTextForTerminal(text) {\n    return text.replace(/\\r?\\n/g, '\\r');\n}\nexports.prepareTextForTerminal = prepareTextForTerminal;\nfunction bracketTextForPaste(text, bracketedPasteMode) {\n    if (bracketedPasteMode) {\n        return '\\x1b[200~' + text + '\\x1b[201~';\n    }\n    return text;\n}\nexports.bracketTextForPaste = bracketTextForPaste;\nfunction copyHandler(ev, term, selectionManager) {\n    if (term.browser.isMSIE) {\n        window.clipboardData.setData('Text', selectionManager.selectionText);\n    }\n    else {\n        ev.clipboardData.setData('text/plain', selectionManager.selectionText);\n    }\n    ev.preventDefault();\n}\nexports.copyHandler = copyHandler;\nfunction pasteHandler(ev, term) {\n    ev.stopPropagation();\n    var text;\n    var dispatchPaste = function (text) {\n        text = prepareTextForTerminal(text);\n        text = bracketTextForPaste(text, term.bracketedPasteMode);\n        term.handler(text);\n        term.textarea.value = '';\n        term.emit('paste', text);\n        term.cancel(ev);\n    };\n    if (term.browser.isMSIE) {\n        if (window.clipboardData) {\n            text = window.clipboardData.getData('Text');\n            dispatchPaste(text);\n        }\n    }\n    else {\n        if (ev.clipboardData) {\n            text = ev.clipboardData.getData('text/plain');\n            dispatchPaste(text);\n        }\n    }\n}\nexports.pasteHandler = pasteHandler;\nfunction moveTextAreaUnderMouseCursor(ev, term) {\n    var pos = term.screenElement.getBoundingClientRect();\n    var left = ev.clientX - pos.left - 10;\n    var top = ev.clientY - pos.top - 10;\n    term.textarea.style.position = 'absolute';\n    term.textarea.style.width = '20px';\n    term.textarea.style.height = '20px';\n    term.textarea.style.left = left + \"px\";\n    term.textarea.style.top = top + \"px\";\n    term.textarea.style.zIndex = '1000';\n    term.textarea.focus();\n    setTimeout(function () {\n        term.textarea.style.position = null;\n        term.textarea.style.width = null;\n        term.textarea.style.height = null;\n        term.textarea.style.left = null;\n        term.textarea.style.top = null;\n        term.textarea.style.zIndex = null;\n    }, 200);\n}\nexports.moveTextAreaUnderMouseCursor = moveTextAreaUnderMouseCursor;\nfunction rightClickHandler(ev, term, selectionManager, shouldSelectWord) {\n    moveTextAreaUnderMouseCursor(ev, term);\n    if (shouldSelectWord && !selectionManager.isClickInSelection(ev)) {\n        selectionManager.selectWordAtCursor(ev);\n    }\n    term.textarea.value = selectionManager.selectionText;\n    term.textarea.select();\n}\nexports.rightClickHandler = rightClickHandler;\n//# sourceMappingURL=Clipboard.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Strings = require(\"./Strings\");\nvar Platform_1 = require(\"./common/Platform\");\nvar RenderDebouncer_1 = require(\"./ui/RenderDebouncer\");\nvar Lifecycle_1 = require(\"./ui/Lifecycle\");\nvar Lifecycle_2 = require(\"./common/Lifecycle\");\nvar MAX_ROWS_TO_READ = 20;\nvar AccessibilityManager = (function (_super) {\n    __extends(AccessibilityManager, _super);\n    function AccessibilityManager(_terminal) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._liveRegionLineCount = 0;\n        _this._charsToConsume = [];\n        _this._accessibilityTreeRoot = document.createElement('div');\n        _this._accessibilityTreeRoot.classList.add('xterm-accessibility');\n        _this._rowContainer = document.createElement('div');\n        _this._rowContainer.classList.add('xterm-accessibility-tree');\n        _this._rowElements = [];\n        for (var i = 0; i < _this._terminal.rows; i++) {\n            _this._rowElements[i] = _this._createAccessibilityTreeNode();\n            _this._rowContainer.appendChild(_this._rowElements[i]);\n        }\n        _this._topBoundaryFocusListener = function (e) { return _this._onBoundaryFocus(e, 0); };\n        _this._bottomBoundaryFocusListener = function (e) { return _this._onBoundaryFocus(e, 1); };\n        _this._rowElements[0].addEventListener('focus', _this._topBoundaryFocusListener);\n        _this._rowElements[_this._rowElements.length - 1].addEventListener('focus', _this._bottomBoundaryFocusListener);\n        _this._refreshRowsDimensions();\n        _this._accessibilityTreeRoot.appendChild(_this._rowContainer);\n        _this._renderRowsDebouncer = new RenderDebouncer_1.RenderDebouncer(_this._renderRows.bind(_this));\n        _this._refreshRows();\n        _this._liveRegion = document.createElement('div');\n        _this._liveRegion.classList.add('live-region');\n        _this._liveRegion.setAttribute('aria-live', 'assertive');\n        _this._accessibilityTreeRoot.appendChild(_this._liveRegion);\n        _this._terminal.element.insertAdjacentElement('afterbegin', _this._accessibilityTreeRoot);\n        _this.register(_this._renderRowsDebouncer);\n        _this.register(_this._terminal.onResize(function (e) { return _this._onResize(e.rows); }));\n        _this.register(_this._terminal.onRender(function (e) { return _this._refreshRows(e.start, e.end); }));\n        _this.register(_this._terminal.onScroll(function () { return _this._refreshRows(); }));\n        _this.register(_this._terminal.addDisposableListener('a11y.char', function (char) { return _this._onChar(char); }));\n        _this.register(_this._terminal.onLineFeed(function () { return _this._onChar('\\n'); }));\n        _this.register(_this._terminal.addDisposableListener('a11y.tab', function (spaceCount) { return _this._onTab(spaceCount); }));\n        _this.register(_this._terminal.onKey(function (e) { return _this._onKey(e.key); }));\n        _this.register(_this._terminal.addDisposableListener('blur', function () { return _this._clearLiveRegion(); }));\n        _this.register(_this._terminal.addDisposableListener('dprchange', function () { return _this._refreshRowsDimensions(); }));\n        _this.register(_this._terminal.renderer.onCanvasResize(function () { return _this._refreshRowsDimensions(); }));\n        _this.register(Lifecycle_1.addDisposableDomListener(window, 'resize', function () { return _this._refreshRowsDimensions(); }));\n        return _this;\n    }\n    AccessibilityManager.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._terminal.element.removeChild(this._accessibilityTreeRoot);\n        this._rowElements.length = 0;\n    };\n    AccessibilityManager.prototype._onBoundaryFocus = function (e, position) {\n        var boundaryElement = e.target;\n        var beforeBoundaryElement = this._rowElements[position === 0 ? 1 : this._rowElements.length - 2];\n        var posInSet = boundaryElement.getAttribute('aria-posinset');\n        var lastRowPos = position === 0 ? '1' : \"\" + this._terminal.buffer.lines.length;\n        if (posInSet === lastRowPos) {\n            return;\n        }\n        if (e.relatedTarget !== beforeBoundaryElement) {\n            return;\n        }\n        var topBoundaryElement;\n        var bottomBoundaryElement;\n        if (position === 0) {\n            topBoundaryElement = boundaryElement;\n            bottomBoundaryElement = this._rowElements.pop();\n            this._rowContainer.removeChild(bottomBoundaryElement);\n        }\n        else {\n            topBoundaryElement = this._rowElements.shift();\n            bottomBoundaryElement = boundaryElement;\n            this._rowContainer.removeChild(topBoundaryElement);\n        }\n        topBoundaryElement.removeEventListener('focus', this._topBoundaryFocusListener);\n        bottomBoundaryElement.removeEventListener('focus', this._bottomBoundaryFocusListener);\n        if (position === 0) {\n            var newElement = this._createAccessibilityTreeNode();\n            this._rowElements.unshift(newElement);\n            this._rowContainer.insertAdjacentElement('afterbegin', newElement);\n        }\n        else {\n            var newElement = this._createAccessibilityTreeNode();\n            this._rowElements.push(newElement);\n            this._rowContainer.appendChild(newElement);\n        }\n        this._rowElements[0].addEventListener('focus', this._topBoundaryFocusListener);\n        this._rowElements[this._rowElements.length - 1].addEventListener('focus', this._bottomBoundaryFocusListener);\n        this._terminal.scrollLines(position === 0 ? -1 : 1);\n        this._rowElements[position === 0 ? 1 : this._rowElements.length - 2].focus();\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    };\n    AccessibilityManager.prototype._onResize = function (rows) {\n        this._rowElements[this._rowElements.length - 1].removeEventListener('focus', this._bottomBoundaryFocusListener);\n        for (var i = this._rowContainer.children.length; i < this._terminal.rows; i++) {\n            this._rowElements[i] = this._createAccessibilityTreeNode();\n            this._rowContainer.appendChild(this._rowElements[i]);\n        }\n        while (this._rowElements.length > rows) {\n            this._rowContainer.removeChild(this._rowElements.pop());\n        }\n        this._rowElements[this._rowElements.length - 1].addEventListener('focus', this._bottomBoundaryFocusListener);\n        this._refreshRowsDimensions();\n    };\n    AccessibilityManager.prototype._createAccessibilityTreeNode = function () {\n        var element = document.createElement('div');\n        element.setAttribute('role', 'listitem');\n        element.tabIndex = -1;\n        this._refreshRowDimensions(element);\n        return element;\n    };\n    AccessibilityManager.prototype._onTab = function (spaceCount) {\n        for (var i = 0; i < spaceCount; i++) {\n            this._onChar(' ');\n        }\n    };\n    AccessibilityManager.prototype._onChar = function (char) {\n        var _this = this;\n        if (this._liveRegionLineCount < MAX_ROWS_TO_READ + 1) {\n            if (this._charsToConsume.length > 0) {\n                var shiftedChar = this._charsToConsume.shift();\n                if (shiftedChar !== char) {\n                    this._announceCharacter(char);\n                }\n            }\n            else {\n                this._announceCharacter(char);\n            }\n            if (char === '\\n') {\n                this._liveRegionLineCount++;\n                if (this._liveRegionLineCount === MAX_ROWS_TO_READ + 1) {\n                    this._liveRegion.textContent += Strings.tooMuchOutput;\n                }\n            }\n            if (Platform_1.isMac) {\n                if (this._liveRegion.textContent && this._liveRegion.textContent.length > 0 && !this._liveRegion.parentNode) {\n                    setTimeout(function () {\n                        _this._accessibilityTreeRoot.appendChild(_this._liveRegion);\n                    }, 0);\n                }\n            }\n        }\n    };\n    AccessibilityManager.prototype._clearLiveRegion = function () {\n        this._liveRegion.textContent = '';\n        this._liveRegionLineCount = 0;\n        if (Platform_1.isMac) {\n            if (this._liveRegion.parentNode) {\n                this._accessibilityTreeRoot.removeChild(this._liveRegion);\n            }\n        }\n    };\n    AccessibilityManager.prototype._onKey = function (keyChar) {\n        this._clearLiveRegion();\n        this._charsToConsume.push(keyChar);\n    };\n    AccessibilityManager.prototype._refreshRows = function (start, end) {\n        this._renderRowsDebouncer.refresh(start, end, this._terminal.rows);\n    };\n    AccessibilityManager.prototype._renderRows = function (start, end) {\n        var buffer = this._terminal.buffer;\n        var setSize = buffer.lines.length.toString();\n        for (var i = start; i <= end; i++) {\n            var lineData = buffer.translateBufferLineToString(buffer.ydisp + i, true);\n            var posInSet = (buffer.ydisp + i + 1).toString();\n            var element = this._rowElements[i];\n            if (element) {\n                element.textContent = lineData.length === 0 ? Strings.blankLine : lineData;\n                element.setAttribute('aria-posinset', posInSet);\n                element.setAttribute('aria-setsize', setSize);\n            }\n        }\n    };\n    AccessibilityManager.prototype._refreshRowsDimensions = function () {\n        if (!this._terminal.renderer.dimensions.actualCellHeight) {\n            return;\n        }\n        if (this._rowElements.length !== this._terminal.rows) {\n            this._onResize(this._terminal.rows);\n        }\n        for (var i = 0; i < this._terminal.rows; i++) {\n            this._refreshRowDimensions(this._rowElements[i]);\n        }\n    };\n    AccessibilityManager.prototype._refreshRowDimensions = function (element) {\n        element.style.height = this._terminal.renderer.dimensions.actualCellHeight + \"px\";\n    };\n    AccessibilityManager.prototype._announceCharacter = function (char) {\n        if (char === ' ') {\n            this._liveRegion.innerHTML += '&nbsp;';\n        }\n        else {\n            this._liveRegion.textContent += char;\n        }\n    };\n    return AccessibilityManager;\n}(Lifecycle_2.Disposable));\nexports.AccessibilityManager = AccessibilityManager;\n//# sourceMappingURL=AccessibilityManager.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar SelectionRenderLayer = (function (_super) {\n    __extends(SelectionRenderLayer, _super);\n    function SelectionRenderLayer(container, zIndex, colors) {\n        var _this = _super.call(this, container, 'selection', zIndex, true, colors) || this;\n        _this._clearState();\n        return _this;\n    }\n    SelectionRenderLayer.prototype._clearState = function () {\n        this._state = {\n            start: null,\n            end: null,\n            columnSelectMode: null,\n            ydisp: null\n        };\n    };\n    SelectionRenderLayer.prototype.resize = function (terminal, dim) {\n        _super.prototype.resize.call(this, terminal, dim);\n        this._clearState();\n    };\n    SelectionRenderLayer.prototype.reset = function (terminal) {\n        if (this._state.start && this._state.end) {\n            this._clearState();\n            this.clearAll();\n        }\n    };\n    SelectionRenderLayer.prototype.onSelectionChanged = function (terminal, start, end, columnSelectMode) {\n        if (!this._didStateChange(start, end, columnSelectMode, terminal.buffer.ydisp)) {\n            return;\n        }\n        this.clearAll();\n        if (!start || !end) {\n            this._clearState();\n            return;\n        }\n        var viewportStartRow = start[1] - terminal.buffer.ydisp;\n        var viewportEndRow = end[1] - terminal.buffer.ydisp;\n        var viewportCappedStartRow = Math.max(viewportStartRow, 0);\n        var viewportCappedEndRow = Math.min(viewportEndRow, terminal.rows - 1);\n        if (viewportCappedStartRow >= terminal.rows || viewportCappedEndRow < 0) {\n            return;\n        }\n        this._ctx.fillStyle = this._colors.selection.css;\n        if (columnSelectMode) {\n            var startCol = start[0];\n            var width = end[0] - startCol;\n            var height = viewportCappedEndRow - viewportCappedStartRow + 1;\n            this.fillCells(startCol, viewportCappedStartRow, width, height);\n        }\n        else {\n            var startCol = viewportStartRow === viewportCappedStartRow ? start[0] : 0;\n            var startRowEndCol = viewportCappedStartRow === viewportCappedEndRow ? end[0] : terminal.cols;\n            this.fillCells(startCol, viewportCappedStartRow, startRowEndCol - startCol, 1);\n            var middleRowsCount = Math.max(viewportCappedEndRow - viewportCappedStartRow - 1, 0);\n            this.fillCells(0, viewportCappedStartRow + 1, terminal.cols, middleRowsCount);\n            if (viewportCappedStartRow !== viewportCappedEndRow) {\n                var endCol = viewportEndRow === viewportCappedEndRow ? end[0] : terminal.cols;\n                this.fillCells(0, viewportCappedEndRow, endCol, 1);\n            }\n        }\n        this._state.start = [start[0], start[1]];\n        this._state.end = [end[0], end[1]];\n        this._state.columnSelectMode = columnSelectMode;\n        this._state.ydisp = terminal.buffer.ydisp;\n    };\n    SelectionRenderLayer.prototype._didStateChange = function (start, end, columnSelectMode, ydisp) {\n        return !this._areCoordinatesEqual(start, this._state.start) ||\n            !this._areCoordinatesEqual(end, this._state.end) ||\n            columnSelectMode !== this._state.columnSelectMode ||\n            ydisp !== this._state.ydisp;\n    };\n    SelectionRenderLayer.prototype._areCoordinatesEqual = function (coord1, coord2) {\n        if (!coord1 || !coord2) {\n            return false;\n        }\n        return coord1[0] === coord2[0] && coord1[1] === coord2[1];\n    };\n    return SelectionRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.SelectionRenderLayer = SelectionRenderLayer;\n//# sourceMappingURL=SelectionRenderLayer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RenderDebouncer = (function () {\n    function RenderDebouncer(_renderCallback) {\n        this._renderCallback = _renderCallback;\n    }\n    RenderDebouncer.prototype.dispose = function () {\n        if (this._animationFrame) {\n            window.cancelAnimationFrame(this._animationFrame);\n            this._animationFrame = undefined;\n        }\n    };\n    RenderDebouncer.prototype.refresh = function (rowStart, rowEnd, rowCount) {\n        var _this = this;\n        this._rowCount = rowCount;\n        rowStart = rowStart !== undefined ? rowStart : 0;\n        rowEnd = rowEnd !== undefined ? rowEnd : this._rowCount - 1;\n        this._rowStart = this._rowStart !== undefined ? Math.min(this._rowStart, rowStart) : rowStart;\n        this._rowEnd = this._rowEnd !== undefined ? Math.max(this._rowEnd, rowEnd) : rowEnd;\n        if (this._animationFrame) {\n            return;\n        }\n        this._animationFrame = window.requestAnimationFrame(function () { return _this._innerRefresh(); });\n    };\n    RenderDebouncer.prototype._innerRefresh = function () {\n        if (this._rowStart === undefined || this._rowEnd === undefined || this._rowCount === undefined) {\n            return;\n        }\n        this._rowStart = Math.max(this._rowStart, 0);\n        this._rowEnd = Math.min(this._rowEnd, this._rowCount - 1);\n        this._renderCallback(this._rowStart, this._rowEnd);\n        this._rowStart = undefined;\n        this._rowEnd = undefined;\n        this._animationFrame = undefined;\n    };\n    return RenderDebouncer;\n}());\nexports.RenderDebouncer = RenderDebouncer;\n//# sourceMappingURL=RenderDebouncer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ColorManager_1 = require(\"../ColorManager\");\nvar RenderDebouncer_1 = require(\"../../ui/RenderDebouncer\");\nvar DomRendererRowFactory_1 = require(\"./DomRendererRowFactory\");\nvar Types_1 = require(\"../atlas/Types\");\nvar EventEmitter2_1 = require(\"../../common/EventEmitter2\");\nvar Lifecycle_1 = require(\"../../common/Lifecycle\");\nvar TERMINAL_CLASS_PREFIX = 'xterm-dom-renderer-owner-';\nvar ROW_CONTAINER_CLASS = 'xterm-rows';\nvar FG_CLASS_PREFIX = 'xterm-fg-';\nvar BG_CLASS_PREFIX = 'xterm-bg-';\nvar FOCUS_CLASS = 'xterm-focus';\nvar SELECTION_CLASS = 'xterm-selection';\nvar nextTerminalId = 1;\nvar DomRenderer = (function (_super) {\n    __extends(DomRenderer, _super);\n    function DomRenderer(_terminal, theme) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._terminalClass = nextTerminalId++;\n        _this._rowElements = [];\n        _this._onCanvasResize = new EventEmitter2_1.EventEmitter2();\n        _this._onRender = new EventEmitter2_1.EventEmitter2();\n        var allowTransparency = _this._terminal.options.allowTransparency;\n        _this.colorManager = new ColorManager_1.ColorManager(document, allowTransparency);\n        _this.setTheme(theme);\n        _this._rowContainer = document.createElement('div');\n        _this._rowContainer.classList.add(ROW_CONTAINER_CLASS);\n        _this._rowContainer.style.lineHeight = 'normal';\n        _this._rowContainer.setAttribute('aria-hidden', 'true');\n        _this._refreshRowElements(_this._terminal.cols, _this._terminal.rows);\n        _this._selectionContainer = document.createElement('div');\n        _this._selectionContainer.classList.add(SELECTION_CLASS);\n        _this._selectionContainer.setAttribute('aria-hidden', 'true');\n        _this.dimensions = {\n            scaledCharWidth: null,\n            scaledCharHeight: null,\n            scaledCellWidth: null,\n            scaledCellHeight: null,\n            scaledCharLeft: null,\n            scaledCharTop: null,\n            scaledCanvasWidth: null,\n            scaledCanvasHeight: null,\n            canvasWidth: null,\n            canvasHeight: null,\n            actualCellWidth: null,\n            actualCellHeight: null\n        };\n        _this._updateDimensions();\n        _this._renderDebouncer = new RenderDebouncer_1.RenderDebouncer(_this._renderRows.bind(_this));\n        _this._rowFactory = new DomRendererRowFactory_1.DomRendererRowFactory(_terminal.options, document);\n        _this._terminal.element.classList.add(TERMINAL_CLASS_PREFIX + _this._terminalClass);\n        _this._terminal.screenElement.appendChild(_this._rowContainer);\n        _this._terminal.screenElement.appendChild(_this._selectionContainer);\n        _this._terminal.linkifier.onLinkHover(function (e) { return _this._onLinkHover(e); });\n        _this._terminal.linkifier.onLinkLeave(function (e) { return _this._onLinkLeave(e); });\n        return _this;\n    }\n    Object.defineProperty(DomRenderer.prototype, \"onCanvasResize\", {\n        get: function () { return this._onCanvasResize.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DomRenderer.prototype, \"onRender\", {\n        get: function () { return this._onRender.event; },\n        enumerable: true,\n        configurable: true\n    });\n    DomRenderer.prototype.dispose = function () {\n        this._terminal.element.classList.remove(TERMINAL_CLASS_PREFIX + this._terminalClass);\n        this._terminal.screenElement.removeChild(this._rowContainer);\n        this._terminal.screenElement.removeChild(this._selectionContainer);\n        this._terminal.screenElement.removeChild(this._themeStyleElement);\n        this._terminal.screenElement.removeChild(this._dimensionsStyleElement);\n        _super.prototype.dispose.call(this);\n    };\n    DomRenderer.prototype._updateDimensions = function () {\n        var _this = this;\n        this.dimensions.scaledCharWidth = Math.floor(this._terminal.charMeasure.width * window.devicePixelRatio);\n        this.dimensions.scaledCharHeight = Math.ceil(this._terminal.charMeasure.height * window.devicePixelRatio);\n        this.dimensions.scaledCellWidth = this.dimensions.scaledCharWidth + Math.round(this._terminal.options.letterSpacing);\n        this.dimensions.scaledCellHeight = Math.floor(this.dimensions.scaledCharHeight * this._terminal.options.lineHeight);\n        this.dimensions.scaledCharLeft = 0;\n        this.dimensions.scaledCharTop = 0;\n        this.dimensions.scaledCanvasWidth = this.dimensions.scaledCellWidth * this._terminal.cols;\n        this.dimensions.scaledCanvasHeight = this.dimensions.scaledCellHeight * this._terminal.rows;\n        this.dimensions.canvasWidth = Math.round(this.dimensions.scaledCanvasWidth / window.devicePixelRatio);\n        this.dimensions.canvasHeight = Math.round(this.dimensions.scaledCanvasHeight / window.devicePixelRatio);\n        this.dimensions.actualCellWidth = this.dimensions.canvasWidth / this._terminal.cols;\n        this.dimensions.actualCellHeight = this.dimensions.canvasHeight / this._terminal.rows;\n        this._rowElements.forEach(function (element) {\n            element.style.width = _this.dimensions.canvasWidth + \"px\";\n            element.style.height = _this.dimensions.actualCellHeight + \"px\";\n            element.style.lineHeight = _this.dimensions.actualCellHeight + \"px\";\n            element.style.overflow = 'hidden';\n        });\n        if (!this._dimensionsStyleElement) {\n            this._dimensionsStyleElement = document.createElement('style');\n            this._terminal.screenElement.appendChild(this._dimensionsStyleElement);\n        }\n        var styles = this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \" span {\" +\n            \" display: inline-block;\" +\n            \" height: 100%;\" +\n            \" vertical-align: top;\" +\n            (\" width: \" + this.dimensions.actualCellWidth + \"px\") +\n            \"}\";\n        this._dimensionsStyleElement.innerHTML = styles;\n        this._selectionContainer.style.height = this._terminal._viewportElement.style.height;\n        this._terminal.screenElement.style.width = this.dimensions.canvasWidth + \"px\";\n        this._terminal.screenElement.style.height = this.dimensions.canvasHeight + \"px\";\n    };\n    DomRenderer.prototype.setTheme = function (theme) {\n        var _this = this;\n        if (theme) {\n            this.colorManager.setTheme(theme);\n        }\n        if (!this._themeStyleElement) {\n            this._themeStyleElement = document.createElement('style');\n            this._terminal.screenElement.appendChild(this._themeStyleElement);\n        }\n        var styles = this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \" {\" +\n            (\" color: \" + this.colorManager.colors.foreground.css + \";\") +\n            (\" background-color: \" + this.colorManager.colors.background.css + \";\") +\n            (\" font-family: \" + this._terminal.getOption('fontFamily') + \";\") +\n            (\" font-size: \" + this._terminal.getOption('fontSize') + \"px;\") +\n            \"}\";\n        styles +=\n            this._terminalSelector + \" span:not(.\" + DomRendererRowFactory_1.BOLD_CLASS + \") {\" +\n                (\" font-weight: \" + this._terminal.options.fontWeight + \";\") +\n                \"}\" +\n                (this._terminalSelector + \" span.\" + DomRendererRowFactory_1.BOLD_CLASS + \" {\") +\n                (\" font-weight: \" + this._terminal.options.fontWeightBold + \";\") +\n                \"}\" +\n                (this._terminalSelector + \" span.\" + DomRendererRowFactory_1.ITALIC_CLASS + \" {\") +\n                \" font-style: italic;\" +\n                \"}\";\n        styles +=\n            \"@keyframes blink {\" +\n                \" 0% { opacity: 1.0; }\" +\n                \" 50% { opacity: 0.0; }\" +\n                \" 100% { opacity: 1.0; }\" +\n                \"}\";\n        styles +=\n            this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \":not(.\" + FOCUS_CLASS + \") .\" + DomRendererRowFactory_1.CURSOR_CLASS + \" {\" +\n                (\" outline: 1px solid \" + this.colorManager.colors.cursor.css + \";\") +\n                \" outline-offset: -1px;\" +\n                \"}\" +\n                (this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \".\" + FOCUS_CLASS + \" .\" + DomRendererRowFactory_1.CURSOR_CLASS + \".\" + DomRendererRowFactory_1.CURSOR_BLINK_CLASS + \" {\") +\n                \" animation: blink 1s step-end infinite;\" +\n                \"}\" +\n                (this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \".\" + FOCUS_CLASS + \" .\" + DomRendererRowFactory_1.CURSOR_CLASS + \".\" + DomRendererRowFactory_1.CURSOR_STYLE_BLOCK_CLASS + \" {\") +\n                (\" background-color: \" + this.colorManager.colors.cursor.css + \";\") +\n                (\" color: \" + this.colorManager.colors.cursorAccent.css + \";\") +\n                \"}\" +\n                (this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \".\" + FOCUS_CLASS + \" .\" + DomRendererRowFactory_1.CURSOR_CLASS + \".\" + DomRendererRowFactory_1.CURSOR_STYLE_BAR_CLASS + \" {\") +\n                (\" box-shadow: 1px 0 0 \" + this.colorManager.colors.cursor.css + \" inset;\") +\n                \"}\" +\n                (this._terminalSelector + \" .\" + ROW_CONTAINER_CLASS + \".\" + FOCUS_CLASS + \" .\" + DomRendererRowFactory_1.CURSOR_CLASS + \".\" + DomRendererRowFactory_1.CURSOR_STYLE_UNDERLINE_CLASS + \" {\") +\n                (\" box-shadow: 0 -1px 0 \" + this.colorManager.colors.cursor.css + \" inset;\") +\n                \"}\";\n        styles +=\n            this._terminalSelector + \" .\" + SELECTION_CLASS + \" {\" +\n                \" position: absolute;\" +\n                \" top: 0;\" +\n                \" left: 0;\" +\n                \" z-index: 1;\" +\n                \" pointer-events: none;\" +\n                \"}\" +\n                (this._terminalSelector + \" .\" + SELECTION_CLASS + \" div {\") +\n                \" position: absolute;\" +\n                (\" background-color: \" + this.colorManager.colors.selection.css + \";\") +\n                \"}\";\n        this.colorManager.colors.ansi.forEach(function (c, i) {\n            styles +=\n                _this._terminalSelector + \" .\" + FG_CLASS_PREFIX + i + \" { color: \" + c.css + \"; }\" +\n                    (_this._terminalSelector + \" .\" + BG_CLASS_PREFIX + i + \" { background-color: \" + c.css + \"; }\");\n        });\n        styles +=\n            this._terminalSelector + \" .\" + FG_CLASS_PREFIX + Types_1.INVERTED_DEFAULT_COLOR + \" { color: \" + this.colorManager.colors.background.css + \"; }\" +\n                (this._terminalSelector + \" .\" + BG_CLASS_PREFIX + Types_1.INVERTED_DEFAULT_COLOR + \" { background-color: \" + this.colorManager.colors.foreground.css + \"; }\");\n        this._themeStyleElement.innerHTML = styles;\n        return this.colorManager.colors;\n    };\n    DomRenderer.prototype.onWindowResize = function (devicePixelRatio) {\n        this._updateDimensions();\n    };\n    DomRenderer.prototype._refreshRowElements = function (cols, rows) {\n        for (var i = this._rowElements.length; i <= rows; i++) {\n            var row = document.createElement('div');\n            this._rowContainer.appendChild(row);\n            this._rowElements.push(row);\n        }\n        while (this._rowElements.length > rows) {\n            this._rowContainer.removeChild(this._rowElements.pop());\n        }\n    };\n    DomRenderer.prototype.onResize = function (cols, rows) {\n        this._refreshRowElements(cols, rows);\n        this._updateDimensions();\n        this._onCanvasResize.fire({\n            width: this.dimensions.canvasWidth,\n            height: this.dimensions.canvasHeight\n        });\n    };\n    DomRenderer.prototype.onCharSizeChanged = function () {\n        this._updateDimensions();\n    };\n    DomRenderer.prototype.onBlur = function () {\n        this._rowContainer.classList.remove(FOCUS_CLASS);\n    };\n    DomRenderer.prototype.onFocus = function () {\n        this._rowContainer.classList.add(FOCUS_CLASS);\n    };\n    DomRenderer.prototype.onSelectionChanged = function (start, end, columnSelectMode) {\n        while (this._selectionContainer.children.length) {\n            this._selectionContainer.removeChild(this._selectionContainer.children[0]);\n        }\n        if (!start || !end) {\n            return;\n        }\n        var viewportStartRow = start[1] - this._terminal.buffer.ydisp;\n        var viewportEndRow = end[1] - this._terminal.buffer.ydisp;\n        var viewportCappedStartRow = Math.max(viewportStartRow, 0);\n        var viewportCappedEndRow = Math.min(viewportEndRow, this._terminal.rows - 1);\n        if (viewportCappedStartRow >= this._terminal.rows || viewportCappedEndRow < 0) {\n            return;\n        }\n        var documentFragment = document.createDocumentFragment();\n        if (columnSelectMode) {\n            documentFragment.appendChild(this._createSelectionElement(viewportCappedStartRow, start[0], end[0], viewportCappedEndRow - viewportCappedStartRow + 1));\n        }\n        else {\n            var startCol = viewportStartRow === viewportCappedStartRow ? start[0] : 0;\n            var endCol = viewportCappedStartRow === viewportCappedEndRow ? end[0] : this._terminal.cols;\n            documentFragment.appendChild(this._createSelectionElement(viewportCappedStartRow, startCol, endCol));\n            var middleRowsCount = viewportCappedEndRow - viewportCappedStartRow - 1;\n            documentFragment.appendChild(this._createSelectionElement(viewportCappedStartRow + 1, 0, this._terminal.cols, middleRowsCount));\n            if (viewportCappedStartRow !== viewportCappedEndRow) {\n                var endCol_1 = viewportEndRow === viewportCappedEndRow ? end[0] : this._terminal.cols;\n                documentFragment.appendChild(this._createSelectionElement(viewportCappedEndRow, 0, endCol_1));\n            }\n        }\n        this._selectionContainer.appendChild(documentFragment);\n    };\n    DomRenderer.prototype._createSelectionElement = function (row, colStart, colEnd, rowCount) {\n        if (rowCount === void 0) { rowCount = 1; }\n        var element = document.createElement('div');\n        element.style.height = rowCount * this.dimensions.actualCellHeight + \"px\";\n        element.style.top = row * this.dimensions.actualCellHeight + \"px\";\n        element.style.left = colStart * this.dimensions.actualCellWidth + \"px\";\n        element.style.width = this.dimensions.actualCellWidth * (colEnd - colStart) + \"px\";\n        return element;\n    };\n    DomRenderer.prototype.onCursorMove = function () {\n    };\n    DomRenderer.prototype.onOptionsChanged = function () {\n        this._updateDimensions();\n        this.setTheme(undefined);\n        this._terminal.refresh(0, this._terminal.rows - 1);\n    };\n    DomRenderer.prototype.clear = function () {\n        this._rowElements.forEach(function (e) { return e.innerHTML = ''; });\n    };\n    DomRenderer.prototype.refreshRows = function (start, end) {\n        this._renderDebouncer.refresh(start, end, this._terminal.rows);\n    };\n    DomRenderer.prototype._renderRows = function (start, end) {\n        var terminal = this._terminal;\n        var cursorAbsoluteY = terminal.buffer.ybase + terminal.buffer.y;\n        var cursorX = this._terminal.buffer.x;\n        var cursorBlink = this._terminal.options.cursorBlink;\n        for (var y = start; y <= end; y++) {\n            var rowElement = this._rowElements[y];\n            rowElement.innerHTML = '';\n            var row = y + terminal.buffer.ydisp;\n            var lineData = terminal.buffer.lines.get(row);\n            var cursorStyle = terminal.options.cursorStyle;\n            rowElement.appendChild(this._rowFactory.createRow(lineData, row === cursorAbsoluteY, cursorStyle, cursorX, cursorBlink, this.dimensions.actualCellWidth, terminal.cols));\n        }\n        this._onRender.fire({ start: start, end: end });\n    };\n    Object.defineProperty(DomRenderer.prototype, \"_terminalSelector\", {\n        get: function () {\n            return \".\" + TERMINAL_CLASS_PREFIX + this._terminalClass;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DomRenderer.prototype.registerCharacterJoiner = function (handler) { return -1; };\n    DomRenderer.prototype.deregisterCharacterJoiner = function (joinerId) { return false; };\n    DomRenderer.prototype._onLinkHover = function (e) {\n        this._setCellUnderline(e.x1, e.x2, e.y1, e.y2, e.cols, true);\n    };\n    DomRenderer.prototype._onLinkLeave = function (e) {\n        this._setCellUnderline(e.x1, e.x2, e.y1, e.y2, e.cols, false);\n    };\n    DomRenderer.prototype._setCellUnderline = function (x, x2, y, y2, cols, enabled) {\n        while (x !== x2 || y !== y2) {\n            var row = this._rowElements[y];\n            if (!row) {\n                return;\n            }\n            var span = row.children[x];\n            if (span) {\n                span.style.textDecoration = enabled ? 'underline' : 'none';\n            }\n            if (++x >= cols) {\n                x = 0;\n                y++;\n            }\n        }\n    };\n    return DomRenderer;\n}(Lifecycle_1.Disposable));\nexports.DomRenderer = DomRenderer;\n//# sourceMappingURL=DomRenderer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CircularList_1 = require(\"./common/CircularList\");\nvar BufferLine_1 = require(\"./BufferLine\");\nvar BufferReflow_1 = require(\"./BufferReflow\");\nvar Types_1 = require(\"./renderer/atlas/Types\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar Lifecycle_1 = require(\"../lib/common/Lifecycle\");\nexports.DEFAULT_ATTR = (0 << 18) | (Types_1.DEFAULT_COLOR << 9) | (256 << 0);\nexports.DEFAULT_ATTR_DATA = new BufferLine_1.AttributeData();\nexports.CHAR_DATA_ATTR_INDEX = 0;\nexports.CHAR_DATA_CHAR_INDEX = 1;\nexports.CHAR_DATA_WIDTH_INDEX = 2;\nexports.CHAR_DATA_CODE_INDEX = 3;\nexports.MAX_BUFFER_SIZE = 4294967295;\nexports.NULL_CELL_CHAR = '';\nexports.NULL_CELL_WIDTH = 1;\nexports.NULL_CELL_CODE = 0;\nexports.WHITESPACE_CELL_CHAR = ' ';\nexports.WHITESPACE_CELL_WIDTH = 1;\nexports.WHITESPACE_CELL_CODE = 32;\nvar Buffer = (function () {\n    function Buffer(_terminal, _hasScrollback) {\n        this._terminal = _terminal;\n        this._hasScrollback = _hasScrollback;\n        this.savedCurAttrData = exports.DEFAULT_ATTR_DATA.clone();\n        this.markers = [];\n        this._nullCell = BufferLine_1.CellData.fromCharData([0, exports.NULL_CELL_CHAR, exports.NULL_CELL_WIDTH, exports.NULL_CELL_CODE]);\n        this._whitespaceCell = BufferLine_1.CellData.fromCharData([0, exports.WHITESPACE_CELL_CHAR, exports.WHITESPACE_CELL_WIDTH, exports.WHITESPACE_CELL_CODE]);\n        this._cols = this._terminal.cols;\n        this._rows = this._terminal.rows;\n        this.clear();\n    }\n    Buffer.prototype.getNullCell = function (attr) {\n        if (attr) {\n            this._nullCell.fg = attr.fg;\n            this._nullCell.bg = attr.bg;\n        }\n        else {\n            this._nullCell.fg = 0;\n            this._nullCell.bg = 0;\n        }\n        return this._nullCell;\n    };\n    Buffer.prototype.getWhitespaceCell = function (attr) {\n        if (attr) {\n            this._whitespaceCell.fg = attr.fg;\n            this._whitespaceCell.bg = attr.bg;\n        }\n        else {\n            this._whitespaceCell.fg = 0;\n            this._whitespaceCell.bg = 0;\n        }\n        return this._whitespaceCell;\n    };\n    Buffer.prototype.getBlankLine = function (attr, isWrapped) {\n        return new BufferLine_1.BufferLine(this._terminal.cols, this.getNullCell(attr), isWrapped);\n    };\n    Object.defineProperty(Buffer.prototype, \"hasScrollback\", {\n        get: function () {\n            return this._hasScrollback && this.lines.maxLength > this._rows;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Buffer.prototype, \"isCursorInViewport\", {\n        get: function () {\n            var absoluteY = this.ybase + this.y;\n            var relativeY = absoluteY - this.ydisp;\n            return (relativeY >= 0 && relativeY < this._rows);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Buffer.prototype._getCorrectBufferLength = function (rows) {\n        if (!this._hasScrollback) {\n            return rows;\n        }\n        var correctBufferLength = rows + this._terminal.options.scrollback;\n        return correctBufferLength > exports.MAX_BUFFER_SIZE ? exports.MAX_BUFFER_SIZE : correctBufferLength;\n    };\n    Buffer.prototype.fillViewportRows = function (fillAttr) {\n        if (this.lines.length === 0) {\n            if (fillAttr === undefined) {\n                fillAttr = exports.DEFAULT_ATTR_DATA;\n            }\n            var i = this._rows;\n            while (i--) {\n                this.lines.push(this.getBlankLine(fillAttr));\n            }\n        }\n    };\n    Buffer.prototype.clear = function () {\n        this.ydisp = 0;\n        this.ybase = 0;\n        this.y = 0;\n        this.x = 0;\n        this.lines = new CircularList_1.CircularList(this._getCorrectBufferLength(this._rows));\n        this.scrollTop = 0;\n        this.scrollBottom = this._rows - 1;\n        this.setupTabStops();\n    };\n    Buffer.prototype.resize = function (newCols, newRows) {\n        var nullCell = this.getNullCell(exports.DEFAULT_ATTR_DATA);\n        var newMaxLength = this._getCorrectBufferLength(newRows);\n        if (newMaxLength > this.lines.maxLength) {\n            this.lines.maxLength = newMaxLength;\n        }\n        if (this.lines.length > 0) {\n            if (this._cols < newCols) {\n                for (var i = 0; i < this.lines.length; i++) {\n                    this.lines.get(i).resize(newCols, nullCell);\n                }\n            }\n            var addToY = 0;\n            if (this._rows < newRows) {\n                for (var y = this._rows; y < newRows; y++) {\n                    if (this.lines.length < newRows + this.ybase) {\n                        if (this.ybase > 0 && this.lines.length <= this.ybase + this.y + addToY + 1) {\n                            this.ybase--;\n                            addToY++;\n                            if (this.ydisp > 0) {\n                                this.ydisp--;\n                            }\n                        }\n                        else {\n                            this.lines.push(new BufferLine_1.BufferLine(newCols, nullCell));\n                        }\n                    }\n                }\n            }\n            else {\n                for (var y = this._rows; y > newRows; y--) {\n                    if (this.lines.length > newRows + this.ybase) {\n                        if (this.lines.length > this.ybase + this.y + 1) {\n                            this.lines.pop();\n                        }\n                        else {\n                            this.ybase++;\n                            this.ydisp++;\n                        }\n                    }\n                }\n            }\n            if (newMaxLength < this.lines.maxLength) {\n                var amountToTrim = this.lines.length - newMaxLength;\n                if (amountToTrim > 0) {\n                    this.lines.trimStart(amountToTrim);\n                    this.ybase = Math.max(this.ybase - amountToTrim, 0);\n                    this.ydisp = Math.max(this.ydisp - amountToTrim, 0);\n                }\n                this.lines.maxLength = newMaxLength;\n            }\n            this.x = Math.min(this.x, newCols - 1);\n            this.y = Math.min(this.y, newRows - 1);\n            if (addToY) {\n                this.y += addToY;\n            }\n            this.savedY = Math.min(this.savedY, newRows - 1);\n            this.savedX = Math.min(this.savedX, newCols - 1);\n            this.scrollTop = 0;\n        }\n        this.scrollBottom = newRows - 1;\n        if (this._isReflowEnabled) {\n            this._reflow(newCols, newRows);\n            if (this._cols > newCols) {\n                for (var i = 0; i < this.lines.length; i++) {\n                    this.lines.get(i).resize(newCols, nullCell);\n                }\n            }\n        }\n        this._cols = newCols;\n        this._rows = newRows;\n    };\n    Object.defineProperty(Buffer.prototype, \"_isReflowEnabled\", {\n        get: function () {\n            return this._hasScrollback && !this._terminal.options.windowsMode;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Buffer.prototype._reflow = function (newCols, newRows) {\n        if (this._cols === newCols) {\n            return;\n        }\n        if (newCols > this._cols) {\n            this._reflowLarger(newCols, newRows);\n        }\n        else {\n            this._reflowSmaller(newCols, newRows);\n        }\n    };\n    Buffer.prototype._reflowLarger = function (newCols, newRows) {\n        var toRemove = BufferReflow_1.reflowLargerGetLinesToRemove(this.lines, this._cols, newCols, this.ybase + this.y, this.getNullCell(exports.DEFAULT_ATTR_DATA));\n        if (toRemove.length > 0) {\n            var newLayoutResult = BufferReflow_1.reflowLargerCreateNewLayout(this.lines, toRemove);\n            BufferReflow_1.reflowLargerApplyNewLayout(this.lines, newLayoutResult.layout);\n            this._reflowLargerAdjustViewport(newCols, newRows, newLayoutResult.countRemoved);\n        }\n    };\n    Buffer.prototype._reflowLargerAdjustViewport = function (newCols, newRows, countRemoved) {\n        var nullCell = this.getNullCell(exports.DEFAULT_ATTR_DATA);\n        var viewportAdjustments = countRemoved;\n        while (viewportAdjustments-- > 0) {\n            if (this.ybase === 0) {\n                if (this.y > 0) {\n                    this.y--;\n                }\n                if (this.lines.length < newRows) {\n                    this.lines.push(new BufferLine_1.BufferLine(newCols, nullCell));\n                }\n            }\n            else {\n                if (this.ydisp === this.ybase) {\n                    this.ydisp--;\n                }\n                this.ybase--;\n            }\n        }\n    };\n    Buffer.prototype._reflowSmaller = function (newCols, newRows) {\n        var nullCell = this.getNullCell(exports.DEFAULT_ATTR_DATA);\n        var toInsert = [];\n        var countToInsert = 0;\n        for (var y = this.lines.length - 1; y >= 0; y--) {\n            var nextLine = this.lines.get(y);\n            if (!nextLine.isWrapped && nextLine.getTrimmedLength() <= newCols) {\n                continue;\n            }\n            var wrappedLines = [nextLine];\n            while (nextLine.isWrapped && y > 0) {\n                nextLine = this.lines.get(--y);\n                wrappedLines.unshift(nextLine);\n            }\n            var absoluteY = this.ybase + this.y;\n            if (absoluteY >= y && absoluteY < y + wrappedLines.length) {\n                continue;\n            }\n            var lastLineLength = wrappedLines[wrappedLines.length - 1].getTrimmedLength();\n            var destLineLengths = BufferReflow_1.reflowSmallerGetNewLineLengths(wrappedLines, this._cols, newCols);\n            var linesToAdd = destLineLengths.length - wrappedLines.length;\n            var trimmedLines = void 0;\n            if (this.ybase === 0 && this.y !== this.lines.length - 1) {\n                trimmedLines = Math.max(0, this.y - this.lines.maxLength + linesToAdd);\n            }\n            else {\n                trimmedLines = Math.max(0, this.lines.length - this.lines.maxLength + linesToAdd);\n            }\n            var newLines = [];\n            for (var i = 0; i < linesToAdd; i++) {\n                var newLine = this.getBlankLine(exports.DEFAULT_ATTR_DATA, true);\n                newLines.push(newLine);\n            }\n            if (newLines.length > 0) {\n                toInsert.push({\n                    start: y + wrappedLines.length + countToInsert,\n                    newLines: newLines\n                });\n                countToInsert += newLines.length;\n            }\n            wrappedLines.push.apply(wrappedLines, newLines);\n            var destLineIndex = destLineLengths.length - 1;\n            var destCol = destLineLengths[destLineIndex];\n            if (destCol === 0) {\n                destLineIndex--;\n                destCol = destLineLengths[destLineIndex];\n            }\n            var srcLineIndex = wrappedLines.length - linesToAdd - 1;\n            var srcCol = lastLineLength;\n            while (srcLineIndex >= 0) {\n                var cellsToCopy = Math.min(srcCol, destCol);\n                wrappedLines[destLineIndex].copyCellsFrom(wrappedLines[srcLineIndex], srcCol - cellsToCopy, destCol - cellsToCopy, cellsToCopy, true);\n                destCol -= cellsToCopy;\n                if (destCol === 0) {\n                    destLineIndex--;\n                    destCol = destLineLengths[destLineIndex];\n                }\n                srcCol -= cellsToCopy;\n                if (srcCol === 0) {\n                    srcLineIndex--;\n                    var wrappedLinesIndex = Math.max(srcLineIndex, 0);\n                    srcCol = BufferReflow_1.getWrappedLineTrimmedLength(wrappedLines, wrappedLinesIndex, this._cols);\n                }\n            }\n            for (var i = 0; i < wrappedLines.length; i++) {\n                if (destLineLengths[i] < newCols) {\n                    wrappedLines[i].setCell(destLineLengths[i], nullCell);\n                }\n            }\n            var viewportAdjustments = linesToAdd - trimmedLines;\n            while (viewportAdjustments-- > 0) {\n                if (this.ybase === 0) {\n                    if (this.y < newRows - 1) {\n                        this.y++;\n                        this.lines.pop();\n                    }\n                    else {\n                        this.ybase++;\n                        this.ydisp++;\n                    }\n                }\n                else {\n                    if (this.ybase < Math.min(this.lines.maxLength, this.lines.length + countToInsert) - newRows) {\n                        if (this.ybase === this.ydisp) {\n                            this.ydisp++;\n                        }\n                        this.ybase++;\n                    }\n                }\n            }\n        }\n        if (toInsert.length > 0) {\n            var insertEvents = [];\n            var originalLines = [];\n            for (var i = 0; i < this.lines.length; i++) {\n                originalLines.push(this.lines.get(i));\n            }\n            var originalLinesLength = this.lines.length;\n            var originalLineIndex = originalLinesLength - 1;\n            var nextToInsertIndex = 0;\n            var nextToInsert = toInsert[nextToInsertIndex];\n            this.lines.length = Math.min(this.lines.maxLength, this.lines.length + countToInsert);\n            var countInsertedSoFar = 0;\n            for (var i = Math.min(this.lines.maxLength - 1, originalLinesLength + countToInsert - 1); i >= 0; i--) {\n                if (nextToInsert && nextToInsert.start > originalLineIndex + countInsertedSoFar) {\n                    for (var nextI = nextToInsert.newLines.length - 1; nextI >= 0; nextI--) {\n                        this.lines.set(i--, nextToInsert.newLines[nextI]);\n                    }\n                    i++;\n                    insertEvents.push({\n                        index: originalLineIndex + 1,\n                        amount: nextToInsert.newLines.length\n                    });\n                    countInsertedSoFar += nextToInsert.newLines.length;\n                    nextToInsert = toInsert[++nextToInsertIndex];\n                }\n                else {\n                    this.lines.set(i, originalLines[originalLineIndex--]);\n                }\n            }\n            var insertCountEmitted = 0;\n            for (var i = insertEvents.length - 1; i >= 0; i--) {\n                insertEvents[i].index += insertCountEmitted;\n                this.lines.onInsertEmitter.fire(insertEvents[i]);\n                insertCountEmitted += insertEvents[i].amount;\n            }\n            var amountToTrim = Math.max(0, originalLinesLength + countToInsert - this.lines.maxLength);\n            if (amountToTrim > 0) {\n                this.lines.onTrimEmitter.fire(amountToTrim);\n            }\n        }\n    };\n    Buffer.prototype.stringIndexToBufferIndex = function (lineIndex, stringIndex, trimRight) {\n        if (trimRight === void 0) { trimRight = false; }\n        while (stringIndex) {\n            var line = this.lines.get(lineIndex);\n            if (!line) {\n                return [-1, -1];\n            }\n            var length_1 = (trimRight) ? line.getTrimmedLength() : line.length;\n            for (var i = 0; i < length_1; ++i) {\n                if (line.get(i)[exports.CHAR_DATA_WIDTH_INDEX]) {\n                    stringIndex -= line.get(i)[exports.CHAR_DATA_CHAR_INDEX].length || 1;\n                }\n                if (stringIndex < 0) {\n                    return [lineIndex, i];\n                }\n            }\n            lineIndex++;\n        }\n        return [lineIndex, 0];\n    };\n    Buffer.prototype.translateBufferLineToString = function (lineIndex, trimRight, startCol, endCol) {\n        if (startCol === void 0) { startCol = 0; }\n        var line = this.lines.get(lineIndex);\n        if (!line) {\n            return '';\n        }\n        return line.translateToString(trimRight, startCol, endCol);\n    };\n    Buffer.prototype.getWrappedRangeForLine = function (y) {\n        var first = y;\n        var last = y;\n        while (first > 0 && this.lines.get(first).isWrapped) {\n            first--;\n        }\n        while (last + 1 < this.lines.length && this.lines.get(last + 1).isWrapped) {\n            last++;\n        }\n        return { first: first, last: last };\n    };\n    Buffer.prototype.setupTabStops = function (i) {\n        if (i !== null && i !== undefined) {\n            if (!this.tabs[i]) {\n                i = this.prevStop(i);\n            }\n        }\n        else {\n            this.tabs = {};\n            i = 0;\n        }\n        for (; i < this._cols; i += this._terminal.options.tabStopWidth) {\n            this.tabs[i] = true;\n        }\n    };\n    Buffer.prototype.prevStop = function (x) {\n        if (x === null || x === undefined) {\n            x = this.x;\n        }\n        while (!this.tabs[--x] && x > 0)\n            ;\n        return x >= this._cols ? this._cols - 1 : x < 0 ? 0 : x;\n    };\n    Buffer.prototype.nextStop = function (x) {\n        if (x === null || x === undefined) {\n            x = this.x;\n        }\n        while (!this.tabs[++x] && x < this._cols)\n            ;\n        return x >= this._cols ? this._cols - 1 : x < 0 ? 0 : x;\n    };\n    Buffer.prototype.addMarker = function (y) {\n        var _this = this;\n        var marker = new Marker(y);\n        this.markers.push(marker);\n        marker.register(this.lines.onTrim(function (amount) {\n            marker.line -= amount;\n            if (marker.line < 0) {\n                marker.dispose();\n            }\n        }));\n        marker.register(this.lines.onInsert(function (event) {\n            if (marker.line >= event.index) {\n                marker.line += event.amount;\n            }\n        }));\n        marker.register(this.lines.onDelete(function (event) {\n            if (marker.line >= event.index && marker.line < event.index + event.amount) {\n                marker.dispose();\n            }\n            if (marker.line > event.index) {\n                marker.line -= event.amount;\n            }\n        }));\n        marker.register(marker.onDispose(function () { return _this._removeMarker(marker); }));\n        return marker;\n    };\n    Buffer.prototype._removeMarker = function (marker) {\n        this.markers.splice(this.markers.indexOf(marker), 1);\n    };\n    Buffer.prototype.iterator = function (trimRight, startIndex, endIndex, startOverscan, endOverscan) {\n        return new BufferStringIterator(this, trimRight, startIndex, endIndex, startOverscan, endOverscan);\n    };\n    return Buffer;\n}());\nexports.Buffer = Buffer;\nvar Marker = (function (_super) {\n    __extends(Marker, _super);\n    function Marker(line) {\n        var _this = _super.call(this) || this;\n        _this.line = line;\n        _this._id = Marker._nextId++;\n        _this.isDisposed = false;\n        _this._onDispose = new EventEmitter2_1.EventEmitter2();\n        return _this;\n    }\n    Object.defineProperty(Marker.prototype, \"id\", {\n        get: function () { return this._id; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Marker.prototype, \"onDispose\", {\n        get: function () { return this._onDispose.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Marker.prototype.dispose = function () {\n        if (this.isDisposed) {\n            return;\n        }\n        this.isDisposed = true;\n        this._onDispose.fire();\n    };\n    Marker._nextId = 1;\n    return Marker;\n}(Lifecycle_1.Disposable));\nexports.Marker = Marker;\nvar BufferStringIterator = (function () {\n    function BufferStringIterator(_buffer, _trimRight, _startIndex, _endIndex, _startOverscan, _endOverscan) {\n        if (_startIndex === void 0) { _startIndex = 0; }\n        if (_endIndex === void 0) { _endIndex = _buffer.lines.length; }\n        if (_startOverscan === void 0) { _startOverscan = 0; }\n        if (_endOverscan === void 0) { _endOverscan = 0; }\n        this._buffer = _buffer;\n        this._trimRight = _trimRight;\n        this._startIndex = _startIndex;\n        this._endIndex = _endIndex;\n        this._startOverscan = _startOverscan;\n        this._endOverscan = _endOverscan;\n        if (this._startIndex < 0) {\n            this._startIndex = 0;\n        }\n        if (this._endIndex > this._buffer.lines.length) {\n            this._endIndex = this._buffer.lines.length;\n        }\n        this._current = this._startIndex;\n    }\n    BufferStringIterator.prototype.hasNext = function () {\n        return this._current < this._endIndex;\n    };\n    BufferStringIterator.prototype.next = function () {\n        var range = this._buffer.getWrappedRangeForLine(this._current);\n        if (range.first < this._startIndex - this._startOverscan) {\n            range.first = this._startIndex - this._startOverscan;\n        }\n        if (range.last > this._endIndex + this._endOverscan) {\n            range.last = this._endIndex + this._endOverscan;\n        }\n        range.first = Math.max(range.first, 0);\n        range.last = Math.min(range.last, this._buffer.lines.length);\n        var result = '';\n        for (var i = range.first; i <= range.last; ++i) {\n            result += this._buffer.translateBufferLineToString(i, this._trimRight);\n        }\n        this._current = range.last + 1;\n        return { range: range, content: result };\n    };\n    return BufferStringIterator;\n}());\nexports.BufferStringIterator = BufferStringIterator;\n//# sourceMappingURL=Buffer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction addDisposableDomListener(node, type, handler, useCapture) {\n    node.addEventListener(type, handler, useCapture);\n    return {\n        dispose: function () {\n            if (!handler) {\n                return;\n            }\n            node.removeEventListener(type, handler, useCapture);\n        }\n    };\n}\nexports.addDisposableDomListener = addDisposableDomListener;\n//# sourceMappingURL=Lifecycle.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TextRenderLayer_1 = require(\"./TextRenderLayer\");\nvar SelectionRenderLayer_1 = require(\"./SelectionRenderLayer\");\nvar CursorRenderLayer_1 = require(\"./CursorRenderLayer\");\nvar ColorManager_1 = require(\"./ColorManager\");\nvar LinkRenderLayer_1 = require(\"./LinkRenderLayer\");\nvar RenderDebouncer_1 = require(\"../ui/RenderDebouncer\");\nvar ScreenDprMonitor_1 = require(\"../ui/ScreenDprMonitor\");\nvar CharacterJoinerRegistry_1 = require(\"../renderer/CharacterJoinerRegistry\");\nvar EventEmitter2_1 = require(\"../common/EventEmitter2\");\nvar Lifecycle_1 = require(\"../common/Lifecycle\");\nvar Renderer = (function (_super) {\n    __extends(Renderer, _super);\n    function Renderer(_terminal, theme) {\n        var _this = _super.call(this) || this;\n        _this._terminal = _terminal;\n        _this._isPaused = false;\n        _this._needsFullRefresh = false;\n        _this._onCanvasResize = new EventEmitter2_1.EventEmitter2();\n        _this._onRender = new EventEmitter2_1.EventEmitter2();\n        var allowTransparency = _this._terminal.options.allowTransparency;\n        _this.colorManager = new ColorManager_1.ColorManager(document, allowTransparency);\n        _this._characterJoinerRegistry = new CharacterJoinerRegistry_1.CharacterJoinerRegistry(_terminal);\n        if (theme) {\n            _this.colorManager.setTheme(theme);\n        }\n        _this._renderLayers = [\n            new TextRenderLayer_1.TextRenderLayer(_this._terminal.screenElement, 0, _this.colorManager.colors, _this._characterJoinerRegistry, allowTransparency),\n            new SelectionRenderLayer_1.SelectionRenderLayer(_this._terminal.screenElement, 1, _this.colorManager.colors),\n            new LinkRenderLayer_1.LinkRenderLayer(_this._terminal.screenElement, 2, _this.colorManager.colors, _this._terminal),\n            new CursorRenderLayer_1.CursorRenderLayer(_this._terminal.screenElement, 3, _this.colorManager.colors)\n        ];\n        _this.dimensions = {\n            scaledCharWidth: null,\n            scaledCharHeight: null,\n            scaledCellWidth: null,\n            scaledCellHeight: null,\n            scaledCharLeft: null,\n            scaledCharTop: null,\n            scaledCanvasWidth: null,\n            scaledCanvasHeight: null,\n            canvasWidth: null,\n            canvasHeight: null,\n            actualCellWidth: null,\n            actualCellHeight: null\n        };\n        _this._devicePixelRatio = window.devicePixelRatio;\n        _this._updateDimensions();\n        _this.onOptionsChanged();\n        _this._renderDebouncer = new RenderDebouncer_1.RenderDebouncer(_this._renderRows.bind(_this));\n        _this._screenDprMonitor = new ScreenDprMonitor_1.ScreenDprMonitor();\n        _this._screenDprMonitor.setListener(function () { return _this.onWindowResize(window.devicePixelRatio); });\n        _this.register(_this._screenDprMonitor);\n        if ('IntersectionObserver' in window) {\n            var observer_1 = new IntersectionObserver(function (e) { return _this.onIntersectionChange(e[e.length - 1]); }, { threshold: 0 });\n            observer_1.observe(_this._terminal.element);\n            _this.register({ dispose: function () { return observer_1.disconnect(); } });\n        }\n        return _this;\n    }\n    Object.defineProperty(Renderer.prototype, \"onCanvasResize\", {\n        get: function () { return this._onCanvasResize.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"onRender\", {\n        get: function () { return this._onRender.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Renderer.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._renderLayers.forEach(function (l) { return l.dispose(); });\n    };\n    Renderer.prototype.onIntersectionChange = function (entry) {\n        this._isPaused = entry.intersectionRatio === 0;\n        if (!this._isPaused && this._needsFullRefresh) {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n            this._needsFullRefresh = false;\n        }\n    };\n    Renderer.prototype.onWindowResize = function (devicePixelRatio) {\n        if (this._devicePixelRatio !== devicePixelRatio) {\n            this._devicePixelRatio = devicePixelRatio;\n            this.onResize(this._terminal.cols, this._terminal.rows);\n        }\n    };\n    Renderer.prototype.setTheme = function (theme) {\n        var _this = this;\n        this.colorManager.setTheme(theme);\n        this._renderLayers.forEach(function (l) {\n            l.onThemeChanged(_this._terminal, _this.colorManager.colors);\n            l.reset(_this._terminal);\n        });\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n        }\n        return this.colorManager.colors;\n    };\n    Renderer.prototype.onResize = function (cols, rows) {\n        var _this = this;\n        this._updateDimensions();\n        this._renderLayers.forEach(function (l) { return l.resize(_this._terminal, _this.dimensions); });\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._terminal.refresh(0, this._terminal.rows - 1);\n        }\n        this._terminal.screenElement.style.width = this.dimensions.canvasWidth + \"px\";\n        this._terminal.screenElement.style.height = this.dimensions.canvasHeight + \"px\";\n        this._onCanvasResize.fire({\n            width: this.dimensions.canvasWidth,\n            height: this.dimensions.canvasHeight\n        });\n    };\n    Renderer.prototype.onCharSizeChanged = function () {\n        this.onResize(this._terminal.cols, this._terminal.rows);\n    };\n    Renderer.prototype.onBlur = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onBlur(_this._terminal); });\n    };\n    Renderer.prototype.onFocus = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onFocus(_this._terminal); });\n    };\n    Renderer.prototype.onSelectionChanged = function (start, end, columnSelectMode) {\n        var _this = this;\n        if (columnSelectMode === void 0) { columnSelectMode = false; }\n        this._runOperation(function (l) { return l.onSelectionChanged(_this._terminal, start, end, columnSelectMode); });\n    };\n    Renderer.prototype.onCursorMove = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.onCursorMove(_this._terminal); });\n    };\n    Renderer.prototype.onOptionsChanged = function () {\n        var _this = this;\n        this.colorManager.allowTransparency = this._terminal.options.allowTransparency;\n        this._runOperation(function (l) { return l.onOptionsChanged(_this._terminal); });\n    };\n    Renderer.prototype.clear = function () {\n        var _this = this;\n        this._runOperation(function (l) { return l.reset(_this._terminal); });\n    };\n    Renderer.prototype._runOperation = function (operation) {\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n        }\n        else {\n            this._renderLayers.forEach(function (l) { return operation(l); });\n        }\n    };\n    Renderer.prototype.refreshRows = function (start, end) {\n        if (this._isPaused) {\n            this._needsFullRefresh = true;\n            return;\n        }\n        this._renderDebouncer.refresh(start, end, this._terminal.rows);\n    };\n    Renderer.prototype._renderRows = function (start, end) {\n        var _this = this;\n        this._renderLayers.forEach(function (l) { return l.onGridChanged(_this._terminal, start, end); });\n        this._onRender.fire({ start: start, end: end });\n    };\n    Renderer.prototype._updateDimensions = function () {\n        if (!this._terminal.charMeasure.width || !this._terminal.charMeasure.height) {\n            return;\n        }\n        this.dimensions.scaledCharWidth = Math.floor(this._terminal.charMeasure.width * window.devicePixelRatio);\n        this.dimensions.scaledCharHeight = Math.ceil(this._terminal.charMeasure.height * window.devicePixelRatio);\n        this.dimensions.scaledCellHeight = Math.floor(this.dimensions.scaledCharHeight * this._terminal.options.lineHeight);\n        this.dimensions.scaledCharTop = this._terminal.options.lineHeight === 1 ? 0 : Math.round((this.dimensions.scaledCellHeight - this.dimensions.scaledCharHeight) / 2);\n        this.dimensions.scaledCellWidth = this.dimensions.scaledCharWidth + Math.round(this._terminal.options.letterSpacing);\n        this.dimensions.scaledCharLeft = Math.floor(this._terminal.options.letterSpacing / 2);\n        this.dimensions.scaledCanvasHeight = this._terminal.rows * this.dimensions.scaledCellHeight;\n        this.dimensions.scaledCanvasWidth = this._terminal.cols * this.dimensions.scaledCellWidth;\n        this.dimensions.canvasHeight = Math.round(this.dimensions.scaledCanvasHeight / window.devicePixelRatio);\n        this.dimensions.canvasWidth = Math.round(this.dimensions.scaledCanvasWidth / window.devicePixelRatio);\n        this.dimensions.actualCellHeight = this.dimensions.canvasHeight / this._terminal.rows;\n        this.dimensions.actualCellWidth = this.dimensions.canvasWidth / this._terminal.cols;\n    };\n    Renderer.prototype.registerCharacterJoiner = function (handler) {\n        return this._characterJoinerRegistry.registerCharacterJoiner(handler);\n    };\n    Renderer.prototype.deregisterCharacterJoiner = function (joinerId) {\n        return this._characterJoinerRegistry.deregisterCharacterJoiner(joinerId);\n    };\n    return Renderer;\n}(Lifecycle_1.Disposable));\nexports.Renderer = Renderer;\n//# sourceMappingURL=Renderer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EscapeSequences_1 = require(\"../../common/data/EscapeSequences\");\nvar KEYCODE_KEY_MAPPINGS = {\n    48: ['0', ')'],\n    49: ['1', '!'],\n    50: ['2', '@'],\n    51: ['3', '#'],\n    52: ['4', '$'],\n    53: ['5', '%'],\n    54: ['6', '^'],\n    55: ['7', '&'],\n    56: ['8', '*'],\n    57: ['9', '('],\n    186: [';', ':'],\n    187: ['=', '+'],\n    188: [',', '<'],\n    189: ['-', '_'],\n    190: ['.', '>'],\n    191: ['/', '?'],\n    192: ['`', '~'],\n    219: ['[', '{'],\n    220: ['\\\\', '|'],\n    221: [']', '}'],\n    222: ['\\'', '\"']\n};\nfunction evaluateKeyboardEvent(ev, applicationCursorMode, isMac, macOptionIsMeta) {\n    var result = {\n        type: 0,\n        cancel: false,\n        key: undefined\n    };\n    var modifiers = (ev.shiftKey ? 1 : 0) | (ev.altKey ? 2 : 0) | (ev.ctrlKey ? 4 : 0) | (ev.metaKey ? 8 : 0);\n    switch (ev.keyCode) {\n        case 0:\n            if (ev.key === 'UIKeyInputUpArrow') {\n                if (applicationCursorMode) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OA';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[A';\n                }\n            }\n            else if (ev.key === 'UIKeyInputLeftArrow') {\n                if (applicationCursorMode) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OD';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[D';\n                }\n            }\n            else if (ev.key === 'UIKeyInputRightArrow') {\n                if (applicationCursorMode) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OC';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[C';\n                }\n            }\n            else if (ev.key === 'UIKeyInputDownArrow') {\n                if (applicationCursorMode) {\n                    result.key = EscapeSequences_1.C0.ESC + 'OB';\n                }\n                else {\n                    result.key = EscapeSequences_1.C0.ESC + '[B';\n                }\n            }\n            break;\n        case 8:\n            if (ev.shiftKey) {\n                result.key = EscapeSequences_1.C0.BS;\n                break;\n            }\n            else if (ev.altKey) {\n                result.key = EscapeSequences_1.C0.ESC + EscapeSequences_1.C0.DEL;\n                break;\n            }\n            result.key = EscapeSequences_1.C0.DEL;\n            break;\n        case 9:\n            if (ev.shiftKey) {\n                result.key = EscapeSequences_1.C0.ESC + '[Z';\n                break;\n            }\n            result.key = EscapeSequences_1.C0.HT;\n            result.cancel = true;\n            break;\n        case 13:\n            result.key = EscapeSequences_1.C0.CR;\n            result.cancel = true;\n            break;\n        case 27:\n            result.key = EscapeSequences_1.C0.ESC;\n            result.cancel = true;\n            break;\n        case 37:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'D';\n                if (result.key === EscapeSequences_1.C0.ESC + '[1;3D') {\n                    result.key = isMac ? EscapeSequences_1.C0.ESC + 'b' : EscapeSequences_1.C0.ESC + '[1;5D';\n                }\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OD';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[D';\n            }\n            break;\n        case 39:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'C';\n                if (result.key === EscapeSequences_1.C0.ESC + '[1;3C') {\n                    result.key = isMac ? EscapeSequences_1.C0.ESC + 'f' : EscapeSequences_1.C0.ESC + '[1;5C';\n                }\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OC';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[C';\n            }\n            break;\n        case 38:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'A';\n                if (result.key === EscapeSequences_1.C0.ESC + '[1;3A') {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;5A';\n                }\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OA';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[A';\n            }\n            break;\n        case 40:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'B';\n                if (result.key === EscapeSequences_1.C0.ESC + '[1;3B') {\n                    result.key = EscapeSequences_1.C0.ESC + '[1;5B';\n                }\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OB';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[B';\n            }\n            break;\n        case 45:\n            if (!ev.shiftKey && !ev.ctrlKey) {\n                result.key = EscapeSequences_1.C0.ESC + '[2~';\n            }\n            break;\n        case 46:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[3;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[3~';\n            }\n            break;\n        case 36:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'H';\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OH';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[H';\n            }\n            break;\n        case 35:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'F';\n            }\n            else if (applicationCursorMode) {\n                result.key = EscapeSequences_1.C0.ESC + 'OF';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[F';\n            }\n            break;\n        case 33:\n            if (ev.shiftKey) {\n                result.type = 2;\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[5~';\n            }\n            break;\n        case 34:\n            if (ev.shiftKey) {\n                result.type = 3;\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[6~';\n            }\n            break;\n        case 112:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'P';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + 'OP';\n            }\n            break;\n        case 113:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'Q';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + 'OQ';\n            }\n            break;\n        case 114:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'R';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + 'OR';\n            }\n            break;\n        case 115:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[1;' + (modifiers + 1) + 'S';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + 'OS';\n            }\n            break;\n        case 116:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[15;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[15~';\n            }\n            break;\n        case 117:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[17;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[17~';\n            }\n            break;\n        case 118:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[18;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[18~';\n            }\n            break;\n        case 119:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[19;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[19~';\n            }\n            break;\n        case 120:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[20;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[20~';\n            }\n            break;\n        case 121:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[21;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[21~';\n            }\n            break;\n        case 122:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[23;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[23~';\n            }\n            break;\n        case 123:\n            if (modifiers) {\n                result.key = EscapeSequences_1.C0.ESC + '[24;' + (modifiers + 1) + '~';\n            }\n            else {\n                result.key = EscapeSequences_1.C0.ESC + '[24~';\n            }\n            break;\n        default:\n            if (ev.ctrlKey && !ev.shiftKey && !ev.altKey && !ev.metaKey) {\n                if (ev.keyCode >= 65 && ev.keyCode <= 90) {\n                    result.key = String.fromCharCode(ev.keyCode - 64);\n                }\n                else if (ev.keyCode === 32) {\n                    result.key = String.fromCharCode(0);\n                }\n                else if (ev.keyCode >= 51 && ev.keyCode <= 55) {\n                    result.key = String.fromCharCode(ev.keyCode - 51 + 27);\n                }\n                else if (ev.keyCode === 56) {\n                    result.key = String.fromCharCode(127);\n                }\n                else if (ev.keyCode === 219) {\n                    result.key = String.fromCharCode(27);\n                }\n                else if (ev.keyCode === 220) {\n                    result.key = String.fromCharCode(28);\n                }\n                else if (ev.keyCode === 221) {\n                    result.key = String.fromCharCode(29);\n                }\n            }\n            else if ((!isMac || macOptionIsMeta) && ev.altKey && !ev.metaKey) {\n                var keyMapping = KEYCODE_KEY_MAPPINGS[ev.keyCode];\n                var key = keyMapping && keyMapping[!ev.shiftKey ? 0 : 1];\n                if (key) {\n                    result.key = EscapeSequences_1.C0.ESC + key;\n                }\n                else if (ev.keyCode >= 65 && ev.keyCode <= 90) {\n                    var keyCode = ev.ctrlKey ? ev.keyCode - 64 : ev.keyCode + 32;\n                    result.key = EscapeSequences_1.C0.ESC + String.fromCharCode(keyCode);\n                }\n            }\n            else if (isMac && !ev.altKey && !ev.ctrlKey && ev.metaKey) {\n                if (ev.keyCode === 65) {\n                    result.type = 1;\n                }\n            }\n            else if (ev.key && !ev.ctrlKey && !ev.altKey && !ev.metaKey && ev.keyCode >= 48 && ev.key.length === 1) {\n                result.key = ev.key;\n            }\n            else if (ev.key && ev.ctrlKey) {\n                if (ev.key === '_') {\n                    result.key = EscapeSequences_1.C0.US;\n                }\n            }\n            break;\n    }\n    return result;\n}\nexports.evaluateKeyboardEvent = evaluateKeyboardEvent;\n//# sourceMappingURL=Keyboard.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CharAtlasUtils_1 = require(\"./CharAtlasUtils\");\nvar DynamicCharAtlas_1 = require(\"./DynamicCharAtlas\");\nvar NoneCharAtlas_1 = require(\"./NoneCharAtlas\");\nvar StaticCharAtlas_1 = require(\"./StaticCharAtlas\");\nvar charAtlasImplementations = {\n    'none': NoneCharAtlas_1.default,\n    'static': StaticCharAtlas_1.default,\n    'dynamic': DynamicCharAtlas_1.default\n};\nvar charAtlasCache = [];\nfunction acquireCharAtlas(terminal, colors, scaledCharWidth, scaledCharHeight) {\n    var newConfig = CharAtlasUtils_1.generateConfig(scaledCharWidth, scaledCharHeight, terminal, colors);\n    for (var i = 0; i < charAtlasCache.length; i++) {\n        var entry = charAtlasCache[i];\n        var ownedByIndex = entry.ownedBy.indexOf(terminal);\n        if (ownedByIndex >= 0) {\n            if (CharAtlasUtils_1.configEquals(entry.config, newConfig)) {\n                return entry.atlas;\n            }\n            if (entry.ownedBy.length === 1) {\n                entry.atlas.dispose();\n                charAtlasCache.splice(i, 1);\n            }\n            else {\n                entry.ownedBy.splice(ownedByIndex, 1);\n            }\n            break;\n        }\n    }\n    for (var i = 0; i < charAtlasCache.length; i++) {\n        var entry = charAtlasCache[i];\n        if (CharAtlasUtils_1.configEquals(entry.config, newConfig)) {\n            entry.ownedBy.push(terminal);\n            return entry.atlas;\n        }\n    }\n    var newEntry = {\n        atlas: new charAtlasImplementations[terminal.options.experimentalCharAtlas](document, newConfig),\n        config: newConfig,\n        ownedBy: [terminal]\n    };\n    charAtlasCache.push(newEntry);\n    return newEntry.atlas;\n}\nexports.acquireCharAtlas = acquireCharAtlas;\nfunction removeTerminalFromCache(terminal) {\n    for (var i = 0; i < charAtlasCache.length; i++) {\n        var index = charAtlasCache[i].ownedBy.indexOf(terminal);\n        if (index !== -1) {\n            if (charAtlasCache[i].ownedBy.length === 1) {\n                charAtlasCache[i].atlas.dispose();\n                charAtlasCache.splice(i, 1);\n            }\n            else {\n                charAtlasCache[i].ownedBy.splice(index, 1);\n            }\n            break;\n        }\n    }\n}\nexports.removeTerminalFromCache = removeTerminalFromCache;\n//# sourceMappingURL=CharAtlasCache.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DEFAULT_BELL_SOUND = 'data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==';\nvar SoundManager = (function () {\n    function SoundManager(_terminal) {\n        this._terminal = _terminal;\n    }\n    Object.defineProperty(SoundManager, \"audioContext\", {\n        get: function () {\n            if (!SoundManager._audioContext) {\n                var audioContextCtor = window.AudioContext || window.webkitAudioContext;\n                if (!audioContextCtor) {\n                    console.warn('Web Audio API is not supported by this browser. Consider upgrading to the latest version');\n                    return null;\n                }\n                SoundManager._audioContext = new audioContextCtor();\n            }\n            return SoundManager._audioContext;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SoundManager.prototype.playBellSound = function () {\n        var ctx = SoundManager.audioContext;\n        if (!ctx) {\n            return;\n        }\n        var bellAudioSource = ctx.createBufferSource();\n        ctx.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._terminal.options.bellSound)), function (buffer) {\n            bellAudioSource.buffer = buffer;\n            bellAudioSource.connect(ctx.destination);\n            bellAudioSource.start(0);\n        });\n    };\n    SoundManager.prototype._base64ToArrayBuffer = function (base64) {\n        var binaryString = window.atob(base64);\n        var len = binaryString.length;\n        var bytes = new Uint8Array(len);\n        for (var i = 0; i < len; i++) {\n            bytes[i] = binaryString.charCodeAt(i);\n        }\n        return bytes.buffer;\n    };\n    SoundManager.prototype._removeMimeType = function (dataURI) {\n        var splitUri = dataURI.split(',');\n        return splitUri[1];\n    };\n    return SoundManager;\n}());\nexports.SoundManager = SoundManager;\n//# sourceMappingURL=SoundManager.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Types_1 = require(\"./Types\");\nvar BaseCharAtlas_1 = require(\"./BaseCharAtlas\");\nvar ColorManager_1 = require(\"../ColorManager\");\nvar CharAtlasGenerator_1 = require(\"./CharAtlasGenerator\");\nvar LRUMap_1 = require(\"./LRUMap\");\nvar Platform_1 = require(\"../../common/Platform\");\nvar TEXTURE_WIDTH = 1024;\nvar TEXTURE_HEIGHT = 1024;\nvar TRANSPARENT_COLOR = {\n    css: 'rgba(0, 0, 0, 0)',\n    rgba: 0\n};\nvar FRAME_CACHE_DRAW_LIMIT = 100;\nvar GLYPH_BITMAP_COMMIT_DELAY = 100;\nfunction getGlyphCacheKey(glyph) {\n    return glyph.code << 21 | glyph.bg << 12 | glyph.fg << 3 | (glyph.bold ? 0 : 4) + (glyph.dim ? 0 : 2) + (glyph.italic ? 0 : 1);\n}\nexports.getGlyphCacheKey = getGlyphCacheKey;\nvar DynamicCharAtlas = (function (_super) {\n    __extends(DynamicCharAtlas, _super);\n    function DynamicCharAtlas(document, _config) {\n        var _this = _super.call(this) || this;\n        _this._config = _config;\n        _this._drawToCacheCount = 0;\n        _this._glyphsWaitingOnBitmap = [];\n        _this._bitmapCommitTimeout = null;\n        _this._bitmap = null;\n        _this._cacheCanvas = document.createElement('canvas');\n        _this._cacheCanvas.width = TEXTURE_WIDTH;\n        _this._cacheCanvas.height = TEXTURE_HEIGHT;\n        _this._cacheCtx = _this._cacheCanvas.getContext('2d', { alpha: true });\n        var tmpCanvas = document.createElement('canvas');\n        tmpCanvas.width = _this._config.scaledCharWidth;\n        tmpCanvas.height = _this._config.scaledCharHeight;\n        _this._tmpCtx = tmpCanvas.getContext('2d', { alpha: _this._config.allowTransparency });\n        _this._width = Math.floor(TEXTURE_WIDTH / _this._config.scaledCharWidth);\n        _this._height = Math.floor(TEXTURE_HEIGHT / _this._config.scaledCharHeight);\n        var capacity = _this._width * _this._height;\n        _this._cacheMap = new LRUMap_1.default(capacity);\n        _this._cacheMap.prealloc(capacity);\n        return _this;\n    }\n    DynamicCharAtlas.prototype.dispose = function () {\n        if (this._bitmapCommitTimeout !== null) {\n            window.clearTimeout(this._bitmapCommitTimeout);\n            this._bitmapCommitTimeout = null;\n        }\n    };\n    DynamicCharAtlas.prototype.beginFrame = function () {\n        this._drawToCacheCount = 0;\n    };\n    DynamicCharAtlas.prototype.draw = function (ctx, glyph, x, y) {\n        if (glyph.code === 32) {\n            return true;\n        }\n        if (!this._canCache(glyph)) {\n            return false;\n        }\n        var glyphKey = getGlyphCacheKey(glyph);\n        var cacheValue = this._cacheMap.get(glyphKey);\n        if (cacheValue !== null && cacheValue !== undefined) {\n            this._drawFromCache(ctx, cacheValue, x, y);\n            return true;\n        }\n        else if (this._drawToCacheCount < FRAME_CACHE_DRAW_LIMIT) {\n            var index = void 0;\n            if (this._cacheMap.size < this._cacheMap.capacity) {\n                index = this._cacheMap.size;\n            }\n            else {\n                index = this._cacheMap.peek().index;\n            }\n            var cacheValue_1 = this._drawToCache(glyph, index);\n            this._cacheMap.set(glyphKey, cacheValue_1);\n            this._drawFromCache(ctx, cacheValue_1, x, y);\n            return true;\n        }\n        return false;\n    };\n    DynamicCharAtlas.prototype._canCache = function (glyph) {\n        return glyph.code < 256;\n    };\n    DynamicCharAtlas.prototype._toCoordinateX = function (index) {\n        return (index % this._width) * this._config.scaledCharWidth;\n    };\n    DynamicCharAtlas.prototype._toCoordinateY = function (index) {\n        return Math.floor(index / this._width) * this._config.scaledCharHeight;\n    };\n    DynamicCharAtlas.prototype._drawFromCache = function (ctx, cacheValue, x, y) {\n        if (cacheValue.isEmpty) {\n            return;\n        }\n        var cacheX = this._toCoordinateX(cacheValue.index);\n        var cacheY = this._toCoordinateY(cacheValue.index);\n        ctx.drawImage(cacheValue.inBitmap ? this._bitmap : this._cacheCanvas, cacheX, cacheY, this._config.scaledCharWidth, this._config.scaledCharHeight, x, y, this._config.scaledCharWidth, this._config.scaledCharHeight);\n    };\n    DynamicCharAtlas.prototype._getColorFromAnsiIndex = function (idx) {\n        if (idx < this._config.colors.ansi.length) {\n            return this._config.colors.ansi[idx];\n        }\n        return ColorManager_1.DEFAULT_ANSI_COLORS[idx];\n    };\n    DynamicCharAtlas.prototype._getBackgroundColor = function (glyph) {\n        if (this._config.allowTransparency) {\n            return TRANSPARENT_COLOR;\n        }\n        else if (glyph.bg === Types_1.INVERTED_DEFAULT_COLOR) {\n            return this._config.colors.foreground;\n        }\n        else if (glyph.bg < 256) {\n            return this._getColorFromAnsiIndex(glyph.bg);\n        }\n        return this._config.colors.background;\n    };\n    DynamicCharAtlas.prototype._getForegroundColor = function (glyph) {\n        if (glyph.fg === Types_1.INVERTED_DEFAULT_COLOR) {\n            return this._config.colors.background;\n        }\n        else if (glyph.fg < 256) {\n            return this._getColorFromAnsiIndex(glyph.fg);\n        }\n        return this._config.colors.foreground;\n    };\n    DynamicCharAtlas.prototype._drawToCache = function (glyph, index) {\n        this._drawToCacheCount++;\n        this._tmpCtx.save();\n        var backgroundColor = this._getBackgroundColor(glyph);\n        this._tmpCtx.globalCompositeOperation = 'copy';\n        this._tmpCtx.fillStyle = backgroundColor.css;\n        this._tmpCtx.fillRect(0, 0, this._config.scaledCharWidth, this._config.scaledCharHeight);\n        this._tmpCtx.globalCompositeOperation = 'source-over';\n        var fontWeight = glyph.bold ? this._config.fontWeightBold : this._config.fontWeight;\n        var fontStyle = glyph.italic ? 'italic' : '';\n        this._tmpCtx.font =\n            fontStyle + \" \" + fontWeight + \" \" + this._config.fontSize * this._config.devicePixelRatio + \"px \" + this._config.fontFamily;\n        this._tmpCtx.textBaseline = 'middle';\n        this._tmpCtx.fillStyle = this._getForegroundColor(glyph).css;\n        if (glyph.dim) {\n            this._tmpCtx.globalAlpha = Types_1.DIM_OPACITY;\n        }\n        this._tmpCtx.fillText(glyph.chars, 0, this._config.scaledCharHeight / 2);\n        this._tmpCtx.restore();\n        var imageData = this._tmpCtx.getImageData(0, 0, this._config.scaledCharWidth, this._config.scaledCharHeight);\n        var isEmpty = false;\n        if (!this._config.allowTransparency) {\n            isEmpty = CharAtlasGenerator_1.clearColor(imageData, backgroundColor);\n        }\n        var x = this._toCoordinateX(index);\n        var y = this._toCoordinateY(index);\n        this._cacheCtx.putImageData(imageData, x, y);\n        var cacheValue = {\n            index: index,\n            isEmpty: isEmpty,\n            inBitmap: false\n        };\n        this._addGlyphToBitmap(cacheValue);\n        return cacheValue;\n    };\n    DynamicCharAtlas.prototype._addGlyphToBitmap = function (cacheValue) {\n        var _this = this;\n        if (!('createImageBitmap' in window) || Platform_1.isFirefox || Platform_1.isSafari) {\n            return;\n        }\n        this._glyphsWaitingOnBitmap.push(cacheValue);\n        if (this._bitmapCommitTimeout !== null) {\n            return;\n        }\n        this._bitmapCommitTimeout = window.setTimeout(function () { return _this._generateBitmap(); }, GLYPH_BITMAP_COMMIT_DELAY);\n    };\n    DynamicCharAtlas.prototype._generateBitmap = function () {\n        var _this = this;\n        var glyphsMovingToBitmap = this._glyphsWaitingOnBitmap;\n        this._glyphsWaitingOnBitmap = [];\n        window.createImageBitmap(this._cacheCanvas).then(function (bitmap) {\n            _this._bitmap = bitmap;\n            for (var i = 0; i < glyphsMovingToBitmap.length; i++) {\n                var value = glyphsMovingToBitmap[i];\n                value.inBitmap = true;\n            }\n        });\n        this._bitmapCommitTimeout = null;\n    };\n    return DynamicCharAtlas;\n}(BaseCharAtlas_1.default));\nexports.default = DynamicCharAtlas;\n//# sourceMappingURL=DynamicCharAtlas.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Terminal_1 = require(\"../Terminal\");\nvar Strings = require(\"../Strings\");\nvar Terminal = (function () {\n    function Terminal(options) {\n        this._core = new Terminal_1.Terminal(options);\n    }\n    Object.defineProperty(Terminal.prototype, \"onCursorMove\", {\n        get: function () { return this._core.onCursorMove; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onLineFeed\", {\n        get: function () { return this._core.onLineFeed; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onSelectionChange\", {\n        get: function () { return this._core.onSelectionChange; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onData\", {\n        get: function () { return this._core.onData; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onTitleChange\", {\n        get: function () { return this._core.onTitleChange; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onScroll\", {\n        get: function () { return this._core.onScroll; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onKey\", {\n        get: function () { return this._core.onKey; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onRender\", {\n        get: function () { return this._core.onRender; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onResize\", {\n        get: function () { return this._core.onResize; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"element\", {\n        get: function () { return this._core.element; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"textarea\", {\n        get: function () { return this._core.textarea; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"rows\", {\n        get: function () { return this._core.rows; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"cols\", {\n        get: function () { return this._core.cols; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"markers\", {\n        get: function () { return this._core.markers; },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.blur = function () {\n        this._core.blur();\n    };\n    Terminal.prototype.focus = function () {\n        this._core.focus();\n    };\n    Terminal.prototype.on = function (type, listener) {\n        this._core.on(type, listener);\n    };\n    Terminal.prototype.off = function (type, listener) {\n        this._core.off(type, listener);\n    };\n    Terminal.prototype.emit = function (type, data) {\n        this._core.emit(type, data);\n    };\n    Terminal.prototype.addDisposableListener = function (type, handler) {\n        return this._core.addDisposableListener(type, handler);\n    };\n    Terminal.prototype.resize = function (columns, rows) {\n        this._core.resize(columns, rows);\n    };\n    Terminal.prototype.writeln = function (data) {\n        this._core.writeln(data);\n    };\n    Terminal.prototype.open = function (parent) {\n        this._core.open(parent);\n    };\n    Terminal.prototype.attachCustomKeyEventHandler = function (customKeyEventHandler) {\n        this._core.attachCustomKeyEventHandler(customKeyEventHandler);\n    };\n    Terminal.prototype.addCsiHandler = function (flag, callback) {\n        return this._core.addCsiHandler(flag, callback);\n    };\n    Terminal.prototype.addOscHandler = function (ident, callback) {\n        return this._core.addOscHandler(ident, callback);\n    };\n    Terminal.prototype.registerLinkMatcher = function (regex, handler, options) {\n        return this._core.registerLinkMatcher(regex, handler, options);\n    };\n    Terminal.prototype.deregisterLinkMatcher = function (matcherId) {\n        this._core.deregisterLinkMatcher(matcherId);\n    };\n    Terminal.prototype.registerCharacterJoiner = function (handler) {\n        return this._core.registerCharacterJoiner(handler);\n    };\n    Terminal.prototype.deregisterCharacterJoiner = function (joinerId) {\n        this._core.deregisterCharacterJoiner(joinerId);\n    };\n    Terminal.prototype.addMarker = function (cursorYOffset) {\n        return this._core.addMarker(cursorYOffset);\n    };\n    Terminal.prototype.hasSelection = function () {\n        return this._core.hasSelection();\n    };\n    Terminal.prototype.getSelection = function () {\n        return this._core.getSelection();\n    };\n    Terminal.prototype.clearSelection = function () {\n        this._core.clearSelection();\n    };\n    Terminal.prototype.selectAll = function () {\n        this._core.selectAll();\n    };\n    Terminal.prototype.selectLines = function (start, end) {\n        this._core.selectLines(start, end);\n    };\n    Terminal.prototype.dispose = function () {\n        this._core.dispose();\n    };\n    Terminal.prototype.destroy = function () {\n        this._core.destroy();\n    };\n    Terminal.prototype.scrollLines = function (amount) {\n        this._core.scrollLines(amount);\n    };\n    Terminal.prototype.scrollPages = function (pageCount) {\n        this._core.scrollPages(pageCount);\n    };\n    Terminal.prototype.scrollToTop = function () {\n        this._core.scrollToTop();\n    };\n    Terminal.prototype.scrollToBottom = function () {\n        this._core.scrollToBottom();\n    };\n    Terminal.prototype.scrollToLine = function (line) {\n        this._core.scrollToLine(line);\n    };\n    Terminal.prototype.clear = function () {\n        this._core.clear();\n    };\n    Terminal.prototype.write = function (data) {\n        this._core.write(data);\n    };\n    Terminal.prototype.getOption = function (key) {\n        return this._core.getOption(key);\n    };\n    Terminal.prototype.setOption = function (key, value) {\n        this._core.setOption(key, value);\n    };\n    Terminal.prototype.refresh = function (start, end) {\n        this._core.refresh(start, end);\n    };\n    Terminal.prototype.reset = function () {\n        this._core.reset();\n    };\n    Terminal.applyAddon = function (addon) {\n        addon.apply(Terminal);\n    };\n    Object.defineProperty(Terminal, \"strings\", {\n        get: function () {\n            return Strings;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Terminal;\n}());\nexports.Terminal = Terminal;\n//# sourceMappingURL=Terminal.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction fill(array, value, start, end) {\n    if (array.fill) {\n        return array.fill(value, start, end);\n    }\n    return fillFallback(array, value, start, end);\n}\nexports.fill = fill;\nfunction fillFallback(array, value, start, end) {\n    if (start === void 0) { start = 0; }\n    if (end === void 0) { end = array.length; }\n    if (start >= array.length) {\n        return array;\n    }\n    start = (array.length + start) % array.length;\n    if (end >= array.length) {\n        end = array.length;\n    }\n    else {\n        end = (array.length + end) % array.length;\n    }\n    for (var i = start; i < end; ++i) {\n        array[i] = value;\n    }\n    return array;\n}\nexports.fillFallback = fillFallback;\nfunction concat(a, b) {\n    var result = new a.constructor(a.length + b.length);\n    result.set(a);\n    result.set(b, a.length);\n    return result;\n}\nexports.concat = concat;\n//# sourceMappingURL=TypedArrayUtils.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar C0;\n(function (C0) {\n    C0.NUL = '\\x00';\n    C0.SOH = '\\x01';\n    C0.STX = '\\x02';\n    C0.ETX = '\\x03';\n    C0.EOT = '\\x04';\n    C0.ENQ = '\\x05';\n    C0.ACK = '\\x06';\n    C0.BEL = '\\x07';\n    C0.BS = '\\x08';\n    C0.HT = '\\x09';\n    C0.LF = '\\x0a';\n    C0.VT = '\\x0b';\n    C0.FF = '\\x0c';\n    C0.CR = '\\x0d';\n    C0.SO = '\\x0e';\n    C0.SI = '\\x0f';\n    C0.DLE = '\\x10';\n    C0.DC1 = '\\x11';\n    C0.DC2 = '\\x12';\n    C0.DC3 = '\\x13';\n    C0.DC4 = '\\x14';\n    C0.NAK = '\\x15';\n    C0.SYN = '\\x16';\n    C0.ETB = '\\x17';\n    C0.CAN = '\\x18';\n    C0.EM = '\\x19';\n    C0.SUB = '\\x1a';\n    C0.ESC = '\\x1b';\n    C0.FS = '\\x1c';\n    C0.GS = '\\x1d';\n    C0.RS = '\\x1e';\n    C0.US = '\\x1f';\n    C0.SP = '\\x20';\n    C0.DEL = '\\x7f';\n})(C0 = exports.C0 || (exports.C0 = {}));\nvar C1;\n(function (C1) {\n    C1.PAD = '\\x80';\n    C1.HOP = '\\x81';\n    C1.BPH = '\\x82';\n    C1.NBH = '\\x83';\n    C1.IND = '\\x84';\n    C1.NEL = '\\x85';\n    C1.SSA = '\\x86';\n    C1.ESA = '\\x87';\n    C1.HTS = '\\x88';\n    C1.HTJ = '\\x89';\n    C1.VTS = '\\x8a';\n    C1.PLD = '\\x8b';\n    C1.PLU = '\\x8c';\n    C1.RI = '\\x8d';\n    C1.SS2 = '\\x8e';\n    C1.SS3 = '\\x8f';\n    C1.DCS = '\\x90';\n    C1.PU1 = '\\x91';\n    C1.PU2 = '\\x92';\n    C1.STS = '\\x93';\n    C1.CCH = '\\x94';\n    C1.MW = '\\x95';\n    C1.SPA = '\\x96';\n    C1.EPA = '\\x97';\n    C1.SOS = '\\x98';\n    C1.SGCI = '\\x99';\n    C1.SCI = '\\x9a';\n    C1.CSI = '\\x9b';\n    C1.ST = '\\x9c';\n    C1.OSC = '\\x9d';\n    C1.PM = '\\x9e';\n    C1.APC = '\\x9f';\n})(C1 = exports.C1 || (exports.C1 = {}));\n//# sourceMappingURL=EscapeSequences.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar StringToUtf32 = (function () {\n    function StringToUtf32() {\n        this._interim = 0;\n    }\n    StringToUtf32.prototype.clear = function () {\n        this._interim = 0;\n    };\n    StringToUtf32.prototype.decode = function (input, target) {\n        var length = input.length;\n        if (!length) {\n            return 0;\n        }\n        var size = 0;\n        var startPos = 0;\n        if (this._interim) {\n            var second = input.charCodeAt(startPos++);\n            if (0xDC00 <= second && second <= 0xDFFF) {\n                target[size++] = (this._interim - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n            }\n            else {\n                target[size++] = this._interim;\n                target[size++] = second;\n            }\n            this._interim = 0;\n        }\n        for (var i = startPos; i < length; ++i) {\n            var code = input.charCodeAt(i);\n            if (0xD800 <= code && code <= 0xDBFF) {\n                if (++i >= length) {\n                    this._interim = code;\n                    return size;\n                }\n                var second = input.charCodeAt(i);\n                if (0xDC00 <= second && second <= 0xDFFF) {\n                    target[size++] = (code - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n                }\n                else {\n                    target[size++] = code;\n                    target[size++] = second;\n                }\n                continue;\n            }\n            target[size++] = code;\n        }\n        return size;\n    };\n    return StringToUtf32;\n}());\nexports.StringToUtf32 = StringToUtf32;\nfunction stringFromCodePoint(codePoint) {\n    if (codePoint > 0xFFFF) {\n        codePoint -= 0x10000;\n        return String.fromCharCode((codePoint >> 10) + 0xD800) + String.fromCharCode((codePoint % 0x400) + 0xDC00);\n    }\n    return String.fromCharCode(codePoint);\n}\nexports.stringFromCodePoint = stringFromCodePoint;\nfunction utf32ToString(data, start, end) {\n    if (start === void 0) { start = 0; }\n    if (end === void 0) { end = data.length; }\n    var result = '';\n    for (var i = start; i < end; ++i) {\n        var codepoint = data[i];\n        if (codepoint > 0xFFFF) {\n            codepoint -= 0x10000;\n            result += String.fromCharCode((codepoint >> 10) + 0xD800) + String.fromCharCode((codepoint % 0x400) + 0xDC00);\n        }\n        else {\n            result += String.fromCharCode(codepoint);\n        }\n    }\n    return result;\n}\nexports.utf32ToString = utf32ToString;\n//# sourceMappingURL=TextDecoder.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseCharAtlas_1 = require(\"./BaseCharAtlas\");\nvar NoneCharAtlas = (function (_super) {\n    __extends(NoneCharAtlas, _super);\n    function NoneCharAtlas(document, config) {\n        return _super.call(this) || this;\n    }\n    NoneCharAtlas.prototype.draw = function (ctx, glyph, x, y) {\n        return false;\n    };\n    return NoneCharAtlas;\n}(BaseCharAtlas_1.default));\nexports.default = NoneCharAtlas;\n//# sourceMappingURL=NoneCharAtlas.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseCharAtlas = (function () {\n    function BaseCharAtlas() {\n        this._didWarmUp = false;\n    }\n    BaseCharAtlas.prototype.dispose = function () { };\n    BaseCharAtlas.prototype.warmUp = function () {\n        if (!this._didWarmUp) {\n            this._doWarmUp();\n            this._didWarmUp = true;\n        }\n    };\n    BaseCharAtlas.prototype._doWarmUp = function () { };\n    BaseCharAtlas.prototype.beginFrame = function () { };\n    return BaseCharAtlas;\n}());\nexports.default = BaseCharAtlas;\n//# sourceMappingURL=BaseCharAtlas.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.blankLine = 'Blank line';\nexports.promptLabel = 'Terminal input';\nexports.tooMuchOutput = 'Too much output to announce, navigate to rows manually to read';\n//# sourceMappingURL=Strings.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Buffer_1 = require(\"../Buffer\");\nvar GridCache_1 = require(\"./GridCache\");\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar BufferLine_1 = require(\"../BufferLine\");\nvar CharacterJoinerRegistry_1 = require(\"./CharacterJoinerRegistry\");\nvar TextRenderLayer = (function (_super) {\n    __extends(TextRenderLayer, _super);\n    function TextRenderLayer(container, zIndex, colors, characterJoinerRegistry, alpha) {\n        var _this = _super.call(this, container, 'text', zIndex, alpha, colors) || this;\n        _this._characterOverlapCache = {};\n        _this._workCell = new BufferLine_1.CellData();\n        _this._state = new GridCache_1.GridCache();\n        _this._characterJoinerRegistry = characterJoinerRegistry;\n        return _this;\n    }\n    TextRenderLayer.prototype.resize = function (terminal, dim) {\n        _super.prototype.resize.call(this, terminal, dim);\n        var terminalFont = this._getFont(terminal, false, false);\n        if (this._characterWidth !== dim.scaledCharWidth || this._characterFont !== terminalFont) {\n            this._characterWidth = dim.scaledCharWidth;\n            this._characterFont = terminalFont;\n            this._characterOverlapCache = {};\n        }\n        this._state.clear();\n        this._state.resize(terminal.cols, terminal.rows);\n    };\n    TextRenderLayer.prototype.reset = function (terminal) {\n        this._state.clear();\n        this.clearAll();\n    };\n    TextRenderLayer.prototype._forEachCell = function (terminal, firstRow, lastRow, joinerRegistry, callback) {\n        for (var y = firstRow; y <= lastRow; y++) {\n            var row = y + terminal.buffer.ydisp;\n            var line = terminal.buffer.lines.get(row);\n            var joinedRanges = joinerRegistry ? joinerRegistry.getJoinedCharacters(row) : [];\n            for (var x = 0; x < terminal.cols; x++) {\n                line.loadCell(x, this._workCell);\n                var cell = this._workCell;\n                var isJoined = false;\n                var lastCharX = x;\n                if (cell.getWidth() === 0) {\n                    continue;\n                }\n                if (joinedRanges.length > 0 && x === joinedRanges[0][0]) {\n                    isJoined = true;\n                    var range = joinedRanges.shift();\n                    cell = new CharacterJoinerRegistry_1.JoinedCellData(this._workCell, line.translateToString(true, range[0], range[1]), range[1] - range[0]);\n                    lastCharX = range[1] - 1;\n                }\n                if (!isJoined && this._isOverlapping(cell)) {\n                    if (lastCharX < line.length - 1 && line.getCodePoint(lastCharX + 1) === Buffer_1.NULL_CELL_CODE) {\n                        cell.content &= ~12582912;\n                        cell.content |= 2 << 22;\n                    }\n                }\n                callback(cell, x, y);\n                x = lastCharX;\n            }\n        }\n    };\n    TextRenderLayer.prototype._drawBackground = function (terminal, firstRow, lastRow) {\n        var _this = this;\n        var ctx = this._ctx;\n        var cols = terminal.cols;\n        var startX = 0;\n        var startY = 0;\n        var prevFillStyle = null;\n        ctx.save();\n        this._forEachCell(terminal, firstRow, lastRow, null, function (cell, x, y) {\n            var nextFillStyle = null;\n            if (cell.isInverse()) {\n                if (cell.isFgDefault()) {\n                    nextFillStyle = _this._colors.foreground.css;\n                }\n                else if (cell.isFgRGB()) {\n                    nextFillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getFgColor()).join(',') + \")\";\n                }\n                else {\n                    nextFillStyle = _this._colors.ansi[cell.getFgColor()].css;\n                }\n            }\n            else if (cell.isBgRGB()) {\n                nextFillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getBgColor()).join(',') + \")\";\n            }\n            else if (cell.isBgPalette()) {\n                nextFillStyle = _this._colors.ansi[cell.getBgColor()].css;\n            }\n            if (prevFillStyle === null) {\n                startX = x;\n                startY = y;\n            }\n            if (y !== startY) {\n                ctx.fillStyle = prevFillStyle;\n                _this.fillCells(startX, startY, cols - startX, 1);\n                startX = x;\n                startY = y;\n            }\n            else if (prevFillStyle !== nextFillStyle) {\n                ctx.fillStyle = prevFillStyle;\n                _this.fillCells(startX, startY, x - startX, 1);\n                startX = x;\n                startY = y;\n            }\n            prevFillStyle = nextFillStyle;\n        });\n        if (prevFillStyle !== null) {\n            ctx.fillStyle = prevFillStyle;\n            this.fillCells(startX, startY, cols - startX, 1);\n        }\n        ctx.restore();\n    };\n    TextRenderLayer.prototype._drawForeground = function (terminal, firstRow, lastRow) {\n        var _this = this;\n        this._forEachCell(terminal, firstRow, lastRow, this._characterJoinerRegistry, function (cell, x, y) {\n            if (cell.isInvisible()) {\n                return;\n            }\n            if (cell.isUnderline()) {\n                _this._ctx.save();\n                if (cell.isInverse()) {\n                    if (cell.isBgDefault()) {\n                        _this._ctx.fillStyle = _this._colors.background.css;\n                    }\n                    else if (cell.isBgRGB()) {\n                        _this._ctx.fillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getBgColor()).join(',') + \")\";\n                    }\n                    else {\n                        _this._ctx.fillStyle = _this._colors.ansi[cell.getBgColor()].css;\n                    }\n                }\n                else {\n                    if (cell.isFgDefault()) {\n                        _this._ctx.fillStyle = _this._colors.foreground.css;\n                    }\n                    else if (cell.isFgRGB()) {\n                        _this._ctx.fillStyle = \"rgb(\" + BufferLine_1.AttributeData.toColorRGB(cell.getFgColor()).join(',') + \")\";\n                    }\n                    else {\n                        var fg = cell.getFgColor();\n                        if (terminal.options.drawBoldTextInBrightColors && cell.isBold() && fg < 8) {\n                            fg += 8;\n                        }\n                        _this._ctx.fillStyle = _this._colors.ansi[fg].css;\n                    }\n                }\n                _this.fillBottomLineAtCells(x, y, cell.getWidth());\n                _this._ctx.restore();\n            }\n            _this.drawChars(terminal, cell, x, y);\n        });\n    };\n    TextRenderLayer.prototype.onGridChanged = function (terminal, firstRow, lastRow) {\n        if (this._state.cache.length === 0) {\n            return;\n        }\n        if (this._charAtlas) {\n            this._charAtlas.beginFrame();\n        }\n        this.clearCells(0, firstRow, terminal.cols, lastRow - firstRow + 1);\n        this._drawBackground(terminal, firstRow, lastRow);\n        this._drawForeground(terminal, firstRow, lastRow);\n    };\n    TextRenderLayer.prototype.onOptionsChanged = function (terminal) {\n        this.setTransparency(terminal, terminal.options.allowTransparency);\n    };\n    TextRenderLayer.prototype._isOverlapping = function (cell) {\n        if (cell.getWidth() !== 1) {\n            return false;\n        }\n        if (cell.getCode() < 256) {\n            return false;\n        }\n        var chars = cell.getChars();\n        if (this._characterOverlapCache.hasOwnProperty(chars)) {\n            return this._characterOverlapCache[chars];\n        }\n        this._ctx.save();\n        this._ctx.font = this._characterFont;\n        var overlaps = Math.floor(this._ctx.measureText(chars).width) > this._characterWidth;\n        this._ctx.restore();\n        this._characterOverlapCache[chars] = overlaps;\n        return overlaps;\n    };\n    return TextRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.TextRenderLayer = TextRenderLayer;\n//# sourceMappingURL=TextRenderLayer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Lifecycle_1 = require(\"./Lifecycle\");\nvar EventEmitter = (function (_super) {\n    __extends(EventEmitter, _super);\n    function EventEmitter() {\n        var _this = _super.call(this) || this;\n        _this._events = _this._events || {};\n        return _this;\n    }\n    EventEmitter.prototype.on = function (type, listener) {\n        this._events[type] = this._events[type] || [];\n        this._events[type].push(listener);\n    };\n    EventEmitter.prototype.addDisposableListener = function (type, handler) {\n        var _this = this;\n        this.on(type, handler);\n        var disposed = false;\n        return {\n            dispose: function () {\n                if (disposed) {\n                    return;\n                }\n                _this.off(type, handler);\n                disposed = true;\n            }\n        };\n    };\n    EventEmitter.prototype.off = function (type, listener) {\n        if (!this._events[type]) {\n            return;\n        }\n        var obj = this._events[type];\n        var i = obj.length;\n        while (i--) {\n            if (obj[i] === listener) {\n                obj.splice(i, 1);\n                return;\n            }\n        }\n    };\n    EventEmitter.prototype.removeAllListeners = function (type) {\n        if (this._events[type]) {\n            delete this._events[type];\n        }\n    };\n    EventEmitter.prototype.emit = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!this._events[type]) {\n            return;\n        }\n        var obj = this._events[type];\n        for (var i = 0; i < obj.length; i++) {\n            obj[i].apply(this, args);\n        }\n    };\n    EventEmitter.prototype.emitMayRemoveListeners = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!this._events[type]) {\n            return;\n        }\n        var obj = this._events[type];\n        var length = obj.length;\n        for (var i = 0; i < obj.length; i++) {\n            obj[i].apply(this, args);\n            i -= length - obj.length;\n            length = obj.length;\n        }\n    };\n    EventEmitter.prototype.listeners = function (type) {\n        return this._events[type] || [];\n    };\n    EventEmitter.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this._events = {};\n    };\n    return EventEmitter;\n}(Lifecycle_1.Disposable));\nexports.EventEmitter = EventEmitter;\n//# sourceMappingURL=EventEmitter.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MouseHelper_1 = require(\"./MouseHelper\");\nvar Browser = require(\"./common/Platform\");\nvar SelectionModel_1 = require(\"./SelectionModel\");\nvar AltClickHandler_1 = require(\"./handlers/AltClickHandler\");\nvar BufferLine_1 = require(\"./BufferLine\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar DRAG_SCROLL_MAX_THRESHOLD = 50;\nvar DRAG_SCROLL_MAX_SPEED = 15;\nvar DRAG_SCROLL_INTERVAL = 50;\nvar ALT_CLICK_MOVE_CURSOR_TIME = 500;\nvar WORD_SEPARATORS = ' ()[]{}\\'\"';\nvar NON_BREAKING_SPACE_CHAR = String.fromCharCode(160);\nvar ALL_NON_BREAKING_SPACE_REGEX = new RegExp(NON_BREAKING_SPACE_CHAR, 'g');\nvar SelectionManager = (function () {\n    function SelectionManager(_terminal, _charMeasure) {\n        this._terminal = _terminal;\n        this._charMeasure = _charMeasure;\n        this._enabled = true;\n        this._workCell = new BufferLine_1.CellData();\n        this._onLinuxMouseSelection = new EventEmitter2_1.EventEmitter2();\n        this._onRedrawRequest = new EventEmitter2_1.EventEmitter2();\n        this._onSelectionChange = new EventEmitter2_1.EventEmitter2();\n        this._initListeners();\n        this.enable();\n        this._model = new SelectionModel_1.SelectionModel(_terminal);\n        this._activeSelectionMode = 0;\n    }\n    Object.defineProperty(SelectionManager.prototype, \"onLinuxMouseSelection\", {\n        get: function () { return this._onLinuxMouseSelection.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"onRedrawRequest\", {\n        get: function () { return this._onRedrawRequest.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"onSelectionChange\", {\n        get: function () { return this._onSelectionChange.event; },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionManager.prototype.dispose = function () {\n        this._removeMouseDownListeners();\n    };\n    Object.defineProperty(SelectionManager.prototype, \"_buffer\", {\n        get: function () {\n            return this._terminal.buffers.active;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionManager.prototype._initListeners = function () {\n        var _this = this;\n        this._mouseMoveListener = function (event) { return _this._onMouseMove(event); };\n        this._mouseUpListener = function (event) { return _this._onMouseUp(event); };\n        this.initBuffersListeners();\n    };\n    SelectionManager.prototype.initBuffersListeners = function () {\n        var _this = this;\n        this._trimListener = this._terminal.buffer.lines.onTrim(function (amount) { return _this._onTrim(amount); });\n        this._terminal.buffers.onBufferActivate(function (e) { return _this._onBufferActivate(e); });\n    };\n    SelectionManager.prototype.disable = function () {\n        this.clearSelection();\n        this._enabled = false;\n    };\n    SelectionManager.prototype.enable = function () {\n        this._enabled = true;\n    };\n    Object.defineProperty(SelectionManager.prototype, \"selectionStart\", {\n        get: function () { return this._model.finalSelectionStart; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"selectionEnd\", {\n        get: function () { return this._model.finalSelectionEnd; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"hasSelection\", {\n        get: function () {\n            var start = this._model.finalSelectionStart;\n            var end = this._model.finalSelectionEnd;\n            if (!start || !end) {\n                return false;\n            }\n            return start[0] !== end[0] || start[1] !== end[1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionManager.prototype, \"selectionText\", {\n        get: function () {\n            var start = this._model.finalSelectionStart;\n            var end = this._model.finalSelectionEnd;\n            if (!start || !end) {\n                return '';\n            }\n            var result = [];\n            if (this._activeSelectionMode === 3) {\n                if (start[0] === end[0]) {\n                    return '';\n                }\n                for (var i = start[1]; i <= end[1]; i++) {\n                    var lineText = this._buffer.translateBufferLineToString(i, true, start[0], end[0]);\n                    result.push(lineText);\n                }\n            }\n            else {\n                var startRowEndCol = start[1] === end[1] ? end[0] : undefined;\n                result.push(this._buffer.translateBufferLineToString(start[1], true, start[0], startRowEndCol));\n                for (var i = start[1] + 1; i <= end[1] - 1; i++) {\n                    var bufferLine = this._buffer.lines.get(i);\n                    var lineText = this._buffer.translateBufferLineToString(i, true);\n                    if (bufferLine.isWrapped) {\n                        result[result.length - 1] += lineText;\n                    }\n                    else {\n                        result.push(lineText);\n                    }\n                }\n                if (start[1] !== end[1]) {\n                    var bufferLine = this._buffer.lines.get(end[1]);\n                    var lineText = this._buffer.translateBufferLineToString(end[1], true, 0, end[0]);\n                    if (bufferLine.isWrapped) {\n                        result[result.length - 1] += lineText;\n                    }\n                    else {\n                        result.push(lineText);\n                    }\n                }\n            }\n            var formattedResult = result.map(function (line) {\n                return line.replace(ALL_NON_BREAKING_SPACE_REGEX, ' ');\n            }).join(Browser.isMSWindows ? '\\r\\n' : '\\n');\n            return formattedResult;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionManager.prototype.clearSelection = function () {\n        this._model.clearSelection();\n        this._removeMouseDownListeners();\n        this.refresh();\n    };\n    SelectionManager.prototype.refresh = function (isLinuxMouseSelection) {\n        var _this = this;\n        if (!this._refreshAnimationFrame) {\n            this._refreshAnimationFrame = window.requestAnimationFrame(function () { return _this._refresh(); });\n        }\n        if (Browser.isLinux && isLinuxMouseSelection) {\n            var selectionText = this.selectionText;\n            if (selectionText.length) {\n                this._onLinuxMouseSelection.fire(this.selectionText);\n            }\n        }\n    };\n    SelectionManager.prototype._refresh = function () {\n        this._refreshAnimationFrame = null;\n        this._onRedrawRequest.fire({\n            start: this._model.finalSelectionStart,\n            end: this._model.finalSelectionEnd,\n            columnSelectMode: this._activeSelectionMode === 3\n        });\n    };\n    SelectionManager.prototype.isClickInSelection = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        var start = this._model.finalSelectionStart;\n        var end = this._model.finalSelectionEnd;\n        if (!start || !end) {\n            return false;\n        }\n        return this._areCoordsInSelection(coords, start, end);\n    };\n    SelectionManager.prototype._areCoordsInSelection = function (coords, start, end) {\n        return (coords[1] > start[1] && coords[1] < end[1]) ||\n            (start[1] === end[1] && coords[1] === start[1] && coords[0] >= start[0] && coords[0] < end[0]) ||\n            (start[1] < end[1] && coords[1] === end[1] && coords[0] < end[0]) ||\n            (start[1] < end[1] && coords[1] === start[1] && coords[0] >= start[0]);\n    };\n    SelectionManager.prototype.selectWordAtCursor = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        if (coords) {\n            this._selectWordAt(coords, false);\n            this._model.selectionEnd = null;\n            this.refresh(true);\n        }\n    };\n    SelectionManager.prototype.selectAll = function () {\n        this._model.isSelectAllActive = true;\n        this.refresh();\n        this._onSelectionChange.fire();\n    };\n    SelectionManager.prototype.selectLines = function (start, end) {\n        this._model.clearSelection();\n        start = Math.max(start, 0);\n        end = Math.min(end, this._terminal.buffer.lines.length - 1);\n        this._model.selectionStart = [0, start];\n        this._model.selectionEnd = [this._terminal.cols, end];\n        this.refresh();\n        this._onSelectionChange.fire();\n    };\n    SelectionManager.prototype._onTrim = function (amount) {\n        var needsRefresh = this._model.onTrim(amount);\n        if (needsRefresh) {\n            this.refresh();\n        }\n    };\n    SelectionManager.prototype._getMouseBufferCoords = function (event) {\n        var coords = this._terminal.mouseHelper.getCoords(event, this._terminal.screenElement, this._charMeasure, this._terminal.cols, this._terminal.rows, true);\n        if (!coords) {\n            return null;\n        }\n        coords[0]--;\n        coords[1]--;\n        coords[1] += this._terminal.buffer.ydisp;\n        return coords;\n    };\n    SelectionManager.prototype._getMouseEventScrollAmount = function (event) {\n        var offset = MouseHelper_1.MouseHelper.getCoordsRelativeToElement(event, this._terminal.screenElement)[1];\n        var terminalHeight = this._terminal.rows * Math.ceil(this._charMeasure.height * this._terminal.options.lineHeight);\n        if (offset >= 0 && offset <= terminalHeight) {\n            return 0;\n        }\n        if (offset > terminalHeight) {\n            offset -= terminalHeight;\n        }\n        offset = Math.min(Math.max(offset, -DRAG_SCROLL_MAX_THRESHOLD), DRAG_SCROLL_MAX_THRESHOLD);\n        offset /= DRAG_SCROLL_MAX_THRESHOLD;\n        return (offset / Math.abs(offset)) + Math.round(offset * (DRAG_SCROLL_MAX_SPEED - 1));\n    };\n    SelectionManager.prototype.shouldForceSelection = function (event) {\n        if (Browser.isMac) {\n            return event.altKey && this._terminal.options.macOptionClickForcesSelection;\n        }\n        return event.shiftKey;\n    };\n    SelectionManager.prototype.onMouseDown = function (event) {\n        this._mouseDownTimeStamp = event.timeStamp;\n        if (event.button === 2 && this.hasSelection) {\n            return;\n        }\n        if (event.button !== 0) {\n            return;\n        }\n        if (!this._enabled) {\n            if (!this.shouldForceSelection(event)) {\n                return;\n            }\n            event.stopPropagation();\n        }\n        event.preventDefault();\n        this._dragScrollAmount = 0;\n        if (this._enabled && event.shiftKey) {\n            this._onIncrementalClick(event);\n        }\n        else {\n            if (event.detail === 1) {\n                this._onSingleClick(event);\n            }\n            else if (event.detail === 2) {\n                this._onDoubleClick(event);\n            }\n            else if (event.detail === 3) {\n                this._onTripleClick(event);\n            }\n        }\n        this._addMouseDownListeners();\n        this.refresh(true);\n    };\n    SelectionManager.prototype._addMouseDownListeners = function () {\n        var _this = this;\n        this._terminal.element.ownerDocument.addEventListener('mousemove', this._mouseMoveListener);\n        this._terminal.element.ownerDocument.addEventListener('mouseup', this._mouseUpListener);\n        this._dragScrollIntervalTimer = setInterval(function () { return _this._dragScroll(); }, DRAG_SCROLL_INTERVAL);\n    };\n    SelectionManager.prototype._removeMouseDownListeners = function () {\n        if (this._terminal.element.ownerDocument) {\n            this._terminal.element.ownerDocument.removeEventListener('mousemove', this._mouseMoveListener);\n            this._terminal.element.ownerDocument.removeEventListener('mouseup', this._mouseUpListener);\n        }\n        clearInterval(this._dragScrollIntervalTimer);\n        this._dragScrollIntervalTimer = null;\n    };\n    SelectionManager.prototype._onIncrementalClick = function (event) {\n        if (this._model.selectionStart) {\n            this._model.selectionEnd = this._getMouseBufferCoords(event);\n        }\n    };\n    SelectionManager.prototype._onSingleClick = function (event) {\n        this._model.selectionStartLength = 0;\n        this._model.isSelectAllActive = false;\n        this._activeSelectionMode = this.shouldColumnSelect(event) ? 3 : 0;\n        this._model.selectionStart = this._getMouseBufferCoords(event);\n        if (!this._model.selectionStart) {\n            return;\n        }\n        this._model.selectionEnd = null;\n        var line = this._buffer.lines.get(this._model.selectionStart[1]);\n        if (!line) {\n            return;\n        }\n        if (line.length >= this._model.selectionStart[0]) {\n            return;\n        }\n        if (line.hasWidth(this._model.selectionStart[0]) === 0) {\n            this._model.selectionStart[0]++;\n        }\n    };\n    SelectionManager.prototype._onDoubleClick = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        if (coords) {\n            this._activeSelectionMode = 1;\n            this._selectWordAt(coords, true);\n        }\n    };\n    SelectionManager.prototype._onTripleClick = function (event) {\n        var coords = this._getMouseBufferCoords(event);\n        if (coords) {\n            this._activeSelectionMode = 2;\n            this._selectLineAt(coords[1]);\n        }\n    };\n    SelectionManager.prototype.shouldColumnSelect = function (event) {\n        return event.altKey && !(Browser.isMac && this._terminal.options.macOptionClickForcesSelection);\n    };\n    SelectionManager.prototype._onMouseMove = function (event) {\n        event.stopImmediatePropagation();\n        var previousSelectionEnd = this._model.selectionEnd ? [this._model.selectionEnd[0], this._model.selectionEnd[1]] : null;\n        this._model.selectionEnd = this._getMouseBufferCoords(event);\n        if (!this._model.selectionEnd) {\n            this.refresh(true);\n            return;\n        }\n        if (this._activeSelectionMode === 2) {\n            if (this._model.selectionEnd[1] < this._model.selectionStart[1]) {\n                this._model.selectionEnd[0] = 0;\n            }\n            else {\n                this._model.selectionEnd[0] = this._terminal.cols;\n            }\n        }\n        else if (this._activeSelectionMode === 1) {\n            this._selectToWordAt(this._model.selectionEnd);\n        }\n        this._dragScrollAmount = this._getMouseEventScrollAmount(event);\n        if (this._activeSelectionMode !== 3) {\n            if (this._dragScrollAmount > 0) {\n                this._model.selectionEnd[0] = this._terminal.cols;\n            }\n            else if (this._dragScrollAmount < 0) {\n                this._model.selectionEnd[0] = 0;\n            }\n        }\n        if (this._model.selectionEnd[1] < this._buffer.lines.length) {\n            if (this._buffer.lines.get(this._model.selectionEnd[1]).hasWidth(this._model.selectionEnd[0]) === 0) {\n                this._model.selectionEnd[0]++;\n            }\n        }\n        if (!previousSelectionEnd ||\n            previousSelectionEnd[0] !== this._model.selectionEnd[0] ||\n            previousSelectionEnd[1] !== this._model.selectionEnd[1]) {\n            this.refresh(true);\n        }\n    };\n    SelectionManager.prototype._dragScroll = function () {\n        if (this._dragScrollAmount) {\n            this._terminal.scrollLines(this._dragScrollAmount, false);\n            if (this._dragScrollAmount > 0) {\n                if (this._activeSelectionMode !== 3) {\n                    this._model.selectionEnd[0] = this._terminal.cols;\n                }\n                this._model.selectionEnd[1] = Math.min(this._terminal.buffer.ydisp + this._terminal.rows, this._terminal.buffer.lines.length - 1);\n            }\n            else {\n                if (this._activeSelectionMode !== 3) {\n                    this._model.selectionEnd[0] = 0;\n                }\n                this._model.selectionEnd[1] = this._terminal.buffer.ydisp;\n            }\n            this.refresh();\n        }\n    };\n    SelectionManager.prototype._onMouseUp = function (event) {\n        var timeElapsed = event.timeStamp - this._mouseDownTimeStamp;\n        this._removeMouseDownListeners();\n        if (this.selectionText.length <= 1 && timeElapsed < ALT_CLICK_MOVE_CURSOR_TIME) {\n            (new AltClickHandler_1.AltClickHandler(event, this._terminal)).move();\n        }\n        else if (this.hasSelection) {\n            this._onSelectionChange.fire();\n        }\n    };\n    SelectionManager.prototype._onBufferActivate = function (e) {\n        var _this = this;\n        this.clearSelection();\n        if (this._trimListener) {\n            this._trimListener.dispose();\n        }\n        this._trimListener = e.activeBuffer.lines.onTrim(function (amount) { return _this._onTrim(amount); });\n    };\n    SelectionManager.prototype._convertViewportColToCharacterIndex = function (bufferLine, coords) {\n        var charIndex = coords[0];\n        for (var i = 0; coords[0] >= i; i++) {\n            var length_1 = bufferLine.loadCell(i, this._workCell).getChars().length;\n            if (this._workCell.getWidth() === 0) {\n                charIndex--;\n            }\n            else if (length_1 > 1 && coords[0] !== i) {\n                charIndex += length_1 - 1;\n            }\n        }\n        return charIndex;\n    };\n    SelectionManager.prototype.setSelection = function (col, row, length) {\n        this._model.clearSelection();\n        this._removeMouseDownListeners();\n        this._model.selectionStart = [col, row];\n        this._model.selectionStartLength = length;\n        this.refresh();\n    };\n    SelectionManager.prototype._getWordAt = function (coords, allowWhitespaceOnlySelection, followWrappedLinesAbove, followWrappedLinesBelow) {\n        if (followWrappedLinesAbove === void 0) { followWrappedLinesAbove = true; }\n        if (followWrappedLinesBelow === void 0) { followWrappedLinesBelow = true; }\n        if (coords[0] >= this._terminal.cols) {\n            return null;\n        }\n        var bufferLine = this._buffer.lines.get(coords[1]);\n        if (!bufferLine) {\n            return null;\n        }\n        var line = this._buffer.translateBufferLineToString(coords[1], false);\n        var startIndex = this._convertViewportColToCharacterIndex(bufferLine, coords);\n        var endIndex = startIndex;\n        var charOffset = coords[0] - startIndex;\n        var leftWideCharCount = 0;\n        var rightWideCharCount = 0;\n        var leftLongCharOffset = 0;\n        var rightLongCharOffset = 0;\n        if (line.charAt(startIndex) === ' ') {\n            while (startIndex > 0 && line.charAt(startIndex - 1) === ' ') {\n                startIndex--;\n            }\n            while (endIndex < line.length && line.charAt(endIndex + 1) === ' ') {\n                endIndex++;\n            }\n        }\n        else {\n            var startCol = coords[0];\n            var endCol = coords[0];\n            if (bufferLine.getWidth(startCol) === 0) {\n                leftWideCharCount++;\n                startCol--;\n            }\n            if (bufferLine.getWidth(endCol) === 2) {\n                rightWideCharCount++;\n                endCol++;\n            }\n            var length_2 = bufferLine.getString(endCol).length;\n            if (length_2 > 1) {\n                rightLongCharOffset += length_2 - 1;\n                endIndex += length_2 - 1;\n            }\n            while (startCol > 0 && startIndex > 0 && !this._isCharWordSeparator(bufferLine.loadCell(startCol - 1, this._workCell))) {\n                bufferLine.loadCell(startCol - 1, this._workCell);\n                var length_3 = this._workCell.getChars().length;\n                if (this._workCell.getWidth() === 0) {\n                    leftWideCharCount++;\n                    startCol--;\n                }\n                else if (length_3 > 1) {\n                    leftLongCharOffset += length_3 - 1;\n                    startIndex -= length_3 - 1;\n                }\n                startIndex--;\n                startCol--;\n            }\n            while (endCol < bufferLine.length && endIndex + 1 < line.length && !this._isCharWordSeparator(bufferLine.loadCell(endCol + 1, this._workCell))) {\n                bufferLine.loadCell(endCol + 1, this._workCell);\n                var length_4 = this._workCell.getChars().length;\n                if (this._workCell.getWidth() === 2) {\n                    rightWideCharCount++;\n                    endCol++;\n                }\n                else if (length_4 > 1) {\n                    rightLongCharOffset += length_4 - 1;\n                    endIndex += length_4 - 1;\n                }\n                endIndex++;\n                endCol++;\n            }\n        }\n        endIndex++;\n        var start = startIndex\n            + charOffset\n            - leftWideCharCount\n            + leftLongCharOffset;\n        var length = Math.min(this._terminal.cols, endIndex\n            - startIndex\n            + leftWideCharCount\n            + rightWideCharCount\n            - leftLongCharOffset\n            - rightLongCharOffset);\n        if (!allowWhitespaceOnlySelection && line.slice(startIndex, endIndex).trim() === '') {\n            return null;\n        }\n        if (followWrappedLinesAbove) {\n            if (start === 0 && bufferLine.getCodePoint(0) !== 32) {\n                var previousBufferLine = this._buffer.lines.get(coords[1] - 1);\n                if (previousBufferLine && bufferLine.isWrapped && previousBufferLine.getCodePoint(this._terminal.cols - 1) !== 32) {\n                    var previousLineWordPosition = this._getWordAt([this._terminal.cols - 1, coords[1] - 1], false, true, false);\n                    if (previousLineWordPosition) {\n                        var offset = this._terminal.cols - previousLineWordPosition.start;\n                        start -= offset;\n                        length += offset;\n                    }\n                }\n            }\n        }\n        if (followWrappedLinesBelow) {\n            if (start + length === this._terminal.cols && bufferLine.getCodePoint(this._terminal.cols - 1) !== 32) {\n                var nextBufferLine = this._buffer.lines.get(coords[1] + 1);\n                if (nextBufferLine && nextBufferLine.isWrapped && nextBufferLine.getCodePoint(0) !== 32) {\n                    var nextLineWordPosition = this._getWordAt([0, coords[1] + 1], false, false, true);\n                    if (nextLineWordPosition) {\n                        length += nextLineWordPosition.length;\n                    }\n                }\n            }\n        }\n        return { start: start, length: length };\n    };\n    SelectionManager.prototype._selectWordAt = function (coords, allowWhitespaceOnlySelection) {\n        var wordPosition = this._getWordAt(coords, allowWhitespaceOnlySelection);\n        if (wordPosition) {\n            while (wordPosition.start < 0) {\n                wordPosition.start += this._terminal.cols;\n                coords[1]--;\n            }\n            this._model.selectionStart = [wordPosition.start, coords[1]];\n            this._model.selectionStartLength = wordPosition.length;\n        }\n    };\n    SelectionManager.prototype._selectToWordAt = function (coords) {\n        var wordPosition = this._getWordAt(coords, true);\n        if (wordPosition) {\n            var endRow = coords[1];\n            while (wordPosition.start < 0) {\n                wordPosition.start += this._terminal.cols;\n                endRow--;\n            }\n            if (!this._model.areSelectionValuesReversed()) {\n                while (wordPosition.start + wordPosition.length > this._terminal.cols) {\n                    wordPosition.length -= this._terminal.cols;\n                    endRow++;\n                }\n            }\n            this._model.selectionEnd = [this._model.areSelectionValuesReversed() ? wordPosition.start : wordPosition.start + wordPosition.length, endRow];\n        }\n    };\n    SelectionManager.prototype._isCharWordSeparator = function (cell) {\n        if (cell.getWidth() === 0) {\n            return false;\n        }\n        return WORD_SEPARATORS.indexOf(cell.getChars()) >= 0;\n    };\n    SelectionManager.prototype._selectLineAt = function (line) {\n        var wrappedRange = this._buffer.getWrappedRangeForLine(line);\n        this._model.selectionStart = [0, wrappedRange.first];\n        this._model.selectionEnd = [this._terminal.cols, wrappedRange.last];\n        this._model.selectionStartLength = 0;\n    };\n    return SelectionManager;\n}());\nexports.SelectionManager = SelectionManager;\n//# sourceMappingURL=SelectionManager.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Types_1 = require(\"./Types\");\nvar CharAtlasGenerator_1 = require(\"./CharAtlasGenerator\");\nvar BaseCharAtlas_1 = require(\"./BaseCharAtlas\");\nvar CharAtlasUtils_1 = require(\"./CharAtlasUtils\");\nvar StaticCharAtlas = (function (_super) {\n    __extends(StaticCharAtlas, _super);\n    function StaticCharAtlas(_document, _config) {\n        var _this = _super.call(this) || this;\n        _this._document = _document;\n        _this._config = _config;\n        _this._canvasFactory = function (width, height) {\n            var canvas = _this._document.createElement('canvas');\n            canvas.width = width;\n            canvas.height = height;\n            return canvas;\n        };\n        return _this;\n    }\n    StaticCharAtlas.prototype._doWarmUp = function () {\n        var _this = this;\n        var result = CharAtlasGenerator_1.generateStaticCharAtlasTexture(window, this._canvasFactory, this._config);\n        if (result instanceof HTMLCanvasElement) {\n            this._texture = result;\n        }\n        else {\n            result.then(function (texture) {\n                _this._texture = texture;\n            });\n        }\n    };\n    StaticCharAtlas.prototype._isCached = function (glyph, colorIndex) {\n        var isAscii = glyph.code < 256;\n        var isBasicColor = glyph.fg < 16;\n        var isDefaultColor = glyph.fg === Types_1.DEFAULT_COLOR;\n        var isDefaultBackground = glyph.bg === Types_1.DEFAULT_COLOR;\n        return isAscii && (isBasicColor || isDefaultColor) && isDefaultBackground && !glyph.italic;\n    };\n    StaticCharAtlas.prototype.draw = function (ctx, glyph, x, y) {\n        if (this._texture === null || this._texture === undefined) {\n            return false;\n        }\n        var colorIndex = 0;\n        if (CharAtlasUtils_1.is256Color(glyph.fg)) {\n            colorIndex = 2 + glyph.fg + (glyph.bold ? 16 : 0);\n        }\n        else if (glyph.fg === Types_1.DEFAULT_COLOR) {\n            if (glyph.bold) {\n                colorIndex = 1;\n            }\n        }\n        if (!this._isCached(glyph, colorIndex)) {\n            return false;\n        }\n        ctx.save();\n        var charAtlasCellWidth = this._config.scaledCharWidth + Types_1.CHAR_ATLAS_CELL_SPACING;\n        var charAtlasCellHeight = this._config.scaledCharHeight + Types_1.CHAR_ATLAS_CELL_SPACING;\n        if (glyph.dim) {\n            ctx.globalAlpha = Types_1.DIM_OPACITY;\n        }\n        ctx.drawImage(this._texture, glyph.code * charAtlasCellWidth, colorIndex * charAtlasCellHeight, charAtlasCellWidth, this._config.scaledCharHeight, x, y, charAtlasCellWidth, this._config.scaledCharHeight);\n        ctx.restore();\n        return true;\n    };\n    return StaticCharAtlas;\n}(BaseCharAtlas_1.default));\nexports.default = StaticCharAtlas;\n//# sourceMappingURL=StaticCharAtlas.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Types_1 = require(\"./Types\");\nfunction generateConfig(scaledCharWidth, scaledCharHeight, terminal, colors) {\n    var clonedColors = {\n        foreground: colors.foreground,\n        background: colors.background,\n        cursor: null,\n        cursorAccent: null,\n        selection: null,\n        ansi: colors.ansi.slice(0, 16)\n    };\n    return {\n        type: terminal.options.experimentalCharAtlas,\n        devicePixelRatio: window.devicePixelRatio,\n        scaledCharWidth: scaledCharWidth,\n        scaledCharHeight: scaledCharHeight,\n        fontFamily: terminal.options.fontFamily,\n        fontSize: terminal.options.fontSize,\n        fontWeight: terminal.options.fontWeight,\n        fontWeightBold: terminal.options.fontWeightBold,\n        allowTransparency: terminal.options.allowTransparency,\n        colors: clonedColors\n    };\n}\nexports.generateConfig = generateConfig;\nfunction configEquals(a, b) {\n    for (var i = 0; i < a.colors.ansi.length; i++) {\n        if (a.colors.ansi[i].rgba !== b.colors.ansi[i].rgba) {\n            return false;\n        }\n    }\n    return a.type === b.type &&\n        a.devicePixelRatio === b.devicePixelRatio &&\n        a.fontFamily === b.fontFamily &&\n        a.fontSize === b.fontSize &&\n        a.fontWeight === b.fontWeight &&\n        a.fontWeightBold === b.fontWeightBold &&\n        a.allowTransparency === b.allowTransparency &&\n        a.scaledCharWidth === b.scaledCharWidth &&\n        a.scaledCharHeight === b.scaledCharHeight &&\n        a.colors.foreground === b.colors.foreground &&\n        a.colors.background === b.colors.background;\n}\nexports.configEquals = configEquals;\nfunction is256Color(colorCode) {\n    return colorCode < Types_1.DEFAULT_COLOR;\n}\nexports.is256Color = is256Color;\n//# sourceMappingURL=CharAtlasUtils.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { Platform } from '@phosphor/domutils';\nimport { MessageLoop } from '@phosphor/messaging';\nimport { Widget } from '@phosphor/widgets';\nimport { Terminal as Xterm } from 'xterm';\nimport { fit } from 'xterm/lib/addons/fit/fit';\nimport { ITerminal } from '.';\n/**\n * The class name added to a terminal widget.\n */\nconst TERMINAL_CLASS = 'jp-Terminal';\n/**\n * The class name added to a terminal body.\n */\nconst TERMINAL_BODY_CLASS = 'jp-Terminal-body';\n/**\n * A widget which manages a terminal session.\n */\nexport class Terminal extends Widget {\n    /**\n     * Construct a new terminal widget.\n     *\n     * @param session - The terminal session object.\n     *\n     * @param options - The terminal configuration options.\n     */\n    constructor(session, options = {}) {\n        super();\n        this._needsResize = true;\n        this._termOpened = false;\n        this._offsetWidth = -1;\n        this._offsetHeight = -1;\n        this.session = session;\n        // Initialize settings.\n        this._options = Object.assign({}, ITerminal.defaultOptions, options);\n        const _a = this._options, { initialCommand, theme } = _a, other = __rest(_a, [\"initialCommand\", \"theme\"]);\n        const xtermOptions = Object.assign({ theme: Private.getXTermTheme(theme) }, other);\n        this.addClass(TERMINAL_CLASS);\n        // Create the xterm.\n        this._term = new Xterm(xtermOptions);\n        this._initializeTerm();\n        this.id = `jp-Terminal-${Private.id++}`;\n        this.title.label = 'Terminal';\n        session.messageReceived.connect(this._onMessage, this);\n        session.terminated.connect(this.dispose, this);\n        void session.ready.then(() => {\n            if (this.isDisposed) {\n                return;\n            }\n            this.title.label = `Terminal ${session.name}`;\n            this._setSessionSize();\n            if (this._options.initialCommand) {\n                this.session.send({\n                    type: 'stdin',\n                    content: [this._options.initialCommand + '\\r']\n                });\n            }\n        });\n    }\n    /**\n     * Get a config option for the terminal.\n     */\n    getOption(option) {\n        return this._options[option];\n    }\n    /**\n     * Set a config option for the terminal.\n     */\n    setOption(option, value) {\n        if (option !== 'theme' &&\n            (this._options[option] === value || option === 'initialCommand')) {\n            return;\n        }\n        this._options[option] = value;\n        switch (option) {\n            case 'shutdownOnClose': // Do not transmit to XTerm\n                break;\n            case 'theme':\n                this._term.setOption('theme', Private.getXTermTheme(value));\n                break;\n            default:\n                this._term.setOption(option, value);\n                break;\n        }\n        this._needsResize = true;\n        this.update();\n    }\n    /**\n     * Dispose of the resources held by the terminal widget.\n     */\n    dispose() {\n        if (!this.session.isDisposed) {\n            if (this.getOption('shutdownOnClose')) {\n                this.session.shutdown().catch(reason => {\n                    console.error(`Terminal not shut down: ${reason}`);\n                });\n            }\n        }\n        this._term.dispose();\n        super.dispose();\n    }\n    /**\n     * Refresh the terminal session.\n     *\n     * #### Notes\n     * Failure to reconnect to the session should be caught appropriately\n     */\n    async refresh() {\n        if (!this.isDisposed) {\n            await this.session.reconnect();\n            this._term.clear();\n        }\n    }\n    /**\n     * Process a message sent to the widget.\n     *\n     * @param msg - The message sent to the widget.\n     *\n     * #### Notes\n     * Subclasses may reimplement this method as needed.\n     */\n    processMessage(msg) {\n        super.processMessage(msg);\n        switch (msg.type) {\n            case 'fit-request':\n                this.onFitRequest(msg);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Set the size of the terminal when attached if dirty.\n     */\n    onAfterAttach(msg) {\n        this.update();\n    }\n    /**\n     * Set the size of the terminal when shown if dirty.\n     */\n    onAfterShow(msg) {\n        this.update();\n    }\n    /**\n     * On resize, use the computed row and column sizes to resize the terminal.\n     */\n    onResize(msg) {\n        this._offsetWidth = msg.width;\n        this._offsetHeight = msg.height;\n        this._needsResize = true;\n        this.update();\n    }\n    /**\n     * A message handler invoked on an `'update-request'` message.\n     */\n    onUpdateRequest(msg) {\n        if (!this.isVisible || !this.isAttached) {\n            return;\n        }\n        // Open the terminal if necessary.\n        if (!this._termOpened) {\n            this._term.open(this.node);\n            this._term.element.classList.add(TERMINAL_BODY_CLASS);\n            this._termOpened = true;\n        }\n        if (this._needsResize) {\n            this._resizeTerminal();\n        }\n    }\n    /**\n     * A message handler invoked on an `'fit-request'` message.\n     */\n    onFitRequest(msg) {\n        let resize = Widget.ResizeMessage.UnknownSize;\n        MessageLoop.sendMessage(this, resize);\n    }\n    /**\n     * Handle `'activate-request'` messages.\n     */\n    onActivateRequest(msg) {\n        this._term.focus();\n    }\n    /**\n     * Initialize the terminal object.\n     */\n    _initializeTerm() {\n        const term = this._term;\n        term.on('data', (data) => {\n            if (this.isDisposed) {\n                return;\n            }\n            this.session.send({\n                type: 'stdin',\n                content: [data]\n            });\n        });\n        term.on('title', (title) => {\n            this.title.label = title;\n        });\n        // Do not add any Ctrl+C/Ctrl+V handling on macOS,\n        // where Cmd+C/Cmd+V works as intended.\n        if (Platform.IS_MAC) {\n            return;\n        }\n        term.attachCustomKeyEventHandler(event => {\n            if (event.ctrlKey && event.key === 'c' && term.hasSelection()) {\n                // Return so that the usual OS copy happens\n                // instead of interrupt signal.\n                return false;\n            }\n            if (event.ctrlKey && event.key === 'v' && this._options.pasteWithCtrlV) {\n                // Return so that the usual paste happens.\n                return false;\n            }\n            return true;\n        });\n    }\n    /**\n     * Handle a message from the terminal session.\n     */\n    _onMessage(sender, msg) {\n        switch (msg.type) {\n            case 'stdout':\n                if (msg.content) {\n                    this._term.write(msg.content[0]);\n                }\n                break;\n            case 'disconnect':\n                this._term.write('\\r\\n\\r\\n[Finished... Term Session]\\r\\n');\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Resize the terminal based on computed geometry.\n     */\n    _resizeTerminal() {\n        fit(this._term);\n        if (this._offsetWidth === -1) {\n            this._offsetWidth = this.node.offsetWidth;\n        }\n        if (this._offsetHeight === -1) {\n            this._offsetHeight = this.node.offsetHeight;\n        }\n        this._setSessionSize();\n        this._needsResize = false;\n    }\n    /**\n     * Set the size of the terminal in the session.\n     */\n    _setSessionSize() {\n        let content = [\n            this._term.rows,\n            this._term.cols,\n            this._offsetHeight,\n            this._offsetWidth\n        ];\n        if (!this.isDisposed) {\n            this.session.send({ type: 'set_size', content });\n        }\n    }\n}\n/**\n * A namespace for private data.\n */\nvar Private;\n(function (Private) {\n    /**\n     * An incrementing counter for ids.\n     */\n    Private.id = 0;\n    /**\n     * The light terminal theme.\n     */\n    Private.lightTheme = {\n        foreground: '#000',\n        background: '#fff',\n        cursor: '#616161',\n        cursorAccent: '#F5F5F5',\n        selection: 'rgba(97, 97, 97, 0.3)' // md-grey-700\n    };\n    /**\n     * The dark terminal theme.\n     */\n    Private.darkTheme = {\n        foreground: '#fff',\n        background: '#000',\n        cursor: '#fff',\n        cursorAccent: '#000',\n        selection: 'rgba(255, 255, 255, 0.3)'\n    };\n    /**\n     * The current theme.\n     */\n    Private.inheritTheme = () => ({\n        foreground: getComputedStyle(document.body)\n            .getPropertyValue('--jp-ui-font-color0')\n            .trim(),\n        background: getComputedStyle(document.body)\n            .getPropertyValue('--jp-layout-color0')\n            .trim(),\n        cursor: getComputedStyle(document.body)\n            .getPropertyValue('--jp-ui-font-color1')\n            .trim(),\n        cursorAccent: getComputedStyle(document.body)\n            .getPropertyValue('--jp-ui-inverse-font-color0')\n            .trim(),\n        selection: getComputedStyle(document.body)\n            .getPropertyValue('--jp-ui-font-color3')\n            .trim()\n    });\n    function getXTermTheme(theme) {\n        switch (theme) {\n            case 'light':\n                return Private.lightTheme;\n            case 'dark':\n                return Private.darkTheme;\n            case 'inherit':\n            default:\n                return Private.inheritTheme();\n        }\n    }\n    Private.getXTermTheme = getXTermTheme;\n})(Private || (Private = {}));\n//# sourceMappingURL=widget.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseRenderLayer_1 = require(\"./BaseRenderLayer\");\nvar BufferLine_1 = require(\"../BufferLine\");\nvar BLINK_INTERVAL = 600;\nvar CursorRenderLayer = (function (_super) {\n    __extends(CursorRenderLayer, _super);\n    function CursorRenderLayer(container, zIndex, colors) {\n        var _this = _super.call(this, container, 'cursor', zIndex, true, colors) || this;\n        _this._cell = new BufferLine_1.CellData();\n        _this._state = {\n            x: null,\n            y: null,\n            isFocused: null,\n            style: null,\n            width: null\n        };\n        _this._cursorRenderers = {\n            'bar': _this._renderBarCursor.bind(_this),\n            'block': _this._renderBlockCursor.bind(_this),\n            'underline': _this._renderUnderlineCursor.bind(_this)\n        };\n        return _this;\n    }\n    CursorRenderLayer.prototype.resize = function (terminal, dim) {\n        _super.prototype.resize.call(this, terminal, dim);\n        this._state = {\n            x: null,\n            y: null,\n            isFocused: null,\n            style: null,\n            width: null\n        };\n    };\n    CursorRenderLayer.prototype.reset = function (terminal) {\n        this._clearCursor();\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.dispose();\n            this._cursorBlinkStateManager = null;\n            this.onOptionsChanged(terminal);\n        }\n    };\n    CursorRenderLayer.prototype.onBlur = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.pause();\n        }\n        terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n    };\n    CursorRenderLayer.prototype.onFocus = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.resume(terminal);\n        }\n        else {\n            terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n        }\n    };\n    CursorRenderLayer.prototype.onOptionsChanged = function (terminal) {\n        var _this = this;\n        if (terminal.options.cursorBlink) {\n            if (!this._cursorBlinkStateManager) {\n                this._cursorBlinkStateManager = new CursorBlinkStateManager(terminal, function () {\n                    _this._render(terminal, true);\n                });\n            }\n        }\n        else {\n            if (this._cursorBlinkStateManager) {\n                this._cursorBlinkStateManager.dispose();\n                this._cursorBlinkStateManager = null;\n            }\n            terminal.refresh(terminal.buffer.y, terminal.buffer.y);\n        }\n    };\n    CursorRenderLayer.prototype.onCursorMove = function (terminal) {\n        if (this._cursorBlinkStateManager) {\n            this._cursorBlinkStateManager.restartBlinkAnimation(terminal);\n        }\n    };\n    CursorRenderLayer.prototype.onGridChanged = function (terminal, startRow, endRow) {\n        if (!this._cursorBlinkStateManager || this._cursorBlinkStateManager.isPaused) {\n            this._render(terminal, false);\n        }\n        else {\n            this._cursorBlinkStateManager.restartBlinkAnimation(terminal);\n        }\n    };\n    CursorRenderLayer.prototype._render = function (terminal, triggeredByAnimationFrame) {\n        if (!terminal.cursorState || terminal.cursorHidden) {\n            this._clearCursor();\n            return;\n        }\n        var cursorY = terminal.buffer.ybase + terminal.buffer.y;\n        var viewportRelativeCursorY = cursorY - terminal.buffer.ydisp;\n        if (viewportRelativeCursorY < 0 || viewportRelativeCursorY >= terminal.rows) {\n            this._clearCursor();\n            return;\n        }\n        terminal.buffer.lines.get(cursorY).loadCell(terminal.buffer.x, this._cell);\n        if (this._cell.content === undefined) {\n            return;\n        }\n        if (!terminal.isFocused) {\n            this._clearCursor();\n            this._ctx.save();\n            this._ctx.fillStyle = this._colors.cursor.css;\n            this._renderBlurCursor(terminal, terminal.buffer.x, viewportRelativeCursorY, this._cell);\n            this._ctx.restore();\n            this._state.x = terminal.buffer.x;\n            this._state.y = viewportRelativeCursorY;\n            this._state.isFocused = false;\n            this._state.style = terminal.options.cursorStyle;\n            this._state.width = this._cell.getWidth();\n            return;\n        }\n        if (this._cursorBlinkStateManager && !this._cursorBlinkStateManager.isCursorVisible) {\n            this._clearCursor();\n            return;\n        }\n        if (this._state) {\n            if (this._state.x === terminal.buffer.x &&\n                this._state.y === viewportRelativeCursorY &&\n                this._state.isFocused === terminal.isFocused &&\n                this._state.style === terminal.options.cursorStyle &&\n                this._state.width === this._cell.getWidth()) {\n                return;\n            }\n            this._clearCursor();\n        }\n        this._ctx.save();\n        this._cursorRenderers[terminal.options.cursorStyle || 'block'](terminal, terminal.buffer.x, viewportRelativeCursorY, this._cell);\n        this._ctx.restore();\n        this._state.x = terminal.buffer.x;\n        this._state.y = viewportRelativeCursorY;\n        this._state.isFocused = false;\n        this._state.style = terminal.options.cursorStyle;\n        this._state.width = this._cell.getWidth();\n    };\n    CursorRenderLayer.prototype._clearCursor = function () {\n        if (this._state) {\n            this.clearCells(this._state.x, this._state.y, this._state.width, 1);\n            this._state = {\n                x: null,\n                y: null,\n                isFocused: null,\n                style: null,\n                width: null\n            };\n        }\n    };\n    CursorRenderLayer.prototype._renderBarCursor = function (terminal, x, y, cell) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor.css;\n        this.fillLeftLineAtCell(x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderBlockCursor = function (terminal, x, y, cell) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor.css;\n        this.fillCells(x, y, cell.getWidth(), 1);\n        this._ctx.fillStyle = this._colors.cursorAccent.css;\n        this.fillCharTrueColor(terminal, cell, x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderUnderlineCursor = function (terminal, x, y, cell) {\n        this._ctx.save();\n        this._ctx.fillStyle = this._colors.cursor.css;\n        this.fillBottomLineAtCells(x, y);\n        this._ctx.restore();\n    };\n    CursorRenderLayer.prototype._renderBlurCursor = function (terminal, x, y, cell) {\n        this._ctx.save();\n        this._ctx.strokeStyle = this._colors.cursor.css;\n        this.strokeRectAtCell(x, y, cell.getWidth(), 1);\n        this._ctx.restore();\n    };\n    return CursorRenderLayer;\n}(BaseRenderLayer_1.BaseRenderLayer));\nexports.CursorRenderLayer = CursorRenderLayer;\nvar CursorBlinkStateManager = (function () {\n    function CursorBlinkStateManager(terminal, _renderCallback) {\n        this._renderCallback = _renderCallback;\n        this.isCursorVisible = true;\n        if (terminal.isFocused) {\n            this._restartInterval();\n        }\n    }\n    Object.defineProperty(CursorBlinkStateManager.prototype, \"isPaused\", {\n        get: function () { return !(this._blinkStartTimeout || this._blinkInterval); },\n        enumerable: true,\n        configurable: true\n    });\n    CursorBlinkStateManager.prototype.dispose = function () {\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n            this._blinkInterval = null;\n        }\n        if (this._blinkStartTimeout) {\n            window.clearTimeout(this._blinkStartTimeout);\n            this._blinkStartTimeout = null;\n        }\n        if (this._animationFrame) {\n            window.cancelAnimationFrame(this._animationFrame);\n            this._animationFrame = null;\n        }\n    };\n    CursorBlinkStateManager.prototype.restartBlinkAnimation = function (terminal) {\n        var _this = this;\n        if (this.isPaused) {\n            return;\n        }\n        this._animationTimeRestarted = Date.now();\n        this.isCursorVisible = true;\n        if (!this._animationFrame) {\n            this._animationFrame = window.requestAnimationFrame(function () {\n                _this._renderCallback();\n                _this._animationFrame = null;\n            });\n        }\n    };\n    CursorBlinkStateManager.prototype._restartInterval = function (timeToStart) {\n        var _this = this;\n        if (timeToStart === void 0) { timeToStart = BLINK_INTERVAL; }\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n        }\n        this._blinkStartTimeout = setTimeout(function () {\n            if (_this._animationTimeRestarted) {\n                var time = BLINK_INTERVAL - (Date.now() - _this._animationTimeRestarted);\n                _this._animationTimeRestarted = null;\n                if (time > 0) {\n                    _this._restartInterval(time);\n                    return;\n                }\n            }\n            _this.isCursorVisible = false;\n            _this._animationFrame = window.requestAnimationFrame(function () {\n                _this._renderCallback();\n                _this._animationFrame = null;\n            });\n            _this._blinkInterval = setInterval(function () {\n                if (_this._animationTimeRestarted) {\n                    var time = BLINK_INTERVAL - (Date.now() - _this._animationTimeRestarted);\n                    _this._animationTimeRestarted = null;\n                    _this._restartInterval(time);\n                    return;\n                }\n                _this.isCursorVisible = !_this.isCursorVisible;\n                _this._animationFrame = window.requestAnimationFrame(function () {\n                    _this._renderCallback();\n                    _this._animationFrame = null;\n                });\n            }, BLINK_INTERVAL);\n        }, timeToStart);\n    };\n    CursorBlinkStateManager.prototype.pause = function () {\n        this.isCursorVisible = true;\n        if (this._blinkInterval) {\n            window.clearInterval(this._blinkInterval);\n            this._blinkInterval = null;\n        }\n        if (this._blinkStartTimeout) {\n            window.clearTimeout(this._blinkStartTimeout);\n            this._blinkStartTimeout = null;\n        }\n        if (this._animationFrame) {\n            window.cancelAnimationFrame(this._animationFrame);\n            this._animationFrame = null;\n        }\n    };\n    CursorBlinkStateManager.prototype.resume = function (terminal) {\n        this._animationTimeRestarted = null;\n        this._restartInterval();\n        this.restartBlinkAnimation(terminal);\n    };\n    return CursorBlinkStateManager;\n}());\n//# sourceMappingURL=CursorRenderLayer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Platform_1 = require(\"../../common/Platform\");\nvar Types_1 = require(\"./Types\");\nfunction generateStaticCharAtlasTexture(context, canvasFactory, config) {\n    var cellWidth = config.scaledCharWidth + Types_1.CHAR_ATLAS_CELL_SPACING;\n    var cellHeight = config.scaledCharHeight + Types_1.CHAR_ATLAS_CELL_SPACING;\n    var canvas = canvasFactory(255 * cellWidth, (2 + 16 + 16) * cellHeight);\n    var ctx = canvas.getContext('2d', { alpha: config.allowTransparency });\n    ctx.fillStyle = config.colors.background.css;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.save();\n    ctx.fillStyle = config.colors.foreground.css;\n    ctx.font = getFont(config.fontWeight, config);\n    ctx.textBaseline = 'middle';\n    for (var i = 0; i < 256; i++) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.rect(i * cellWidth, 0, cellWidth, cellHeight);\n        ctx.clip();\n        ctx.fillText(String.fromCharCode(i), i * cellWidth, cellHeight / 2);\n        ctx.restore();\n    }\n    ctx.save();\n    ctx.font = getFont(config.fontWeightBold, config);\n    for (var i = 0; i < 256; i++) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.rect(i * cellWidth, cellHeight, cellWidth, cellHeight);\n        ctx.clip();\n        ctx.fillText(String.fromCharCode(i), i * cellWidth, cellHeight * 1.5);\n        ctx.restore();\n    }\n    ctx.restore();\n    ctx.font = getFont(config.fontWeight, config);\n    for (var colorIndex = 0; colorIndex < 16; colorIndex++) {\n        var y = (colorIndex + 2) * cellHeight;\n        for (var i = 0; i < 256; i++) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.rect(i * cellWidth, y, cellWidth, cellHeight);\n            ctx.clip();\n            ctx.fillStyle = config.colors.ansi[colorIndex].css;\n            ctx.fillText(String.fromCharCode(i), i * cellWidth, y + cellHeight / 2);\n            ctx.restore();\n        }\n    }\n    ctx.font = getFont(config.fontWeightBold, config);\n    for (var colorIndex = 0; colorIndex < 16; colorIndex++) {\n        var y = (colorIndex + 2 + 16) * cellHeight;\n        for (var i = 0; i < 256; i++) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.rect(i * cellWidth, y, cellWidth, cellHeight);\n            ctx.clip();\n            ctx.fillStyle = config.colors.ansi[colorIndex].css;\n            ctx.fillText(String.fromCharCode(i), i * cellWidth, y + cellHeight / 2);\n            ctx.restore();\n        }\n    }\n    ctx.restore();\n    if (!('createImageBitmap' in context) || Platform_1.isFirefox || Platform_1.isSafari) {\n        return canvas;\n    }\n    var charAtlasImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    clearColor(charAtlasImageData, config.colors.background);\n    return context.createImageBitmap(charAtlasImageData);\n}\nexports.generateStaticCharAtlasTexture = generateStaticCharAtlasTexture;\nfunction clearColor(imageData, color) {\n    var isEmpty = true;\n    var r = color.rgba >>> 24;\n    var g = color.rgba >>> 16 & 0xFF;\n    var b = color.rgba >>> 8 & 0xFF;\n    for (var offset = 0; offset < imageData.data.length; offset += 4) {\n        if (imageData.data[offset] === r &&\n            imageData.data[offset + 1] === g &&\n            imageData.data[offset + 2] === b) {\n            imageData.data[offset + 3] = 0;\n        }\n        else {\n            isEmpty = false;\n        }\n    }\n    return isEmpty;\n}\nexports.clearColor = clearColor;\nfunction getFont(fontWeight, config) {\n    return fontWeight + \" \" + config.fontSize * config.devicePixelRatio + \"px \" + config.fontFamily;\n}\n//# sourceMappingURL=CharAtlasGenerator.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CompositionHelper = (function () {\n    function CompositionHelper(_textarea, _compositionView, _terminal) {\n        this._textarea = _textarea;\n        this._compositionView = _compositionView;\n        this._terminal = _terminal;\n        this._isComposing = false;\n        this._isSendingComposition = false;\n        this._compositionPosition = { start: null, end: null };\n    }\n    CompositionHelper.prototype.compositionstart = function () {\n        this._isComposing = true;\n        this._compositionPosition.start = this._textarea.value.length;\n        this._compositionView.textContent = '';\n        this._compositionView.classList.add('active');\n    };\n    CompositionHelper.prototype.compositionupdate = function (ev) {\n        var _this = this;\n        this._compositionView.textContent = ev.data;\n        this.updateCompositionElements();\n        setTimeout(function () {\n            _this._compositionPosition.end = _this._textarea.value.length;\n        }, 0);\n    };\n    CompositionHelper.prototype.compositionend = function () {\n        this._finalizeComposition(true);\n    };\n    CompositionHelper.prototype.keydown = function (ev) {\n        if (this._isComposing || this._isSendingComposition) {\n            if (ev.keyCode === 229) {\n                return false;\n            }\n            else if (ev.keyCode === 16 || ev.keyCode === 17 || ev.keyCode === 18) {\n                return false;\n            }\n            this._finalizeComposition(false);\n        }\n        if (ev.keyCode === 229) {\n            this._handleAnyTextareaChanges();\n            return false;\n        }\n        return true;\n    };\n    CompositionHelper.prototype._finalizeComposition = function (waitForPropagation) {\n        var _this = this;\n        this._compositionView.classList.remove('active');\n        this._isComposing = false;\n        this._clearTextareaPosition();\n        if (!waitForPropagation) {\n            this._isSendingComposition = false;\n            var input = this._textarea.value.substring(this._compositionPosition.start, this._compositionPosition.end);\n            this._terminal.handler(input);\n        }\n        else {\n            var currentCompositionPosition_1 = {\n                start: this._compositionPosition.start,\n                end: this._compositionPosition.end\n            };\n            this._isSendingComposition = true;\n            setTimeout(function () {\n                if (_this._isSendingComposition) {\n                    _this._isSendingComposition = false;\n                    var input = void 0;\n                    if (_this._isComposing) {\n                        input = _this._textarea.value.substring(currentCompositionPosition_1.start, currentCompositionPosition_1.end);\n                    }\n                    else {\n                        input = _this._textarea.value.substring(currentCompositionPosition_1.start);\n                    }\n                    _this._terminal.handler(input);\n                }\n            }, 0);\n        }\n    };\n    CompositionHelper.prototype._handleAnyTextareaChanges = function () {\n        var _this = this;\n        var oldValue = this._textarea.value;\n        setTimeout(function () {\n            if (!_this._isComposing) {\n                var newValue = _this._textarea.value;\n                var diff = newValue.replace(oldValue, '');\n                if (diff.length > 0) {\n                    _this._terminal.handler(diff);\n                }\n            }\n        }, 0);\n    };\n    CompositionHelper.prototype.updateCompositionElements = function (dontRecurse) {\n        var _this = this;\n        if (!this._isComposing) {\n            return;\n        }\n        if (this._terminal.buffer.isCursorInViewport) {\n            var cellHeight = Math.ceil(this._terminal.charMeasure.height * this._terminal.options.lineHeight);\n            var cursorTop = this._terminal.buffer.y * cellHeight;\n            var cursorLeft = this._terminal.buffer.x * this._terminal.charMeasure.width;\n            this._compositionView.style.left = cursorLeft + 'px';\n            this._compositionView.style.top = cursorTop + 'px';\n            this._compositionView.style.height = cellHeight + 'px';\n            this._compositionView.style.lineHeight = cellHeight + 'px';\n            this._compositionView.style.fontFamily = this._terminal.options.fontFamily;\n            this._compositionView.style.fontSize = this._terminal.options.fontSize + 'px';\n            var compositionViewBounds = this._compositionView.getBoundingClientRect();\n            this._textarea.style.left = cursorLeft + 'px';\n            this._textarea.style.top = cursorTop + 'px';\n            this._textarea.style.width = compositionViewBounds.width + 'px';\n            this._textarea.style.height = compositionViewBounds.height + 'px';\n            this._textarea.style.lineHeight = compositionViewBounds.height + 'px';\n        }\n        if (!dontRecurse) {\n            setTimeout(function () { return _this.updateCompositionElements(true); }, 0);\n        }\n    };\n    CompositionHelper.prototype._clearTextareaPosition = function () {\n        this._textarea.style.left = '';\n        this._textarea.style.top = '';\n    };\n    return CompositionHelper;\n}());\nexports.CompositionHelper = CompositionHelper;\n//# sourceMappingURL=CompositionHelper.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TypedArrayUtils_1 = require(\"./common/TypedArrayUtils\");\nexports.wcwidth = (function (opts) {\n    var COMBINING_BMP = [\n        [0x0300, 0x036F], [0x0483, 0x0486], [0x0488, 0x0489],\n        [0x0591, 0x05BD], [0x05BF, 0x05BF], [0x05C1, 0x05C2],\n        [0x05C4, 0x05C5], [0x05C7, 0x05C7], [0x0600, 0x0603],\n        [0x0610, 0x0615], [0x064B, 0x065E], [0x0670, 0x0670],\n        [0x06D6, 0x06E4], [0x06E7, 0x06E8], [0x06EA, 0x06ED],\n        [0x070F, 0x070F], [0x0711, 0x0711], [0x0730, 0x074A],\n        [0x07A6, 0x07B0], [0x07EB, 0x07F3], [0x0901, 0x0902],\n        [0x093C, 0x093C], [0x0941, 0x0948], [0x094D, 0x094D],\n        [0x0951, 0x0954], [0x0962, 0x0963], [0x0981, 0x0981],\n        [0x09BC, 0x09BC], [0x09C1, 0x09C4], [0x09CD, 0x09CD],\n        [0x09E2, 0x09E3], [0x0A01, 0x0A02], [0x0A3C, 0x0A3C],\n        [0x0A41, 0x0A42], [0x0A47, 0x0A48], [0x0A4B, 0x0A4D],\n        [0x0A70, 0x0A71], [0x0A81, 0x0A82], [0x0ABC, 0x0ABC],\n        [0x0AC1, 0x0AC5], [0x0AC7, 0x0AC8], [0x0ACD, 0x0ACD],\n        [0x0AE2, 0x0AE3], [0x0B01, 0x0B01], [0x0B3C, 0x0B3C],\n        [0x0B3F, 0x0B3F], [0x0B41, 0x0B43], [0x0B4D, 0x0B4D],\n        [0x0B56, 0x0B56], [0x0B82, 0x0B82], [0x0BC0, 0x0BC0],\n        [0x0BCD, 0x0BCD], [0x0C3E, 0x0C40], [0x0C46, 0x0C48],\n        [0x0C4A, 0x0C4D], [0x0C55, 0x0C56], [0x0CBC, 0x0CBC],\n        [0x0CBF, 0x0CBF], [0x0CC6, 0x0CC6], [0x0CCC, 0x0CCD],\n        [0x0CE2, 0x0CE3], [0x0D41, 0x0D43], [0x0D4D, 0x0D4D],\n        [0x0DCA, 0x0DCA], [0x0DD2, 0x0DD4], [0x0DD6, 0x0DD6],\n        [0x0E31, 0x0E31], [0x0E34, 0x0E3A], [0x0E47, 0x0E4E],\n        [0x0EB1, 0x0EB1], [0x0EB4, 0x0EB9], [0x0EBB, 0x0EBC],\n        [0x0EC8, 0x0ECD], [0x0F18, 0x0F19], [0x0F35, 0x0F35],\n        [0x0F37, 0x0F37], [0x0F39, 0x0F39], [0x0F71, 0x0F7E],\n        [0x0F80, 0x0F84], [0x0F86, 0x0F87], [0x0F90, 0x0F97],\n        [0x0F99, 0x0FBC], [0x0FC6, 0x0FC6], [0x102D, 0x1030],\n        [0x1032, 0x1032], [0x1036, 0x1037], [0x1039, 0x1039],\n        [0x1058, 0x1059], [0x1160, 0x11FF], [0x135F, 0x135F],\n        [0x1712, 0x1714], [0x1732, 0x1734], [0x1752, 0x1753],\n        [0x1772, 0x1773], [0x17B4, 0x17B5], [0x17B7, 0x17BD],\n        [0x17C6, 0x17C6], [0x17C9, 0x17D3], [0x17DD, 0x17DD],\n        [0x180B, 0x180D], [0x18A9, 0x18A9], [0x1920, 0x1922],\n        [0x1927, 0x1928], [0x1932, 0x1932], [0x1939, 0x193B],\n        [0x1A17, 0x1A18], [0x1B00, 0x1B03], [0x1B34, 0x1B34],\n        [0x1B36, 0x1B3A], [0x1B3C, 0x1B3C], [0x1B42, 0x1B42],\n        [0x1B6B, 0x1B73], [0x1DC0, 0x1DCA], [0x1DFE, 0x1DFF],\n        [0x200B, 0x200F], [0x202A, 0x202E], [0x2060, 0x2063],\n        [0x206A, 0x206F], [0x20D0, 0x20EF], [0x302A, 0x302F],\n        [0x3099, 0x309A], [0xA806, 0xA806], [0xA80B, 0xA80B],\n        [0xA825, 0xA826], [0xFB1E, 0xFB1E], [0xFE00, 0xFE0F],\n        [0xFE20, 0xFE23], [0xFEFF, 0xFEFF], [0xFFF9, 0xFFFB]\n    ];\n    var COMBINING_HIGH = [\n        [0x10A01, 0x10A03], [0x10A05, 0x10A06], [0x10A0C, 0x10A0F],\n        [0x10A38, 0x10A3A], [0x10A3F, 0x10A3F], [0x1D167, 0x1D169],\n        [0x1D173, 0x1D182], [0x1D185, 0x1D18B], [0x1D1AA, 0x1D1AD],\n        [0x1D242, 0x1D244], [0xE0001, 0xE0001], [0xE0020, 0xE007F],\n        [0xE0100, 0xE01EF]\n    ];\n    function bisearch(ucs, data) {\n        var min = 0;\n        var max = data.length - 1;\n        var mid;\n        if (ucs < data[0][0] || ucs > data[max][1]) {\n            return false;\n        }\n        while (max >= min) {\n            mid = (min + max) >> 1;\n            if (ucs > data[mid][1]) {\n                min = mid + 1;\n            }\n            else if (ucs < data[mid][0]) {\n                max = mid - 1;\n            }\n            else {\n                return true;\n            }\n        }\n        return false;\n    }\n    function wcwidthHigh(ucs) {\n        if (bisearch(ucs, COMBINING_HIGH)) {\n            return 0;\n        }\n        if ((ucs >= 0x20000 && ucs <= 0x2fffd) || (ucs >= 0x30000 && ucs <= 0x3fffd)) {\n            return 2;\n        }\n        return 1;\n    }\n    var control = opts.control | 0;\n    var table = new Uint8Array(65536);\n    TypedArrayUtils_1.fill(table, 1);\n    table[0] = opts.nul;\n    TypedArrayUtils_1.fill(table, opts.control, 1, 32);\n    TypedArrayUtils_1.fill(table, opts.control, 0x7f, 0xa0);\n    TypedArrayUtils_1.fill(table, 2, 0x1100, 0x1160);\n    table[0x2329] = 2;\n    table[0x232a] = 2;\n    TypedArrayUtils_1.fill(table, 2, 0x2e80, 0xa4d0);\n    table[0x303f] = 1;\n    TypedArrayUtils_1.fill(table, 2, 0xac00, 0xd7a4);\n    TypedArrayUtils_1.fill(table, 2, 0xf900, 0xfb00);\n    TypedArrayUtils_1.fill(table, 2, 0xfe10, 0xfe1a);\n    TypedArrayUtils_1.fill(table, 2, 0xfe30, 0xfe70);\n    TypedArrayUtils_1.fill(table, 2, 0xff00, 0xff61);\n    TypedArrayUtils_1.fill(table, 2, 0xffe0, 0xffe7);\n    for (var r = 0; r < COMBINING_BMP.length; ++r) {\n        TypedArrayUtils_1.fill(table, 0, COMBINING_BMP[r][0], COMBINING_BMP[r][1] + 1);\n    }\n    return function (num) {\n        if (num < 32) {\n            return control | 0;\n        }\n        if (num < 127) {\n            return 1;\n        }\n        if (num < 65536) {\n            return table[num];\n        }\n        return wcwidthHigh(num);\n    };\n})({ nul: 0, control: 0 });\nfunction getStringCellWidth(s) {\n    var result = 0;\n    var length = s.length;\n    for (var i = 0; i < length; ++i) {\n        var code = s.charCodeAt(i);\n        if (0xD800 <= code && code <= 0xDBFF) {\n            if (++i >= length) {\n                return result + exports.wcwidth(code);\n            }\n            var second = s.charCodeAt(i);\n            if (0xDC00 <= second && second <= 0xDFFF) {\n                code = (code - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n            }\n            else {\n                result += exports.wcwidth(second);\n            }\n        }\n        result += exports.wcwidth(code);\n    }\n    return result;\n}\nexports.getStringCellWidth = getStringCellWidth;\n//# sourceMappingURL=CharWidth.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CHARSETS = {};\nexports.DEFAULT_CHARSET = exports.CHARSETS['B'];\nexports.CHARSETS['0'] = {\n    '`': '\\u25c6',\n    'a': '\\u2592',\n    'b': '\\u0009',\n    'c': '\\u000c',\n    'd': '\\u000d',\n    'e': '\\u000a',\n    'f': '\\u00b0',\n    'g': '\\u00b1',\n    'h': '\\u2424',\n    'i': '\\u000b',\n    'j': '\\u2518',\n    'k': '\\u2510',\n    'l': '\\u250c',\n    'm': '\\u2514',\n    'n': '\\u253c',\n    'o': '\\u23ba',\n    'p': '\\u23bb',\n    'q': '\\u2500',\n    'r': '\\u23bc',\n    's': '\\u23bd',\n    't': '\\u251c',\n    'u': '\\u2524',\n    'v': '\\u2534',\n    'w': '\\u252c',\n    'x': '\\u2502',\n    'y': '\\u2264',\n    'z': '\\u2265',\n    '{': '\\u03c0',\n    '|': '\\u2260',\n    '}': '\\u00a3',\n    '~': '\\u00b7'\n};\nexports.CHARSETS['A'] = {\n    '#': ''\n};\nexports.CHARSETS['B'] = null;\nexports.CHARSETS['4'] = {\n    '#': '',\n    '@': '',\n    '[': 'ij',\n    '\\\\': '',\n    ']': '|',\n    '{': '',\n    '|': 'f',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['C'] =\n    exports.CHARSETS['5'] = {\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['R'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['Q'] = {\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '^': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['K'] = {\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['Y'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\nexports.CHARSETS['E'] =\n    exports.CHARSETS['6'] = {\n        '@': '',\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['Z'] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '{': '',\n    '|': '',\n    '}': ''\n};\nexports.CHARSETS['H'] =\n    exports.CHARSETS['7'] = {\n        '@': '',\n        '[': '',\n        '\\\\': '',\n        ']': '',\n        '^': '',\n        '`': '',\n        '{': '',\n        '|': '',\n        '}': '',\n        '~': ''\n    };\nexports.CHARSETS['='] = {\n    '#': '',\n    '@': '',\n    '[': '',\n    '\\\\': '',\n    ']': '',\n    '^': '',\n    '_': '',\n    '`': '',\n    '{': '',\n    '|': '',\n    '}': '',\n    '~': ''\n};\n//# sourceMappingURL=Charsets.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BufferSet_1 = require(\"./BufferSet\");\nvar Buffer_1 = require(\"./Buffer\");\nvar CompositionHelper_1 = require(\"./CompositionHelper\");\nvar EventEmitter_1 = require(\"./common/EventEmitter\");\nvar Viewport_1 = require(\"./Viewport\");\nvar Clipboard_1 = require(\"./Clipboard\");\nvar EscapeSequences_1 = require(\"./common/data/EscapeSequences\");\nvar InputHandler_1 = require(\"./InputHandler\");\nvar Renderer_1 = require(\"./renderer/Renderer\");\nvar Linkifier_1 = require(\"./Linkifier\");\nvar SelectionManager_1 = require(\"./SelectionManager\");\nvar CharMeasure_1 = require(\"./CharMeasure\");\nvar Browser = require(\"./common/Platform\");\nvar Lifecycle_1 = require(\"./ui/Lifecycle\");\nvar Strings = require(\"./Strings\");\nvar MouseHelper_1 = require(\"./MouseHelper\");\nvar SoundManager_1 = require(\"./SoundManager\");\nvar MouseZoneManager_1 = require(\"./MouseZoneManager\");\nvar AccessibilityManager_1 = require(\"./AccessibilityManager\");\nvar ScreenDprMonitor_1 = require(\"./ui/ScreenDprMonitor\");\nvar CharAtlasCache_1 = require(\"./renderer/atlas/CharAtlasCache\");\nvar DomRenderer_1 = require(\"./renderer/dom/DomRenderer\");\nvar Keyboard_1 = require(\"./core/input/Keyboard\");\nvar Clone_1 = require(\"./common/Clone\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar WindowsMode_1 = require(\"./WindowsMode\");\nvar document = (typeof window !== 'undefined') ? window.document : null;\nvar WRITE_BUFFER_PAUSE_THRESHOLD = 5;\nvar WRITE_TIMEOUT_MS = 12;\nvar MINIMUM_COLS = 2;\nvar MINIMUM_ROWS = 1;\nvar CONSTRUCTOR_ONLY_OPTIONS = ['cols', 'rows'];\nvar DEFAULT_OPTIONS = {\n    cols: 80,\n    rows: 24,\n    convertEol: false,\n    termName: 'xterm',\n    cursorBlink: false,\n    cursorStyle: 'block',\n    bellSound: SoundManager_1.DEFAULT_BELL_SOUND,\n    bellStyle: 'none',\n    drawBoldTextInBrightColors: true,\n    enableBold: true,\n    experimentalCharAtlas: 'static',\n    fontFamily: 'courier-new, courier, monospace',\n    fontSize: 15,\n    fontWeight: 'normal',\n    fontWeightBold: 'bold',\n    lineHeight: 1.0,\n    letterSpacing: 0,\n    scrollback: 1000,\n    screenKeys: false,\n    screenReaderMode: false,\n    debug: false,\n    macOptionIsMeta: false,\n    macOptionClickForcesSelection: false,\n    cancelEvents: false,\n    disableStdin: false,\n    useFlowControl: false,\n    allowTransparency: false,\n    tabStopWidth: 8,\n    theme: null,\n    rightClickSelectsWord: Browser.isMac,\n    rendererType: 'canvas',\n    windowsMode: false\n};\nvar Terminal = (function (_super) {\n    __extends(Terminal, _super);\n    function Terminal(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.browser = Browser;\n        _this._blankLine = null;\n        _this._onCursorMove = new EventEmitter2_1.EventEmitter2();\n        _this._onData = new EventEmitter2_1.EventEmitter2();\n        _this._onKey = new EventEmitter2_1.EventEmitter2();\n        _this._onLineFeed = new EventEmitter2_1.EventEmitter2();\n        _this._onRender = new EventEmitter2_1.EventEmitter2();\n        _this._onResize = new EventEmitter2_1.EventEmitter2();\n        _this._onScroll = new EventEmitter2_1.EventEmitter2();\n        _this._onSelectionChange = new EventEmitter2_1.EventEmitter2();\n        _this._onTitleChange = new EventEmitter2_1.EventEmitter2();\n        _this.options = Clone_1.clone(options);\n        _this._setup();\n        _this.onCursorMove(function () { return _this.emit('cursormove'); });\n        _this.onData(function (e) { return _this.emit('data', e); });\n        _this.onKey(function (e) { return _this.emit('key', e.key, e.domEvent); });\n        _this.onLineFeed(function () { return _this.emit('linefeed'); });\n        _this.onRender(function (e) { return _this.emit('refresh', e); });\n        _this.onResize(function (e) { return _this.emit('resize', e); });\n        _this.onSelectionChange(function () { return _this.emit('selection'); });\n        _this.onScroll(function (e) { return _this.emit('scroll', e); });\n        _this.onTitleChange(function (e) { return _this.emit('title', e); });\n        return _this;\n    }\n    Object.defineProperty(Terminal.prototype, \"onCursorMove\", {\n        get: function () { return this._onCursorMove.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onData\", {\n        get: function () { return this._onData.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onKey\", {\n        get: function () { return this._onKey.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onLineFeed\", {\n        get: function () { return this._onLineFeed.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onRender\", {\n        get: function () { return this._onRender.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onResize\", {\n        get: function () { return this._onResize.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onScroll\", {\n        get: function () { return this._onScroll.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onSelectionChange\", {\n        get: function () { return this._onSelectionChange.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Terminal.prototype, \"onTitleChange\", {\n        get: function () { return this._onTitleChange.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        if (this._windowsMode) {\n            this._windowsMode.dispose();\n            this._windowsMode = undefined;\n        }\n        this._customKeyEventHandler = null;\n        CharAtlasCache_1.removeTerminalFromCache(this);\n        this.handler = function () { };\n        this.write = function () { };\n        if (this.element && this.element.parentNode) {\n            this.element.parentNode.removeChild(this.element);\n        }\n    };\n    Terminal.prototype.destroy = function () {\n        this.dispose();\n    };\n    Terminal.prototype._setup = function () {\n        var _this = this;\n        Object.keys(DEFAULT_OPTIONS).forEach(function (key) {\n            if (_this.options[key] === null || _this.options[key] === undefined) {\n                _this.options[key] = DEFAULT_OPTIONS[key];\n            }\n        });\n        this._parent = document ? document.body : null;\n        this.cols = Math.max(this.options.cols, MINIMUM_COLS);\n        this.rows = Math.max(this.options.rows, MINIMUM_ROWS);\n        if (this.options.handler) {\n            this.onData(this.options.handler);\n        }\n        this.cursorState = 0;\n        this.cursorHidden = false;\n        this._customKeyEventHandler = null;\n        this.applicationKeypad = false;\n        this.applicationCursor = false;\n        this.originMode = false;\n        this.insertMode = false;\n        this.wraparoundMode = true;\n        this.bracketedPasteMode = false;\n        this.charset = null;\n        this.gcharset = null;\n        this.glevel = 0;\n        this.charsets = [null];\n        this.curAttrData = Buffer_1.DEFAULT_ATTR_DATA.clone();\n        this._eraseAttrData = Buffer_1.DEFAULT_ATTR_DATA.clone();\n        this.params = [];\n        this.currentParam = 0;\n        this.writeBuffer = [];\n        this._writeInProgress = false;\n        this._xoffSentToCatchUp = false;\n        this._userScrolling = false;\n        this._inputHandler = new InputHandler_1.InputHandler(this);\n        this._inputHandler.onCursorMove(function () { return _this._onCursorMove.fire(); });\n        this._inputHandler.onLineFeed(function () { return _this._onLineFeed.fire(); });\n        this._inputHandler.onData(function (e) { return _this._onData.fire(e); });\n        this.register(this._inputHandler);\n        this.renderer = this.renderer || null;\n        this.selectionManager = this.selectionManager || null;\n        this.linkifier = this.linkifier || new Linkifier_1.Linkifier(this);\n        this._mouseZoneManager = this._mouseZoneManager || null;\n        this.soundManager = this.soundManager || new SoundManager_1.SoundManager(this);\n        this.buffers = new BufferSet_1.BufferSet(this);\n        if (this.selectionManager) {\n            this.selectionManager.clearSelection();\n            this.selectionManager.initBuffersListeners();\n        }\n        if (this.options.windowsMode) {\n            this._windowsMode = WindowsMode_1.applyWindowsMode(this);\n        }\n    };\n    Object.defineProperty(Terminal.prototype, \"buffer\", {\n        get: function () {\n            return this.buffers.active;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.eraseAttrData = function () {\n        this._eraseAttrData.bg &= ~(50331648 | 0xFFFFFF);\n        this._eraseAttrData.bg |= this.curAttrData.bg & ~0xFC000000;\n        return this._eraseAttrData;\n    };\n    Terminal.prototype.focus = function () {\n        if (this.textarea) {\n            this.textarea.focus({ preventScroll: true });\n        }\n    };\n    Object.defineProperty(Terminal.prototype, \"isFocused\", {\n        get: function () {\n            return document.activeElement === this.textarea && document.hasFocus();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.getOption = function (key) {\n        if (!(key in DEFAULT_OPTIONS)) {\n            throw new Error('No option with key \"' + key + '\"');\n        }\n        return this.options[key];\n    };\n    Terminal.prototype.setOption = function (key, value) {\n        if (!(key in DEFAULT_OPTIONS)) {\n            throw new Error('No option with key \"' + key + '\"');\n        }\n        if (CONSTRUCTOR_ONLY_OPTIONS.indexOf(key) !== -1) {\n            console.error(\"Option \\\"\" + key + \"\\\" can only be set in the constructor\");\n        }\n        if (this.options[key] === value) {\n            return;\n        }\n        switch (key) {\n            case 'bellStyle':\n                if (!value) {\n                    value = 'none';\n                }\n                break;\n            case 'cursorStyle':\n                if (!value) {\n                    value = 'block';\n                }\n                break;\n            case 'fontWeight':\n                if (!value) {\n                    value = 'normal';\n                }\n                break;\n            case 'fontWeightBold':\n                if (!value) {\n                    value = 'bold';\n                }\n                break;\n            case 'lineHeight':\n                if (value < 1) {\n                    console.warn(key + \" cannot be less than 1, value: \" + value);\n                    return;\n                }\n            case 'rendererType':\n                if (!value) {\n                    value = 'canvas';\n                }\n                break;\n            case 'tabStopWidth':\n                if (value < 1) {\n                    console.warn(key + \" cannot be less than 1, value: \" + value);\n                    return;\n                }\n                break;\n            case 'theme':\n                if (this.renderer) {\n                    this._setTheme(value);\n                    return;\n                }\n                break;\n            case 'scrollback':\n                value = Math.min(value, Buffer_1.MAX_BUFFER_SIZE);\n                if (value < 0) {\n                    console.warn(key + \" cannot be less than 0, value: \" + value);\n                    return;\n                }\n                if (this.options[key] !== value) {\n                    var newBufferLength = this.rows + value;\n                    if (this.buffer.lines.length > newBufferLength) {\n                        var amountToTrim = this.buffer.lines.length - newBufferLength;\n                        var needsRefresh = (this.buffer.ydisp - amountToTrim < 0);\n                        this.buffer.lines.trimStart(amountToTrim);\n                        this.buffer.ybase = Math.max(this.buffer.ybase - amountToTrim, 0);\n                        this.buffer.ydisp = Math.max(this.buffer.ydisp - amountToTrim, 0);\n                        if (needsRefresh) {\n                            this.refresh(0, this.rows - 1);\n                        }\n                    }\n                }\n                break;\n        }\n        this.options[key] = value;\n        switch (key) {\n            case 'fontFamily':\n            case 'fontSize':\n                if (this.renderer) {\n                    this.renderer.clear();\n                    this.charMeasure.measure(this.options);\n                }\n                break;\n            case 'drawBoldTextInBrightColors':\n            case 'experimentalCharAtlas':\n            case 'enableBold':\n            case 'letterSpacing':\n            case 'lineHeight':\n            case 'fontWeight':\n            case 'fontWeightBold':\n                if (this.renderer) {\n                    this.renderer.clear();\n                    this.renderer.onResize(this.cols, this.rows);\n                    this.refresh(0, this.rows - 1);\n                }\n                break;\n            case 'rendererType':\n                if (this.renderer) {\n                    this.unregister(this.renderer);\n                    this.renderer.dispose();\n                    this.renderer = null;\n                }\n                this._setupRenderer();\n                this.renderer.onCharSizeChanged();\n                if (this._theme) {\n                    this.renderer.setTheme(this._theme);\n                }\n                this.mouseHelper.setRenderer(this.renderer);\n                break;\n            case 'scrollback':\n                this.buffers.resize(this.cols, this.rows);\n                if (this.viewport) {\n                    this.viewport.syncScrollArea();\n                }\n                break;\n            case 'screenReaderMode':\n                if (value) {\n                    if (!this._accessibilityManager) {\n                        this._accessibilityManager = new AccessibilityManager_1.AccessibilityManager(this);\n                    }\n                }\n                else {\n                    if (this._accessibilityManager) {\n                        this._accessibilityManager.dispose();\n                        this._accessibilityManager = null;\n                    }\n                }\n                break;\n            case 'tabStopWidth':\n                this.buffers.setupTabStops();\n                break;\n            case 'windowsMode':\n                if (value) {\n                    if (!this._windowsMode) {\n                        this._windowsMode = WindowsMode_1.applyWindowsMode(this);\n                    }\n                }\n                else {\n                    if (this._windowsMode) {\n                        this._windowsMode.dispose();\n                        this._windowsMode = undefined;\n                    }\n                }\n                break;\n        }\n        if (this.renderer) {\n            this.renderer.onOptionsChanged();\n        }\n    };\n    Terminal.prototype._onTextAreaFocus = function (ev) {\n        if (this.sendFocus) {\n            this.handler(EscapeSequences_1.C0.ESC + '[I');\n        }\n        this.updateCursorStyle(ev);\n        this.element.classList.add('focus');\n        this.showCursor();\n        this.emit('focus');\n    };\n    Terminal.prototype.blur = function () {\n        return this.textarea.blur();\n    };\n    Terminal.prototype._onTextAreaBlur = function () {\n        this.textarea.value = '';\n        this.refresh(this.buffer.y, this.buffer.y);\n        if (this.sendFocus) {\n            this.handler(EscapeSequences_1.C0.ESC + '[O');\n        }\n        this.element.classList.remove('focus');\n        this.emit('blur');\n    };\n    Terminal.prototype._initGlobal = function () {\n        var _this = this;\n        this._bindKeys();\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'copy', function (event) {\n            if (!_this.hasSelection()) {\n                return;\n            }\n            Clipboard_1.copyHandler(event, _this, _this.selectionManager);\n        }));\n        var pasteHandlerWrapper = function (event) { return Clipboard_1.pasteHandler(event, _this); };\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'paste', pasteHandlerWrapper));\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'paste', pasteHandlerWrapper));\n        if (Browser.isFirefox) {\n            this.register(Lifecycle_1.addDisposableDomListener(this.element, 'mousedown', function (event) {\n                if (event.button === 2) {\n                    Clipboard_1.rightClickHandler(event, _this, _this.selectionManager, _this.options.rightClickSelectsWord);\n                }\n            }));\n        }\n        else {\n            this.register(Lifecycle_1.addDisposableDomListener(this.element, 'contextmenu', function (event) {\n                Clipboard_1.rightClickHandler(event, _this, _this.selectionManager, _this.options.rightClickSelectsWord);\n            }));\n        }\n        if (Browser.isLinux) {\n            this.register(Lifecycle_1.addDisposableDomListener(this.element, 'auxclick', function (event) {\n                if (event.button === 1) {\n                    Clipboard_1.moveTextAreaUnderMouseCursor(event, _this);\n                }\n            }));\n        }\n    };\n    Terminal.prototype._bindKeys = function () {\n        var _this = this;\n        var self = this;\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'keydown', function (ev) {\n            if (document.activeElement !== this) {\n                return;\n            }\n            self._keyDown(ev);\n        }, true));\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'keypress', function (ev) {\n            if (document.activeElement !== this) {\n                return;\n            }\n            self._keyPress(ev);\n        }, true));\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'keyup', function (ev) {\n            if (!wasModifierKeyOnlyEvent(ev)) {\n                _this.focus();\n            }\n            self._keyUp(ev);\n        }, true));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'keydown', function (ev) { return _this._keyDown(ev); }, true));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'keypress', function (ev) { return _this._keyPress(ev); }, true));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'compositionstart', function () { return _this._compositionHelper.compositionstart(); }));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'compositionupdate', function (e) { return _this._compositionHelper.compositionupdate(e); }));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'compositionend', function () { return _this._compositionHelper.compositionend(); }));\n        this.register(this.onRender(function () { return _this._compositionHelper.updateCompositionElements(); }));\n        this.register(this.onRender(function (e) { return _this._queueLinkification(e.start, e.end); }));\n    };\n    Terminal.prototype.open = function (parent) {\n        var _this = this;\n        this._parent = parent || this._parent;\n        if (!this._parent) {\n            throw new Error('Terminal requires a parent element.');\n        }\n        this._context = this._parent.ownerDocument.defaultView;\n        this._document = this._parent.ownerDocument;\n        this._screenDprMonitor = new ScreenDprMonitor_1.ScreenDprMonitor();\n        this._screenDprMonitor.setListener(function () { return _this.emit('dprchange', window.devicePixelRatio); });\n        this.register(this._screenDprMonitor);\n        this.element = this._document.createElement('div');\n        this.element.dir = 'ltr';\n        this.element.classList.add('terminal');\n        this.element.classList.add('xterm');\n        this.element.setAttribute('tabindex', '0');\n        this._parent.appendChild(this.element);\n        var fragment = document.createDocumentFragment();\n        this._viewportElement = document.createElement('div');\n        this._viewportElement.classList.add('xterm-viewport');\n        fragment.appendChild(this._viewportElement);\n        this._viewportScrollArea = document.createElement('div');\n        this._viewportScrollArea.classList.add('xterm-scroll-area');\n        this._viewportElement.appendChild(this._viewportScrollArea);\n        this.screenElement = document.createElement('div');\n        this.screenElement.classList.add('xterm-screen');\n        this._helperContainer = document.createElement('div');\n        this._helperContainer.classList.add('xterm-helpers');\n        this.screenElement.appendChild(this._helperContainer);\n        fragment.appendChild(this.screenElement);\n        this._mouseZoneManager = new MouseZoneManager_1.MouseZoneManager(this);\n        this.register(this._mouseZoneManager);\n        this.register(this.onScroll(function () { return _this._mouseZoneManager.clearAll(); }));\n        this.linkifier.attachToDom(this._mouseZoneManager);\n        this.textarea = document.createElement('textarea');\n        this.textarea.classList.add('xterm-helper-textarea');\n        this.textarea.setAttribute('aria-label', Strings.promptLabel);\n        this.textarea.setAttribute('aria-multiline', 'false');\n        this.textarea.setAttribute('autocorrect', 'off');\n        this.textarea.setAttribute('autocapitalize', 'off');\n        this.textarea.setAttribute('spellcheck', 'false');\n        this.textarea.tabIndex = 0;\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'focus', function (ev) { return _this._onTextAreaFocus(ev); }));\n        this.register(Lifecycle_1.addDisposableDomListener(this.textarea, 'blur', function () { return _this._onTextAreaBlur(); }));\n        this._helperContainer.appendChild(this.textarea);\n        this._compositionView = document.createElement('div');\n        this._compositionView.classList.add('composition-view');\n        this._compositionHelper = new CompositionHelper_1.CompositionHelper(this.textarea, this._compositionView, this);\n        this._helperContainer.appendChild(this._compositionView);\n        this.charMeasure = new CharMeasure_1.CharMeasure(document, this._helperContainer);\n        this.element.appendChild(fragment);\n        this._setupRenderer();\n        this._theme = this.options.theme;\n        this.options.theme = null;\n        this.viewport = new Viewport_1.Viewport(this, this._viewportElement, this._viewportScrollArea, this.charMeasure);\n        this.viewport.onThemeChanged(this.renderer.colorManager.colors);\n        this.register(this.viewport);\n        this.register(this.onCursorMove(function () { return _this.renderer.onCursorMove(); }));\n        this.register(this.onResize(function () { return _this.renderer.onResize(_this.cols, _this.rows); }));\n        this.register(this.addDisposableListener('blur', function () { return _this.renderer.onBlur(); }));\n        this.register(this.addDisposableListener('focus', function () { return _this.renderer.onFocus(); }));\n        this.register(this.addDisposableListener('dprchange', function () { return _this.renderer.onWindowResize(window.devicePixelRatio); }));\n        this.register(Lifecycle_1.addDisposableDomListener(window, 'resize', function () { return _this.renderer.onWindowResize(window.devicePixelRatio); }));\n        this.register(this.charMeasure.onCharSizeChanged(function () { return _this.renderer.onCharSizeChanged(); }));\n        this.register(this.renderer.onCanvasResize(function () { return _this.viewport.syncScrollArea(); }));\n        this.selectionManager = new SelectionManager_1.SelectionManager(this, this.charMeasure);\n        this.register(this.selectionManager.onSelectionChange(function () { return _this._onSelectionChange.fire(); }));\n        this.register(Lifecycle_1.addDisposableDomListener(this.element, 'mousedown', function (e) { return _this.selectionManager.onMouseDown(e); }));\n        this.register(this.selectionManager.onRedrawRequest(function (e) { return _this.renderer.onSelectionChanged(e.start, e.end, e.columnSelectMode); }));\n        this.register(this.selectionManager.onLinuxMouseSelection(function (text) {\n            _this.textarea.value = text;\n            _this.textarea.focus();\n            _this.textarea.select();\n        }));\n        this.register(this.onScroll(function () {\n            _this.viewport.syncScrollArea();\n            _this.selectionManager.refresh();\n        }));\n        this.register(Lifecycle_1.addDisposableDomListener(this._viewportElement, 'scroll', function () { return _this.selectionManager.refresh(); }));\n        this.mouseHelper = new MouseHelper_1.MouseHelper(this.renderer);\n        this.element.classList.toggle('enable-mouse-events', this.mouseEvents);\n        if (this.mouseEvents) {\n            this.selectionManager.disable();\n        }\n        else {\n            this.selectionManager.enable();\n        }\n        if (this.options.screenReaderMode) {\n            this._accessibilityManager = new AccessibilityManager_1.AccessibilityManager(this);\n        }\n        this.charMeasure.measure(this.options);\n        this.refresh(0, this.rows - 1);\n        this._initGlobal();\n        this.bindMouse();\n    };\n    Terminal.prototype._setupRenderer = function () {\n        var _this = this;\n        switch (this.options.rendererType) {\n            case 'canvas':\n                this.renderer = new Renderer_1.Renderer(this, this.options.theme);\n                break;\n            case 'dom':\n                this.renderer = new DomRenderer_1.DomRenderer(this, this.options.theme);\n                break;\n            default: throw new Error(\"Unrecognized rendererType \\\"\" + this.options.rendererType + \"\\\"\");\n        }\n        this.renderer.onRender(function (e) { return _this._onRender.fire(e); });\n        this.register(this.renderer);\n    };\n    Terminal.prototype._setTheme = function (theme) {\n        this._theme = theme;\n        var colors = this.renderer.setTheme(theme);\n        if (this.viewport) {\n            this.viewport.onThemeChanged(colors);\n        }\n    };\n    Terminal.prototype.bindMouse = function () {\n        var _this = this;\n        var el = this.element;\n        var self = this;\n        var pressed = 32;\n        function sendButton(ev) {\n            var button;\n            var pos;\n            button = getButton(ev);\n            pos = self.mouseHelper.getRawByteCoords(ev, self.screenElement, self.charMeasure, self.cols, self.rows);\n            if (!pos)\n                return;\n            sendEvent(button, pos);\n            switch (ev.overrideType || ev.type) {\n                case 'mousedown':\n                    pressed = button;\n                    break;\n                case 'mouseup':\n                    pressed = 32;\n                    break;\n                case 'wheel':\n                    break;\n            }\n        }\n        function sendMove(ev) {\n            var button = pressed;\n            var pos = self.mouseHelper.getRawByteCoords(ev, self.screenElement, self.charMeasure, self.cols, self.rows);\n            if (!pos)\n                return;\n            button += 32;\n            sendEvent(button, pos);\n        }\n        function encode(data, ch) {\n            if (!self.utfMouse) {\n                if (ch === 255) {\n                    data.push(0);\n                    return;\n                }\n                if (ch > 127)\n                    ch = 127;\n                data.push(ch);\n            }\n            else {\n                if (ch > 2047) {\n                    data.push(2047);\n                    return;\n                }\n                data.push(ch);\n            }\n        }\n        function sendEvent(button, pos) {\n            if (self._vt300Mouse) {\n                button &= 3;\n                pos.x -= 32;\n                pos.y -= 32;\n                var data_1 = EscapeSequences_1.C0.ESC + '[24';\n                if (button === 0)\n                    data_1 += '1';\n                else if (button === 1)\n                    data_1 += '3';\n                else if (button === 2)\n                    data_1 += '5';\n                else if (button === 3)\n                    return;\n                else\n                    data_1 += '0';\n                data_1 += '~[' + pos.x + ',' + pos.y + ']\\r';\n                self.handler(data_1);\n                return;\n            }\n            if (self._decLocator) {\n                button &= 3;\n                pos.x -= 32;\n                pos.y -= 32;\n                if (button === 0)\n                    button = 2;\n                else if (button === 1)\n                    button = 4;\n                else if (button === 2)\n                    button = 6;\n                else if (button === 3)\n                    button = 3;\n                self.handler(EscapeSequences_1.C0.ESC + '['\n                    + button\n                    + ';'\n                    + (button === 3 ? 4 : 0)\n                    + ';'\n                    + pos.y\n                    + ';'\n                    + pos.x\n                    + ';'\n                    + pos.page || 0\n                    + '&w');\n                return;\n            }\n            if (self.urxvtMouse) {\n                pos.x -= 32;\n                pos.y -= 32;\n                pos.x++;\n                pos.y++;\n                self.handler(EscapeSequences_1.C0.ESC + '[' + button + ';' + pos.x + ';' + pos.y + 'M');\n                return;\n            }\n            if (self.sgrMouse) {\n                pos.x -= 32;\n                pos.y -= 32;\n                self.handler(EscapeSequences_1.C0.ESC + '[<'\n                    + (((button & 3) === 3 ? button & ~3 : button) - 32)\n                    + ';'\n                    + pos.x\n                    + ';'\n                    + pos.y\n                    + ((button & 3) === 3 ? 'm' : 'M'));\n                return;\n            }\n            var data = [];\n            encode(data, button);\n            encode(data, pos.x);\n            encode(data, pos.y);\n            self.handler(EscapeSequences_1.C0.ESC + '[M' + String.fromCharCode.apply(String, data));\n        }\n        function getButton(ev) {\n            var button;\n            var shift;\n            var meta;\n            var ctrl;\n            var mod;\n            switch (ev.overrideType || ev.type) {\n                case 'mousedown':\n                    button = ev.button !== null && ev.button !== undefined\n                        ? +ev.button\n                        : ev.which !== null && ev.which !== undefined\n                            ? ev.which - 1\n                            : null;\n                    if (Browser.isMSIE) {\n                        button = button === 1 ? 0 : button === 4 ? 1 : button;\n                    }\n                    break;\n                case 'mouseup':\n                    button = 3;\n                    break;\n                case 'DOMMouseScroll':\n                    button = ev.detail < 0\n                        ? 64\n                        : 65;\n                    break;\n                case 'wheel':\n                    button = ev.deltaY < 0\n                        ? 64\n                        : 65;\n                    break;\n            }\n            shift = ev.shiftKey ? 4 : 0;\n            meta = ev.metaKey ? 8 : 0;\n            ctrl = ev.ctrlKey ? 16 : 0;\n            mod = shift | meta | ctrl;\n            if (self.vt200Mouse) {\n                mod &= ctrl;\n            }\n            else if (!self.normalMouse) {\n                mod = 0;\n            }\n            button = (32 + (mod << 2)) + button;\n            return button;\n        }\n        this.register(Lifecycle_1.addDisposableDomListener(el, 'mousedown', function (ev) {\n            ev.preventDefault();\n            _this.focus();\n            if (!_this.mouseEvents || _this.selectionManager.shouldForceSelection(ev)) {\n                return;\n            }\n            sendButton(ev);\n            if (_this.vt200Mouse) {\n                ev.overrideType = 'mouseup';\n                sendButton(ev);\n                return _this.cancel(ev);\n            }\n            var moveHandler;\n            if (_this.normalMouse) {\n                moveHandler = function (event) {\n                    if (!_this.normalMouse) {\n                        return;\n                    }\n                    sendMove(event);\n                };\n                _this._document.addEventListener('mousemove', moveHandler);\n            }\n            var handler = function (ev) {\n                if (_this.normalMouse && !_this.x10Mouse) {\n                    sendButton(ev);\n                }\n                if (moveHandler) {\n                    _this._document.removeEventListener('mousemove', moveHandler);\n                    moveHandler = null;\n                }\n                _this._document.removeEventListener('mouseup', handler);\n                return _this.cancel(ev);\n            };\n            _this._document.addEventListener('mouseup', handler);\n            return _this.cancel(ev);\n        }));\n        this.register(Lifecycle_1.addDisposableDomListener(el, 'wheel', function (ev) {\n            if (!_this.mouseEvents) {\n                if (!_this.buffer.hasScrollback) {\n                    var amount = _this.viewport.getLinesScrolled(ev);\n                    if (amount === 0) {\n                        return;\n                    }\n                    var sequence = EscapeSequences_1.C0.ESC + (_this.applicationCursor ? 'O' : '[') + (ev.deltaY < 0 ? 'A' : 'B');\n                    var data = '';\n                    for (var i = 0; i < Math.abs(amount); i++) {\n                        data += sequence;\n                    }\n                    _this.handler(data);\n                }\n                return;\n            }\n            if (_this.x10Mouse || _this._vt300Mouse || _this._decLocator)\n                return;\n            sendButton(ev);\n            ev.preventDefault();\n        }));\n        this.register(Lifecycle_1.addDisposableDomListener(el, 'wheel', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onWheel(ev);\n            return _this.cancel(ev);\n        }));\n        this.register(Lifecycle_1.addDisposableDomListener(el, 'touchstart', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onTouchStart(ev);\n            return _this.cancel(ev);\n        }));\n        this.register(Lifecycle_1.addDisposableDomListener(el, 'touchmove', function (ev) {\n            if (_this.mouseEvents)\n                return;\n            _this.viewport.onTouchMove(ev);\n            return _this.cancel(ev);\n        }));\n    };\n    Terminal.prototype.refresh = function (start, end) {\n        if (this.renderer) {\n            this.renderer.refreshRows(start, end);\n        }\n    };\n    Terminal.prototype._queueLinkification = function (start, end) {\n        if (this.linkifier) {\n            this.linkifier.linkifyRows(start, end);\n        }\n    };\n    Terminal.prototype.updateCursorStyle = function (ev) {\n        if (this.selectionManager && this.selectionManager.shouldColumnSelect(ev)) {\n            this.element.classList.add('column-select');\n        }\n        else {\n            this.element.classList.remove('column-select');\n        }\n    };\n    Terminal.prototype.showCursor = function () {\n        if (!this.cursorState) {\n            this.cursorState = 1;\n            this.refresh(this.buffer.y, this.buffer.y);\n        }\n    };\n    Terminal.prototype.scroll = function (isWrapped) {\n        if (isWrapped === void 0) { isWrapped = false; }\n        var newLine;\n        newLine = this._blankLine;\n        var eraseAttr = this.eraseAttrData();\n        if (!newLine || newLine.length !== this.cols || newLine.getFg(0) !== eraseAttr.fg || newLine.getBg(0) !== eraseAttr.bg) {\n            newLine = this.buffer.getBlankLine(eraseAttr, isWrapped);\n            this._blankLine = newLine;\n        }\n        newLine.isWrapped = isWrapped;\n        var topRow = this.buffer.ybase + this.buffer.scrollTop;\n        var bottomRow = this.buffer.ybase + this.buffer.scrollBottom;\n        if (this.buffer.scrollTop === 0) {\n            var willBufferBeTrimmed = this.buffer.lines.isFull;\n            if (bottomRow === this.buffer.lines.length - 1) {\n                if (willBufferBeTrimmed) {\n                    this.buffer.lines.recycle().copyFrom(newLine);\n                }\n                else {\n                    this.buffer.lines.push(newLine.clone());\n                }\n            }\n            else {\n                this.buffer.lines.splice(bottomRow + 1, 0, newLine.clone());\n            }\n            if (!willBufferBeTrimmed) {\n                this.buffer.ybase++;\n                if (!this._userScrolling) {\n                    this.buffer.ydisp++;\n                }\n            }\n            else {\n                if (this._userScrolling) {\n                    this.buffer.ydisp = Math.max(this.buffer.ydisp - 1, 0);\n                }\n            }\n        }\n        else {\n            var scrollRegionHeight = bottomRow - topRow + 1;\n            this.buffer.lines.shiftElements(topRow + 1, scrollRegionHeight - 1, -1);\n            this.buffer.lines.set(bottomRow, newLine.clone());\n        }\n        if (!this._userScrolling) {\n            this.buffer.ydisp = this.buffer.ybase;\n        }\n        this.updateRange(this.buffer.scrollTop);\n        this.updateRange(this.buffer.scrollBottom);\n        this._onScroll.fire(this.buffer.ydisp);\n    };\n    Terminal.prototype.scrollLines = function (disp, suppressScrollEvent) {\n        if (disp < 0) {\n            if (this.buffer.ydisp === 0) {\n                return;\n            }\n            this._userScrolling = true;\n        }\n        else if (disp + this.buffer.ydisp >= this.buffer.ybase) {\n            this._userScrolling = false;\n        }\n        var oldYdisp = this.buffer.ydisp;\n        this.buffer.ydisp = Math.max(Math.min(this.buffer.ydisp + disp, this.buffer.ybase), 0);\n        if (oldYdisp === this.buffer.ydisp) {\n            return;\n        }\n        if (!suppressScrollEvent) {\n            this._onScroll.fire(this.buffer.ydisp);\n        }\n        this.refresh(0, this.rows - 1);\n    };\n    Terminal.prototype.scrollPages = function (pageCount) {\n        this.scrollLines(pageCount * (this.rows - 1));\n    };\n    Terminal.prototype.scrollToTop = function () {\n        this.scrollLines(-this.buffer.ydisp);\n    };\n    Terminal.prototype.scrollToBottom = function () {\n        this.scrollLines(this.buffer.ybase - this.buffer.ydisp);\n    };\n    Terminal.prototype.scrollToLine = function (line) {\n        var scrollAmount = line - this.buffer.ydisp;\n        if (scrollAmount !== 0) {\n            this.scrollLines(scrollAmount);\n        }\n    };\n    Terminal.prototype.write = function (data) {\n        var _this = this;\n        if (this._isDisposed) {\n            return;\n        }\n        if (!data) {\n            return;\n        }\n        this.writeBuffer.push(data);\n        if (this.options.useFlowControl && !this._xoffSentToCatchUp && this.writeBuffer.length >= WRITE_BUFFER_PAUSE_THRESHOLD) {\n            this.handler(EscapeSequences_1.C0.DC3);\n            this._xoffSentToCatchUp = true;\n        }\n        if (!this._writeInProgress && this.writeBuffer.length > 0) {\n            this._writeInProgress = true;\n            setTimeout(function () {\n                _this._innerWrite();\n            });\n        }\n    };\n    Terminal.prototype._innerWrite = function (bufferOffset) {\n        var _this = this;\n        if (bufferOffset === void 0) { bufferOffset = 0; }\n        if (this._isDisposed) {\n            this.writeBuffer = [];\n        }\n        var startTime = Date.now();\n        while (this.writeBuffer.length > bufferOffset) {\n            var data = this.writeBuffer[bufferOffset];\n            bufferOffset++;\n            if (this._xoffSentToCatchUp && this.writeBuffer.length === bufferOffset) {\n                this.handler(EscapeSequences_1.C0.DC1);\n                this._xoffSentToCatchUp = false;\n            }\n            this._refreshStart = this.buffer.y;\n            this._refreshEnd = this.buffer.y;\n            this._inputHandler.parse(data);\n            this.updateRange(this.buffer.y);\n            this.refresh(this._refreshStart, this._refreshEnd);\n            if (Date.now() - startTime >= WRITE_TIMEOUT_MS) {\n                break;\n            }\n        }\n        if (this.writeBuffer.length > bufferOffset) {\n            setTimeout(function () { return _this._innerWrite(bufferOffset); }, 0);\n        }\n        else {\n            this._writeInProgress = false;\n            this.writeBuffer = [];\n        }\n    };\n    Terminal.prototype.writeln = function (data) {\n        this.write(data + '\\r\\n');\n    };\n    Terminal.prototype.attachCustomKeyEventHandler = function (customKeyEventHandler) {\n        this._customKeyEventHandler = customKeyEventHandler;\n    };\n    Terminal.prototype.addCsiHandler = function (flag, callback) {\n        return this._inputHandler.addCsiHandler(flag, callback);\n    };\n    Terminal.prototype.addOscHandler = function (ident, callback) {\n        return this._inputHandler.addOscHandler(ident, callback);\n    };\n    Terminal.prototype.registerLinkMatcher = function (regex, handler, options) {\n        var matcherId = this.linkifier.registerLinkMatcher(regex, handler, options);\n        this.refresh(0, this.rows - 1);\n        return matcherId;\n    };\n    Terminal.prototype.deregisterLinkMatcher = function (matcherId) {\n        if (this.linkifier.deregisterLinkMatcher(matcherId)) {\n            this.refresh(0, this.rows - 1);\n        }\n    };\n    Terminal.prototype.registerCharacterJoiner = function (handler) {\n        var joinerId = this.renderer.registerCharacterJoiner(handler);\n        this.refresh(0, this.rows - 1);\n        return joinerId;\n    };\n    Terminal.prototype.deregisterCharacterJoiner = function (joinerId) {\n        if (this.renderer.deregisterCharacterJoiner(joinerId)) {\n            this.refresh(0, this.rows - 1);\n        }\n    };\n    Object.defineProperty(Terminal.prototype, \"markers\", {\n        get: function () {\n            return this.buffer.markers;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Terminal.prototype.addMarker = function (cursorYOffset) {\n        if (this.buffer !== this.buffers.normal) {\n            return;\n        }\n        return this.buffer.addMarker(this.buffer.ybase + this.buffer.y + cursorYOffset);\n    };\n    Terminal.prototype.hasSelection = function () {\n        return this.selectionManager ? this.selectionManager.hasSelection : false;\n    };\n    Terminal.prototype.getSelection = function () {\n        return this.selectionManager ? this.selectionManager.selectionText : '';\n    };\n    Terminal.prototype.clearSelection = function () {\n        if (this.selectionManager) {\n            this.selectionManager.clearSelection();\n        }\n    };\n    Terminal.prototype.selectAll = function () {\n        if (this.selectionManager) {\n            this.selectionManager.selectAll();\n        }\n    };\n    Terminal.prototype.selectLines = function (start, end) {\n        if (this.selectionManager) {\n            this.selectionManager.selectLines(start, end);\n        }\n    };\n    Terminal.prototype._keyDown = function (event) {\n        if (this._customKeyEventHandler && this._customKeyEventHandler(event) === false) {\n            return false;\n        }\n        if (!this._compositionHelper.keydown(event)) {\n            if (this.buffer.ybase !== this.buffer.ydisp) {\n                this.scrollToBottom();\n            }\n            return false;\n        }\n        var result = Keyboard_1.evaluateKeyboardEvent(event, this.applicationCursor, this.browser.isMac, this.options.macOptionIsMeta);\n        this.updateCursorStyle(event);\n        if (result.type === 3 || result.type === 2) {\n            var scrollCount = this.rows - 1;\n            this.scrollLines(result.type === 2 ? -scrollCount : scrollCount);\n            return this.cancel(event, true);\n        }\n        if (result.type === 1) {\n            this.selectAll();\n        }\n        if (this._isThirdLevelShift(this.browser, event)) {\n            return true;\n        }\n        if (result.cancel) {\n            this.cancel(event, true);\n        }\n        if (!result.key) {\n            return true;\n        }\n        this.emit('keydown', event);\n        this._onKey.fire({ key: result.key, domEvent: event });\n        this.showCursor();\n        this.handler(result.key);\n        return this.cancel(event, true);\n    };\n    Terminal.prototype._isThirdLevelShift = function (browser, ev) {\n        var thirdLevelKey = (browser.isMac && !this.options.macOptionIsMeta && ev.altKey && !ev.ctrlKey && !ev.metaKey) ||\n            (browser.isMSWindows && ev.altKey && ev.ctrlKey && !ev.metaKey);\n        if (ev.type === 'keypress') {\n            return thirdLevelKey;\n        }\n        return thirdLevelKey && (!ev.keyCode || ev.keyCode > 47);\n    };\n    Terminal.prototype.setgLevel = function (g) {\n        this.glevel = g;\n        this.charset = this.charsets[g];\n    };\n    Terminal.prototype.setgCharset = function (g, charset) {\n        this.charsets[g] = charset;\n        if (this.glevel === g) {\n            this.charset = charset;\n        }\n    };\n    Terminal.prototype._keyUp = function (ev) {\n        this.updateCursorStyle(ev);\n    };\n    Terminal.prototype._keyPress = function (ev) {\n        var key;\n        if (this._customKeyEventHandler && this._customKeyEventHandler(ev) === false) {\n            return false;\n        }\n        this.cancel(ev);\n        if (ev.charCode) {\n            key = ev.charCode;\n        }\n        else if (ev.which === null || ev.which === undefined) {\n            key = ev.keyCode;\n        }\n        else if (ev.which !== 0 && ev.charCode !== 0) {\n            key = ev.which;\n        }\n        else {\n            return false;\n        }\n        if (!key || ((ev.altKey || ev.ctrlKey || ev.metaKey) && !this._isThirdLevelShift(this.browser, ev))) {\n            return false;\n        }\n        key = String.fromCharCode(key);\n        this.emit('keypress', key, ev);\n        this._onKey.fire({ key: key, domEvent: ev });\n        this.showCursor();\n        this.handler(key);\n        return true;\n    };\n    Terminal.prototype.bell = function () {\n        var _this = this;\n        this.emit('bell');\n        if (this._soundBell()) {\n            this.soundManager.playBellSound();\n        }\n        if (this._visualBell()) {\n            this.element.classList.add('visual-bell-active');\n            clearTimeout(this._visualBellTimer);\n            this._visualBellTimer = window.setTimeout(function () {\n                _this.element.classList.remove('visual-bell-active');\n            }, 200);\n        }\n    };\n    Terminal.prototype.log = function (text, data) {\n        if (!this.options.debug)\n            return;\n        if (!this._context.console || !this._context.console.log)\n            return;\n        this._context.console.log(text, data);\n    };\n    Terminal.prototype.error = function (text, data) {\n        if (!this.options.debug)\n            return;\n        if (!this._context.console || !this._context.console.error)\n            return;\n        this._context.console.error(text, data);\n    };\n    Terminal.prototype.resize = function (x, y) {\n        if (isNaN(x) || isNaN(y)) {\n            return;\n        }\n        if (x === this.cols && y === this.rows) {\n            if (this.charMeasure && (!this.charMeasure.width || !this.charMeasure.height)) {\n                this.charMeasure.measure(this.options);\n            }\n            return;\n        }\n        if (x < MINIMUM_COLS)\n            x = MINIMUM_COLS;\n        if (y < MINIMUM_ROWS)\n            y = MINIMUM_ROWS;\n        this.buffers.resize(x, y);\n        this.cols = x;\n        this.rows = y;\n        this.buffers.setupTabStops(this.cols);\n        if (this.charMeasure) {\n            this.charMeasure.measure(this.options);\n        }\n        this.refresh(0, this.rows - 1);\n        this._onResize.fire({ cols: x, rows: y });\n    };\n    Terminal.prototype.updateRange = function (y) {\n        if (y < this._refreshStart)\n            this._refreshStart = y;\n        if (y > this._refreshEnd)\n            this._refreshEnd = y;\n    };\n    Terminal.prototype.maxRange = function () {\n        this._refreshStart = 0;\n        this._refreshEnd = this.rows - 1;\n    };\n    Terminal.prototype.clear = function () {\n        if (this.buffer.ybase === 0 && this.buffer.y === 0) {\n            return;\n        }\n        this.buffer.lines.set(0, this.buffer.lines.get(this.buffer.ybase + this.buffer.y));\n        this.buffer.lines.length = 1;\n        this.buffer.ydisp = 0;\n        this.buffer.ybase = 0;\n        this.buffer.y = 0;\n        for (var i = 1; i < this.rows; i++) {\n            this.buffer.lines.push(this.buffer.getBlankLine(Buffer_1.DEFAULT_ATTR_DATA));\n        }\n        this.refresh(0, this.rows - 1);\n        this._onScroll.fire(this.buffer.ydisp);\n    };\n    Terminal.prototype.is = function (term) {\n        return (this.options.termName + '').indexOf(term) === 0;\n    };\n    Terminal.prototype.handler = function (data) {\n        if (this.options.disableStdin) {\n            return;\n        }\n        if (this.selectionManager && this.selectionManager.hasSelection) {\n            this.selectionManager.clearSelection();\n        }\n        if (this.buffer.ybase !== this.buffer.ydisp) {\n            this.scrollToBottom();\n        }\n        this._onData.fire(data);\n    };\n    Terminal.prototype.handleTitle = function (title) {\n        this._onTitleChange.fire(title);\n    };\n    Terminal.prototype.index = function () {\n        this.buffer.y++;\n        if (this.buffer.y > this.buffer.scrollBottom) {\n            this.buffer.y--;\n            this.scroll();\n        }\n        if (this.buffer.x >= this.cols) {\n            this.buffer.x--;\n        }\n    };\n    Terminal.prototype.reverseIndex = function () {\n        if (this.buffer.y === this.buffer.scrollTop) {\n            var scrollRegionHeight = this.buffer.scrollBottom - this.buffer.scrollTop;\n            this.buffer.lines.shiftElements(this.buffer.y + this.buffer.ybase, scrollRegionHeight, 1);\n            this.buffer.lines.set(this.buffer.y + this.buffer.ybase, this.buffer.getBlankLine(this.eraseAttrData()));\n            this.updateRange(this.buffer.scrollTop);\n            this.updateRange(this.buffer.scrollBottom);\n        }\n        else {\n            this.buffer.y--;\n        }\n    };\n    Terminal.prototype.reset = function () {\n        this.options.rows = this.rows;\n        this.options.cols = this.cols;\n        var customKeyEventHandler = this._customKeyEventHandler;\n        var inputHandler = this._inputHandler;\n        var cursorState = this.cursorState;\n        this._setup();\n        this._customKeyEventHandler = customKeyEventHandler;\n        this._inputHandler = inputHandler;\n        this.cursorState = cursorState;\n        this.refresh(0, this.rows - 1);\n        if (this.viewport) {\n            this.viewport.syncScrollArea();\n        }\n    };\n    Terminal.prototype.tabSet = function () {\n        this.buffer.tabs[this.buffer.x] = true;\n    };\n    Terminal.prototype.cancel = function (ev, force) {\n        if (!this.options.cancelEvents && !force) {\n            return;\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n        return false;\n    };\n    Terminal.prototype._visualBell = function () {\n        return false;\n    };\n    Terminal.prototype._soundBell = function () {\n        return this.options.bellStyle === 'sound';\n    };\n    return Terminal;\n}(EventEmitter_1.EventEmitter));\nexports.Terminal = Terminal;\nfunction wasModifierKeyOnlyEvent(ev) {\n    return ev.keyCode === 16 ||\n        ev.keyCode === 17 ||\n        ev.keyCode === 18;\n}\n//# sourceMappingURL=Terminal.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EscapeSequences_1 = require(\"../common/data/EscapeSequences\");\nvar AltClickHandler = (function () {\n    function AltClickHandler(_mouseEvent, _terminal) {\n        var _a;\n        this._mouseEvent = _mouseEvent;\n        this._terminal = _terminal;\n        this._lines = this._terminal.buffer.lines;\n        this._startCol = this._terminal.buffer.x;\n        this._startRow = this._terminal.buffer.y;\n        var coordinates = this._terminal.mouseHelper.getCoords(this._mouseEvent, this._terminal.element, this._terminal.charMeasure, this._terminal.cols, this._terminal.rows, false);\n        if (coordinates) {\n            _a = coordinates.map(function (coordinate) {\n                return coordinate - 1;\n            }), this._endCol = _a[0], this._endRow = _a[1];\n        }\n    }\n    AltClickHandler.prototype.move = function () {\n        if (this._mouseEvent.altKey && this._endCol !== undefined && this._endRow !== undefined) {\n            this._terminal.handler(this._arrowSequences());\n        }\n    };\n    AltClickHandler.prototype._arrowSequences = function () {\n        if (!this._terminal.buffer.hasScrollback) {\n            return this._resetStartingRow() + this._moveToRequestedRow() + this._moveToRequestedCol();\n        }\n        return this._moveHorizontallyOnly();\n    };\n    AltClickHandler.prototype._resetStartingRow = function () {\n        if (this._moveToRequestedRow().length === 0) {\n            return '';\n        }\n        return repeat(this._bufferLine(this._startCol, this._startRow, this._startCol, this._startRow - this._wrappedRowsForRow(this._startRow), false).length, this._sequence(\"D\"));\n    };\n    AltClickHandler.prototype._moveToRequestedRow = function () {\n        var startRow = this._startRow - this._wrappedRowsForRow(this._startRow);\n        var endRow = this._endRow - this._wrappedRowsForRow(this._endRow);\n        var rowsToMove = Math.abs(startRow - endRow) - this._wrappedRowsCount();\n        return repeat(rowsToMove, this._sequence(this._verticalDirection()));\n    };\n    AltClickHandler.prototype._moveToRequestedCol = function () {\n        var startRow;\n        if (this._moveToRequestedRow().length > 0) {\n            startRow = this._endRow - this._wrappedRowsForRow(this._endRow);\n        }\n        else {\n            startRow = this._startRow;\n        }\n        var endRow = this._endRow;\n        var direction = this._horizontalDirection();\n        return repeat(this._bufferLine(this._startCol, startRow, this._endCol, endRow, direction === \"C\").length, this._sequence(direction));\n    };\n    AltClickHandler.prototype._moveHorizontallyOnly = function () {\n        var direction = this._horizontalDirection();\n        return repeat(Math.abs(this._startCol - this._endCol), this._sequence(direction));\n    };\n    AltClickHandler.prototype._wrappedRowsCount = function () {\n        var wrappedRows = 0;\n        var startRow = this._startRow - this._wrappedRowsForRow(this._startRow);\n        var endRow = this._endRow - this._wrappedRowsForRow(this._endRow);\n        for (var i = 0; i < Math.abs(startRow - endRow); i++) {\n            var direction = this._verticalDirection() === \"A\" ? -1 : 1;\n            if (this._lines.get(startRow + (direction * i)).isWrapped) {\n                wrappedRows++;\n            }\n        }\n        return wrappedRows;\n    };\n    AltClickHandler.prototype._wrappedRowsForRow = function (currentRow) {\n        var rowCount = 0;\n        var lineWraps = this._lines.get(currentRow).isWrapped;\n        while (lineWraps && currentRow >= 0 && currentRow < this._terminal.rows) {\n            rowCount++;\n            currentRow--;\n            lineWraps = this._lines.get(currentRow).isWrapped;\n        }\n        return rowCount;\n    };\n    AltClickHandler.prototype._horizontalDirection = function () {\n        var startRow;\n        if (this._moveToRequestedRow().length > 0) {\n            startRow = this._endRow - this._wrappedRowsForRow(this._endRow);\n        }\n        else {\n            startRow = this._startRow;\n        }\n        if ((this._startCol < this._endCol &&\n            startRow <= this._endRow) ||\n            (this._startCol >= this._endCol &&\n                startRow < this._endRow)) {\n            return \"C\";\n        }\n        return \"D\";\n    };\n    AltClickHandler.prototype._verticalDirection = function () {\n        if (this._startRow > this._endRow) {\n            return \"A\";\n        }\n        return \"B\";\n    };\n    AltClickHandler.prototype._bufferLine = function (startCol, startRow, endCol, endRow, forward) {\n        var currentCol = startCol;\n        var currentRow = startRow;\n        var bufferStr = '';\n        while (currentCol !== endCol || currentRow !== endRow) {\n            currentCol += forward ? 1 : -1;\n            if (forward && currentCol > this._terminal.cols - 1) {\n                bufferStr += this._terminal.buffer.translateBufferLineToString(currentRow, false, startCol, currentCol);\n                currentCol = 0;\n                startCol = 0;\n                currentRow++;\n            }\n            else if (!forward && currentCol < 0) {\n                bufferStr += this._terminal.buffer.translateBufferLineToString(currentRow, false, 0, startCol + 1);\n                currentCol = this._terminal.cols - 1;\n                startCol = currentCol;\n                currentRow--;\n            }\n        }\n        return bufferStr + this._terminal.buffer.translateBufferLineToString(currentRow, false, startCol, currentCol);\n    };\n    AltClickHandler.prototype._sequence = function (direction) {\n        var mod = this._terminal.applicationCursor ? 'O' : '[';\n        return EscapeSequences_1.C0.ESC + mod + direction;\n    };\n    return AltClickHandler;\n}());\nexports.AltClickHandler = AltClickHandler;\nfunction repeat(count, str) {\n    count = Math.floor(count);\n    var rpt = '';\n    for (var i = 0; i < count; i++) {\n        rpt += str;\n    }\n    return rpt;\n}\n//# sourceMappingURL=AltClickHandler.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Lifecycle_1 = require(\"./common/Lifecycle\");\nvar TextDecoder_1 = require(\"./core/input/TextDecoder\");\nfunction r(low, high) {\n    var c = high - low;\n    var arr = new Array(c);\n    while (c--) {\n        arr[c] = --high;\n    }\n    return arr;\n}\nvar TransitionTable = (function () {\n    function TransitionTable(length) {\n        this.table = (typeof Uint8Array === 'undefined')\n            ? new Array(length)\n            : new Uint8Array(length);\n    }\n    TransitionTable.prototype.add = function (code, state, action, next) {\n        this.table[state << 8 | code] = ((action | 0) << 4) | ((next === undefined) ? state : next);\n    };\n    TransitionTable.prototype.addMany = function (codes, state, action, next) {\n        for (var i = 0; i < codes.length; i++) {\n            this.add(codes[i], state, action, next);\n        }\n    };\n    return TransitionTable;\n}());\nexports.TransitionTable = TransitionTable;\nvar PRINTABLES = r(0x20, 0x7f);\nvar EXECUTABLES = r(0x00, 0x18);\nEXECUTABLES.push(0x19);\nEXECUTABLES.push.apply(EXECUTABLES, r(0x1c, 0x20));\nvar NON_ASCII_PRINTABLE = 0xA0;\nexports.VT500_TRANSITION_TABLE = (function () {\n    var table = new TransitionTable(4095);\n    var states = r(0, 13 + 1);\n    var state;\n    for (state in states) {\n        for (var code = 0; code <= NON_ASCII_PRINTABLE; ++code) {\n            table.add(code, state, 1, 0);\n        }\n    }\n    table.addMany(PRINTABLES, 0, 2, 0);\n    for (state in states) {\n        table.addMany([0x18, 0x1a, 0x99, 0x9a], state, 3, 0);\n        table.addMany(r(0x80, 0x90), state, 3, 0);\n        table.addMany(r(0x90, 0x98), state, 3, 0);\n        table.add(0x9c, state, 0, 0);\n        table.add(0x1b, state, 11, 1);\n        table.add(0x9d, state, 4, 8);\n        table.addMany([0x98, 0x9e, 0x9f], state, 0, 7);\n        table.add(0x9b, state, 11, 3);\n        table.add(0x90, state, 11, 9);\n    }\n    table.addMany(EXECUTABLES, 0, 3, 0);\n    table.addMany(EXECUTABLES, 1, 3, 1);\n    table.add(0x7f, 1, 0, 1);\n    table.addMany(EXECUTABLES, 8, 0, 8);\n    table.addMany(EXECUTABLES, 3, 3, 3);\n    table.add(0x7f, 3, 0, 3);\n    table.addMany(EXECUTABLES, 4, 3, 4);\n    table.add(0x7f, 4, 0, 4);\n    table.addMany(EXECUTABLES, 6, 3, 6);\n    table.addMany(EXECUTABLES, 5, 3, 5);\n    table.add(0x7f, 5, 0, 5);\n    table.addMany(EXECUTABLES, 2, 3, 2);\n    table.add(0x7f, 2, 0, 2);\n    table.add(0x5d, 1, 4, 8);\n    table.addMany(PRINTABLES, 8, 5, 8);\n    table.add(0x7f, 8, 5, 8);\n    table.addMany([0x9c, 0x1b, 0x18, 0x1a, 0x07], 8, 6, 0);\n    table.addMany(r(0x1c, 0x20), 8, 0, 8);\n    table.addMany([0x58, 0x5e, 0x5f], 1, 0, 7);\n    table.addMany(PRINTABLES, 7, 0, 7);\n    table.addMany(EXECUTABLES, 7, 0, 7);\n    table.add(0x9c, 7, 0, 0);\n    table.add(0x7f, 7, 0, 7);\n    table.add(0x5b, 1, 11, 3);\n    table.addMany(r(0x40, 0x7f), 3, 7, 0);\n    table.addMany(r(0x30, 0x3a), 3, 8, 4);\n    table.add(0x3b, 3, 8, 4);\n    table.addMany([0x3c, 0x3d, 0x3e, 0x3f], 3, 9, 4);\n    table.addMany(r(0x30, 0x3a), 4, 8, 4);\n    table.add(0x3b, 4, 8, 4);\n    table.addMany(r(0x40, 0x7f), 4, 7, 0);\n    table.addMany([0x3a, 0x3c, 0x3d, 0x3e, 0x3f], 4, 0, 6);\n    table.addMany(r(0x20, 0x40), 6, 0, 6);\n    table.add(0x7f, 6, 0, 6);\n    table.addMany(r(0x40, 0x7f), 6, 0, 0);\n    table.add(0x3a, 3, 0, 6);\n    table.addMany(r(0x20, 0x30), 3, 9, 5);\n    table.addMany(r(0x20, 0x30), 5, 9, 5);\n    table.addMany(r(0x30, 0x40), 5, 0, 6);\n    table.addMany(r(0x40, 0x7f), 5, 7, 0);\n    table.addMany(r(0x20, 0x30), 4, 9, 5);\n    table.addMany(r(0x20, 0x30), 1, 9, 2);\n    table.addMany(r(0x20, 0x30), 2, 9, 2);\n    table.addMany(r(0x30, 0x7f), 2, 10, 0);\n    table.addMany(r(0x30, 0x50), 1, 10, 0);\n    table.addMany(r(0x51, 0x58), 1, 10, 0);\n    table.addMany([0x59, 0x5a, 0x5c], 1, 10, 0);\n    table.addMany(r(0x60, 0x7f), 1, 10, 0);\n    table.add(0x50, 1, 11, 9);\n    table.addMany(EXECUTABLES, 9, 0, 9);\n    table.add(0x7f, 9, 0, 9);\n    table.addMany(r(0x1c, 0x20), 9, 0, 9);\n    table.addMany(r(0x20, 0x30), 9, 9, 12);\n    table.add(0x3a, 9, 0, 11);\n    table.addMany(r(0x30, 0x3a), 9, 8, 10);\n    table.add(0x3b, 9, 8, 10);\n    table.addMany([0x3c, 0x3d, 0x3e, 0x3f], 9, 9, 10);\n    table.addMany(EXECUTABLES, 11, 0, 11);\n    table.addMany(r(0x20, 0x80), 11, 0, 11);\n    table.addMany(r(0x1c, 0x20), 11, 0, 11);\n    table.addMany(EXECUTABLES, 10, 0, 10);\n    table.add(0x7f, 10, 0, 10);\n    table.addMany(r(0x1c, 0x20), 10, 0, 10);\n    table.addMany(r(0x30, 0x3a), 10, 8, 10);\n    table.add(0x3b, 10, 8, 10);\n    table.addMany([0x3a, 0x3c, 0x3d, 0x3e, 0x3f], 10, 0, 11);\n    table.addMany(r(0x20, 0x30), 10, 9, 12);\n    table.addMany(EXECUTABLES, 12, 0, 12);\n    table.add(0x7f, 12, 0, 12);\n    table.addMany(r(0x1c, 0x20), 12, 0, 12);\n    table.addMany(r(0x20, 0x30), 12, 9, 12);\n    table.addMany(r(0x30, 0x40), 12, 0, 11);\n    table.addMany(r(0x40, 0x7f), 12, 12, 13);\n    table.addMany(r(0x40, 0x7f), 10, 12, 13);\n    table.addMany(r(0x40, 0x7f), 9, 12, 13);\n    table.addMany(EXECUTABLES, 13, 13, 13);\n    table.addMany(PRINTABLES, 13, 13, 13);\n    table.add(0x7f, 13, 0, 13);\n    table.addMany([0x1b, 0x9c], 13, 14, 0);\n    table.add(NON_ASCII_PRINTABLE, 8, 5, 8);\n    return table;\n})();\nvar DcsDummy = (function () {\n    function DcsDummy() {\n    }\n    DcsDummy.prototype.hook = function (collect, params, flag) { };\n    DcsDummy.prototype.put = function (data, start, end) { };\n    DcsDummy.prototype.unhook = function () { };\n    return DcsDummy;\n}());\nvar EscapeSequenceParser = (function (_super) {\n    __extends(EscapeSequenceParser, _super);\n    function EscapeSequenceParser(TRANSITIONS) {\n        if (TRANSITIONS === void 0) { TRANSITIONS = exports.VT500_TRANSITION_TABLE; }\n        var _this = _super.call(this) || this;\n        _this.TRANSITIONS = TRANSITIONS;\n        _this.initialState = 0;\n        _this.currentState = _this.initialState;\n        _this._osc = '';\n        _this._params = [0];\n        _this._collect = '';\n        _this._printHandlerFb = function (data, start, end) { };\n        _this._executeHandlerFb = function (code) { };\n        _this._csiHandlerFb = function (collect, params, flag) { };\n        _this._escHandlerFb = function (collect, flag) { };\n        _this._oscHandlerFb = function (identifier, data) { };\n        _this._dcsHandlerFb = new DcsDummy();\n        _this._errorHandlerFb = function (state) { return state; };\n        _this._printHandler = _this._printHandlerFb;\n        _this._executeHandlers = Object.create(null);\n        _this._csiHandlers = Object.create(null);\n        _this._escHandlers = Object.create(null);\n        _this._oscHandlers = Object.create(null);\n        _this._dcsHandlers = Object.create(null);\n        _this._activeDcsHandler = null;\n        _this._errorHandler = _this._errorHandlerFb;\n        _this.setEscHandler('\\\\', function () { });\n        return _this;\n    }\n    EscapeSequenceParser.prototype.dispose = function () {\n        this._printHandlerFb = null;\n        this._executeHandlerFb = null;\n        this._csiHandlerFb = null;\n        this._escHandlerFb = null;\n        this._oscHandlerFb = null;\n        this._dcsHandlerFb = null;\n        this._errorHandlerFb = null;\n        this._printHandler = null;\n        this._executeHandlers = null;\n        this._escHandlers = null;\n        this._csiHandlers = null;\n        this._oscHandlers = null;\n        this._dcsHandlers = null;\n        this._activeDcsHandler = null;\n        this._errorHandler = null;\n    };\n    EscapeSequenceParser.prototype.setPrintHandler = function (callback) {\n        this._printHandler = callback;\n    };\n    EscapeSequenceParser.prototype.clearPrintHandler = function () {\n        this._printHandler = this._printHandlerFb;\n    };\n    EscapeSequenceParser.prototype.setExecuteHandler = function (flag, callback) {\n        this._executeHandlers[flag.charCodeAt(0)] = callback;\n    };\n    EscapeSequenceParser.prototype.clearExecuteHandler = function (flag) {\n        if (this._executeHandlers[flag.charCodeAt(0)])\n            delete this._executeHandlers[flag.charCodeAt(0)];\n    };\n    EscapeSequenceParser.prototype.setExecuteHandlerFallback = function (callback) {\n        this._executeHandlerFb = callback;\n    };\n    EscapeSequenceParser.prototype.addCsiHandler = function (flag, callback) {\n        var index = flag.charCodeAt(0);\n        if (this._csiHandlers[index] === undefined) {\n            this._csiHandlers[index] = [];\n        }\n        var handlerList = this._csiHandlers[index];\n        handlerList.push(callback);\n        return {\n            dispose: function () {\n                var handlerIndex = handlerList.indexOf(callback);\n                if (handlerIndex !== -1) {\n                    handlerList.splice(handlerIndex, 1);\n                }\n            }\n        };\n    };\n    EscapeSequenceParser.prototype.setCsiHandler = function (flag, callback) {\n        this._csiHandlers[flag.charCodeAt(0)] = [callback];\n    };\n    EscapeSequenceParser.prototype.clearCsiHandler = function (flag) {\n        if (this._csiHandlers[flag.charCodeAt(0)])\n            delete this._csiHandlers[flag.charCodeAt(0)];\n    };\n    EscapeSequenceParser.prototype.setCsiHandlerFallback = function (callback) {\n        this._csiHandlerFb = callback;\n    };\n    EscapeSequenceParser.prototype.setEscHandler = function (collectAndFlag, callback) {\n        this._escHandlers[collectAndFlag] = callback;\n    };\n    EscapeSequenceParser.prototype.clearEscHandler = function (collectAndFlag) {\n        if (this._escHandlers[collectAndFlag])\n            delete this._escHandlers[collectAndFlag];\n    };\n    EscapeSequenceParser.prototype.setEscHandlerFallback = function (callback) {\n        this._escHandlerFb = callback;\n    };\n    EscapeSequenceParser.prototype.addOscHandler = function (ident, callback) {\n        if (this._oscHandlers[ident] === undefined) {\n            this._oscHandlers[ident] = [];\n        }\n        var handlerList = this._oscHandlers[ident];\n        handlerList.push(callback);\n        return {\n            dispose: function () {\n                var handlerIndex = handlerList.indexOf(callback);\n                if (handlerIndex !== -1) {\n                    handlerList.splice(handlerIndex, 1);\n                }\n            }\n        };\n    };\n    EscapeSequenceParser.prototype.setOscHandler = function (ident, callback) {\n        this._oscHandlers[ident] = [callback];\n    };\n    EscapeSequenceParser.prototype.clearOscHandler = function (ident) {\n        if (this._oscHandlers[ident])\n            delete this._oscHandlers[ident];\n    };\n    EscapeSequenceParser.prototype.setOscHandlerFallback = function (callback) {\n        this._oscHandlerFb = callback;\n    };\n    EscapeSequenceParser.prototype.setDcsHandler = function (collectAndFlag, handler) {\n        this._dcsHandlers[collectAndFlag] = handler;\n    };\n    EscapeSequenceParser.prototype.clearDcsHandler = function (collectAndFlag) {\n        if (this._dcsHandlers[collectAndFlag])\n            delete this._dcsHandlers[collectAndFlag];\n    };\n    EscapeSequenceParser.prototype.setDcsHandlerFallback = function (handler) {\n        this._dcsHandlerFb = handler;\n    };\n    EscapeSequenceParser.prototype.setErrorHandler = function (callback) {\n        this._errorHandler = callback;\n    };\n    EscapeSequenceParser.prototype.clearErrorHandler = function () {\n        this._errorHandler = this._errorHandlerFb;\n    };\n    EscapeSequenceParser.prototype.reset = function () {\n        this.currentState = this.initialState;\n        this._osc = '';\n        this._params = [0];\n        this._collect = '';\n        this._activeDcsHandler = null;\n    };\n    EscapeSequenceParser.prototype.parse = function (data, length) {\n        var code = 0;\n        var transition = 0;\n        var error = false;\n        var currentState = this.currentState;\n        var print = -1;\n        var dcs = -1;\n        var osc = this._osc;\n        var collect = this._collect;\n        var params = this._params;\n        var table = this.TRANSITIONS.table;\n        var dcsHandler = this._activeDcsHandler;\n        var callback = null;\n        for (var i = 0; i < length; ++i) {\n            code = data[i];\n            if (currentState === 0 && code > 0x1f && code < 0x80) {\n                print = (~print) ? print : i;\n                do\n                    i++;\n                while (i < length && data[i] > 0x1f && data[i] < 0x80);\n                i--;\n                continue;\n            }\n            if (currentState === 4 && (code > 0x2f && code < 0x39)) {\n                params[params.length - 1] = params[params.length - 1] * 10 + code - 48;\n                continue;\n            }\n            transition = table[currentState << 8 | (code < 0xa0 ? code : NON_ASCII_PRINTABLE)];\n            switch (transition >> 4) {\n                case 2:\n                    print = (~print) ? print : i;\n                    break;\n                case 3:\n                    if (~print) {\n                        this._printHandler(data, print, i);\n                        print = -1;\n                    }\n                    callback = this._executeHandlers[code];\n                    if (callback)\n                        callback();\n                    else\n                        this._executeHandlerFb(code);\n                    break;\n                case 0:\n                    if (~print) {\n                        this._printHandler(data, print, i);\n                        print = -1;\n                    }\n                    else if (~dcs) {\n                        dcsHandler.put(data, dcs, i);\n                        dcs = -1;\n                    }\n                    break;\n                case 1:\n                    if (code > 0x9f) {\n                        switch (currentState) {\n                            case 0:\n                                print = (~print) ? print : i;\n                                break;\n                            case 6:\n                                transition |= 6;\n                                break;\n                            case 11:\n                                transition |= 11;\n                                break;\n                            case 13:\n                                dcs = (~dcs) ? dcs : i;\n                                transition |= 13;\n                                break;\n                            default:\n                                error = true;\n                        }\n                    }\n                    else {\n                        error = true;\n                    }\n                    if (error) {\n                        var inject = this._errorHandler({\n                            position: i,\n                            code: code,\n                            currentState: currentState,\n                            print: print,\n                            dcs: dcs,\n                            osc: osc,\n                            collect: collect,\n                            params: params,\n                            abort: false\n                        });\n                        if (inject.abort)\n                            return;\n                        error = false;\n                    }\n                    break;\n                case 7:\n                    var handlers = this._csiHandlers[code];\n                    var j = handlers ? handlers.length - 1 : -1;\n                    for (; j >= 0; j--) {\n                        if (handlers[j](params, collect) !== false) {\n                            break;\n                        }\n                    }\n                    if (j < 0) {\n                        this._csiHandlerFb(collect, params, code);\n                    }\n                    break;\n                case 8:\n                    if (code === 0x3b)\n                        params.push(0);\n                    else\n                        params[params.length - 1] = params[params.length - 1] * 10 + code - 48;\n                    break;\n                case 9:\n                    collect += String.fromCharCode(code);\n                    break;\n                case 10:\n                    callback = this._escHandlers[collect + String.fromCharCode(code)];\n                    if (callback)\n                        callback(collect, code);\n                    else\n                        this._escHandlerFb(collect, code);\n                    break;\n                case 11:\n                    if (~print) {\n                        this._printHandler(data, print, i);\n                        print = -1;\n                    }\n                    osc = '';\n                    params = [0];\n                    collect = '';\n                    dcs = -1;\n                    break;\n                case 12:\n                    dcsHandler = this._dcsHandlers[collect + String.fromCharCode(code)];\n                    if (!dcsHandler)\n                        dcsHandler = this._dcsHandlerFb;\n                    dcsHandler.hook(collect, params, code);\n                    break;\n                case 13:\n                    dcs = (~dcs) ? dcs : i;\n                    break;\n                case 14:\n                    if (dcsHandler) {\n                        if (~dcs)\n                            dcsHandler.put(data, dcs, i);\n                        dcsHandler.unhook();\n                        dcsHandler = null;\n                    }\n                    if (code === 0x1b)\n                        transition |= 1;\n                    osc = '';\n                    params = [0];\n                    collect = '';\n                    dcs = -1;\n                    break;\n                case 4:\n                    if (~print) {\n                        this._printHandler(data, print, i);\n                        print = -1;\n                    }\n                    osc = '';\n                    break;\n                case 5:\n                    for (var j_1 = i + 1;; j_1++) {\n                        if (j_1 >= length\n                            || (code = data[j_1]) < 0x20\n                            || (code > 0x7f && code <= 0x9f)) {\n                            osc += TextDecoder_1.utf32ToString(data, i, j_1);\n                            i = j_1 - 1;\n                            break;\n                        }\n                    }\n                    break;\n                case 6:\n                    if (osc && code !== 0x18 && code !== 0x1a) {\n                        var idx = osc.indexOf(';');\n                        if (idx === -1) {\n                            this._oscHandlerFb(-1, osc);\n                        }\n                        else {\n                            var identifier = parseInt(osc.substring(0, idx));\n                            var content = osc.substring(idx + 1);\n                            var handlers_1 = this._oscHandlers[identifier];\n                            var j_2 = handlers_1 ? handlers_1.length - 1 : -1;\n                            for (; j_2 >= 0; j_2--) {\n                                if (handlers_1[j_2](content) !== false) {\n                                    break;\n                                }\n                            }\n                            if (j_2 < 0) {\n                                this._oscHandlerFb(identifier, content);\n                            }\n                        }\n                    }\n                    if (code === 0x1b)\n                        transition |= 1;\n                    osc = '';\n                    params = [0];\n                    collect = '';\n                    dcs = -1;\n                    break;\n            }\n            currentState = transition & 15;\n        }\n        if (currentState === 0 && ~print) {\n            this._printHandler(data, print, length);\n        }\n        else if (currentState === 13 && ~dcs && dcsHandler) {\n            dcsHandler.put(data, dcs, length);\n        }\n        this._osc = osc;\n        this._collect = collect;\n        this._params = params;\n        this._activeDcsHandler = dcsHandler;\n        this.currentState = currentState;\n    };\n    return EscapeSequenceParser;\n}(Lifecycle_1.Disposable));\nexports.EscapeSequenceParser = EscapeSequenceParser;\n//# sourceMappingURL=EscapeSequenceParser.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LRUMap = (function () {\n    function LRUMap(capacity) {\n        this.capacity = capacity;\n        this._map = {};\n        this._head = null;\n        this._tail = null;\n        this._nodePool = [];\n        this.size = 0;\n    }\n    LRUMap.prototype._unlinkNode = function (node) {\n        var prev = node.prev;\n        var next = node.next;\n        if (node === this._head) {\n            this._head = next;\n        }\n        if (node === this._tail) {\n            this._tail = prev;\n        }\n        if (prev !== null) {\n            prev.next = next;\n        }\n        if (next !== null) {\n            next.prev = prev;\n        }\n    };\n    LRUMap.prototype._appendNode = function (node) {\n        var tail = this._tail;\n        if (tail !== null) {\n            tail.next = node;\n        }\n        node.prev = tail;\n        node.next = null;\n        this._tail = node;\n        if (this._head === null) {\n            this._head = node;\n        }\n    };\n    LRUMap.prototype.prealloc = function (count) {\n        var nodePool = this._nodePool;\n        for (var i = 0; i < count; i++) {\n            nodePool.push({\n                prev: null,\n                next: null,\n                key: null,\n                value: null\n            });\n        }\n    };\n    LRUMap.prototype.get = function (key) {\n        var node = this._map[key];\n        if (node !== undefined) {\n            this._unlinkNode(node);\n            this._appendNode(node);\n            return node.value;\n        }\n        return null;\n    };\n    LRUMap.prototype.peekValue = function (key) {\n        var node = this._map[key];\n        if (node !== undefined) {\n            return node.value;\n        }\n        return null;\n    };\n    LRUMap.prototype.peek = function () {\n        var head = this._head;\n        return head === null ? null : head.value;\n    };\n    LRUMap.prototype.set = function (key, value) {\n        var node = this._map[key];\n        if (node !== undefined) {\n            node = this._map[key];\n            this._unlinkNode(node);\n            node.value = value;\n        }\n        else if (this.size >= this.capacity) {\n            node = this._head;\n            this._unlinkNode(node);\n            delete this._map[node.key];\n            node.key = key;\n            node.value = value;\n            this._map[key] = node;\n        }\n        else {\n            var nodePool = this._nodePool;\n            if (nodePool.length > 0) {\n                node = nodePool.pop();\n                node.key = key;\n                node.value = value;\n            }\n            else {\n                node = {\n                    prev: null,\n                    next: null,\n                    key: key,\n                    value: value\n                };\n            }\n            this._map[key] = node;\n            this.size++;\n        }\n        this._appendNode(node);\n    };\n    return LRUMap;\n}());\nexports.default = LRUMap;\n//# sourceMappingURL=LRUMap.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MouseZoneManager_1 = require(\"./MouseZoneManager\");\nvar CharWidth_1 = require(\"./CharWidth\");\nvar EventEmitter2_1 = require(\"./common/EventEmitter2\");\nvar Linkifier = (function () {\n    function Linkifier(_terminal) {\n        this._terminal = _terminal;\n        this._linkMatchers = [];\n        this._nextLinkMatcherId = 0;\n        this._onLinkHover = new EventEmitter2_1.EventEmitter2();\n        this._onLinkLeave = new EventEmitter2_1.EventEmitter2();\n        this._onLinkTooltip = new EventEmitter2_1.EventEmitter2();\n        this._rowsToLinkify = {\n            start: null,\n            end: null\n        };\n    }\n    Object.defineProperty(Linkifier.prototype, \"onLinkHover\", {\n        get: function () { return this._onLinkHover.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Linkifier.prototype, \"onLinkLeave\", {\n        get: function () { return this._onLinkLeave.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Linkifier.prototype, \"onLinkTooltip\", {\n        get: function () { return this._onLinkTooltip.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Linkifier.prototype.attachToDom = function (mouseZoneManager) {\n        this._mouseZoneManager = mouseZoneManager;\n    };\n    Linkifier.prototype.linkifyRows = function (start, end) {\n        var _this = this;\n        if (!this._mouseZoneManager) {\n            return;\n        }\n        if (this._rowsToLinkify.start === null) {\n            this._rowsToLinkify.start = start;\n            this._rowsToLinkify.end = end;\n        }\n        else {\n            this._rowsToLinkify.start = Math.min(this._rowsToLinkify.start, start);\n            this._rowsToLinkify.end = Math.max(this._rowsToLinkify.end, end);\n        }\n        this._mouseZoneManager.clearAll(start, end);\n        if (this._rowsTimeoutId) {\n            clearTimeout(this._rowsTimeoutId);\n        }\n        this._rowsTimeoutId = setTimeout(function () { return _this._linkifyRows(); }, Linkifier.TIME_BEFORE_LINKIFY);\n    };\n    Linkifier.prototype._linkifyRows = function () {\n        this._rowsTimeoutId = null;\n        var buffer = this._terminal.buffer;\n        var absoluteRowIndexStart = buffer.ydisp + this._rowsToLinkify.start;\n        if (absoluteRowIndexStart >= buffer.lines.length) {\n            return;\n        }\n        var absoluteRowIndexEnd = buffer.ydisp + Math.min(this._rowsToLinkify.end, this._terminal.rows) + 1;\n        var overscanLineLimit = Math.ceil(Linkifier.OVERSCAN_CHAR_LIMIT / this._terminal.cols);\n        var iterator = this._terminal.buffer.iterator(false, absoluteRowIndexStart, absoluteRowIndexEnd, overscanLineLimit, overscanLineLimit);\n        while (iterator.hasNext()) {\n            var lineData = iterator.next();\n            for (var i = 0; i < this._linkMatchers.length; i++) {\n                this._doLinkifyRow(lineData.range.first, lineData.content, this._linkMatchers[i]);\n            }\n        }\n        this._rowsToLinkify.start = null;\n        this._rowsToLinkify.end = null;\n    };\n    Linkifier.prototype.registerLinkMatcher = function (regex, handler, options) {\n        if (options === void 0) { options = {}; }\n        if (!handler) {\n            throw new Error('handler must be defined');\n        }\n        var matcher = {\n            id: this._nextLinkMatcherId++,\n            regex: regex,\n            handler: handler,\n            matchIndex: options.matchIndex,\n            validationCallback: options.validationCallback,\n            hoverTooltipCallback: options.tooltipCallback,\n            hoverLeaveCallback: options.leaveCallback,\n            willLinkActivate: options.willLinkActivate,\n            priority: options.priority || 0\n        };\n        this._addLinkMatcherToList(matcher);\n        return matcher.id;\n    };\n    Linkifier.prototype._addLinkMatcherToList = function (matcher) {\n        if (this._linkMatchers.length === 0) {\n            this._linkMatchers.push(matcher);\n            return;\n        }\n        for (var i = this._linkMatchers.length - 1; i >= 0; i--) {\n            if (matcher.priority <= this._linkMatchers[i].priority) {\n                this._linkMatchers.splice(i + 1, 0, matcher);\n                return;\n            }\n        }\n        this._linkMatchers.splice(0, 0, matcher);\n    };\n    Linkifier.prototype.deregisterLinkMatcher = function (matcherId) {\n        for (var i = 0; i < this._linkMatchers.length; i++) {\n            if (this._linkMatchers[i].id === matcherId) {\n                this._linkMatchers.splice(i, 1);\n                return true;\n            }\n        }\n        return false;\n    };\n    Linkifier.prototype._doLinkifyRow = function (rowIndex, text, matcher) {\n        var _this = this;\n        var rex = new RegExp(matcher.regex.source, matcher.regex.flags + 'g');\n        var match;\n        var stringIndex = -1;\n        var _loop_1 = function () {\n            var uri = match[typeof matcher.matchIndex !== 'number' ? 0 : matcher.matchIndex];\n            if (!uri) {\n                if (this_1._terminal.debug) {\n                    console.log({ match: match, matcher: matcher });\n                    throw new Error('match found without corresponding matchIndex');\n                }\n                return \"break\";\n            }\n            stringIndex = text.indexOf(uri, stringIndex + 1);\n            rex.lastIndex = stringIndex + uri.length;\n            if (stringIndex < 0) {\n                return \"break\";\n            }\n            var bufferIndex = this_1._terminal.buffer.stringIndexToBufferIndex(rowIndex, stringIndex);\n            if (bufferIndex[0] < 0) {\n                return \"break\";\n            }\n            var line = this_1._terminal.buffer.lines.get(bufferIndex[0]);\n            var attr = line.getFg(bufferIndex[1]);\n            var fg;\n            if (attr) {\n                fg = (attr >> 9) & 0x1ff;\n            }\n            if (matcher.validationCallback) {\n                matcher.validationCallback(uri, function (isValid) {\n                    if (_this._rowsTimeoutId) {\n                        return;\n                    }\n                    if (isValid) {\n                        _this._addLink(bufferIndex[1], bufferIndex[0] - _this._terminal.buffer.ydisp, uri, matcher, fg);\n                    }\n                });\n            }\n            else {\n                this_1._addLink(bufferIndex[1], bufferIndex[0] - this_1._terminal.buffer.ydisp, uri, matcher, fg);\n            }\n        };\n        var this_1 = this;\n        while ((match = rex.exec(text)) !== null) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Linkifier.prototype._addLink = function (x, y, uri, matcher, fg) {\n        var _this = this;\n        var width = CharWidth_1.getStringCellWidth(uri);\n        var x1 = x % this._terminal.cols;\n        var y1 = y + Math.floor(x / this._terminal.cols);\n        var x2 = (x1 + width) % this._terminal.cols;\n        var y2 = y1 + Math.floor((x1 + width) / this._terminal.cols);\n        if (x2 === 0) {\n            x2 = this._terminal.cols;\n            y2--;\n        }\n        this._mouseZoneManager.add(new MouseZoneManager_1.MouseZone(x1 + 1, y1 + 1, x2 + 1, y2 + 1, function (e) {\n            if (matcher.handler) {\n                return matcher.handler(e, uri);\n            }\n            window.open(uri, '_blank');\n        }, function () {\n            _this._onLinkHover.fire(_this._createLinkHoverEvent(x1, y1, x2, y2, fg));\n            _this._terminal.element.classList.add('xterm-cursor-pointer');\n        }, function (e) {\n            _this._onLinkTooltip.fire(_this._createLinkHoverEvent(x1, y1, x2, y2, fg));\n            if (matcher.hoverTooltipCallback) {\n                matcher.hoverTooltipCallback(e, uri);\n            }\n        }, function () {\n            _this._onLinkLeave.fire(_this._createLinkHoverEvent(x1, y1, x2, y2, fg));\n            _this._terminal.element.classList.remove('xterm-cursor-pointer');\n            if (matcher.hoverLeaveCallback) {\n                matcher.hoverLeaveCallback();\n            }\n        }, function (e) {\n            if (matcher.willLinkActivate) {\n                return matcher.willLinkActivate(e, uri);\n            }\n            return true;\n        }));\n    };\n    Linkifier.prototype._createLinkHoverEvent = function (x1, y1, x2, y2, fg) {\n        return { x1: x1, y1: y1, x2: x2, y2: y2, cols: this._terminal.cols, fg: fg };\n    };\n    Linkifier.TIME_BEFORE_LINKIFY = 200;\n    Linkifier.OVERSCAN_CHAR_LIMIT = 2000;\n    return Linkifier;\n}());\nexports.Linkifier = Linkifier;\n//# sourceMappingURL=Linkifier.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MouseHelper = (function () {\n    function MouseHelper(_renderer) {\n        this._renderer = _renderer;\n    }\n    MouseHelper.prototype.setRenderer = function (renderer) {\n        this._renderer = renderer;\n    };\n    MouseHelper.getCoordsRelativeToElement = function (event, element) {\n        var rect = element.getBoundingClientRect();\n        return [event.clientX - rect.left, event.clientY - rect.top];\n    };\n    MouseHelper.prototype.getCoords = function (event, element, charMeasure, colCount, rowCount, isSelection) {\n        if (!charMeasure.width || !charMeasure.height) {\n            return null;\n        }\n        var coords = MouseHelper.getCoordsRelativeToElement(event, element);\n        if (!coords) {\n            return null;\n        }\n        coords[0] = Math.ceil((coords[0] + (isSelection ? this._renderer.dimensions.actualCellWidth / 2 : 0)) / this._renderer.dimensions.actualCellWidth);\n        coords[1] = Math.ceil(coords[1] / this._renderer.dimensions.actualCellHeight);\n        coords[0] = Math.min(Math.max(coords[0], 1), colCount + (isSelection ? 1 : 0));\n        coords[1] = Math.min(Math.max(coords[1], 1), rowCount);\n        return coords;\n    };\n    MouseHelper.prototype.getRawByteCoords = function (event, element, charMeasure, colCount, rowCount) {\n        var coords = this.getCoords(event, element, charMeasure, colCount, rowCount);\n        var x = coords[0];\n        var y = coords[1];\n        x += 32;\n        y += 32;\n        return { x: x, y: y };\n    };\n    return MouseHelper;\n}());\nexports.MouseHelper = MouseHelper;\n//# sourceMappingURL=MouseHelper.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction proposeGeometry(term) {\n    if (!term.element.parentElement) {\n        return null;\n    }\n    var parentElementStyle = window.getComputedStyle(term.element.parentElement);\n    var parentElementHeight = parseInt(parentElementStyle.getPropertyValue('height'));\n    var parentElementWidth = Math.max(0, parseInt(parentElementStyle.getPropertyValue('width')));\n    var elementStyle = window.getComputedStyle(term.element);\n    var elementPadding = {\n        top: parseInt(elementStyle.getPropertyValue('padding-top')),\n        bottom: parseInt(elementStyle.getPropertyValue('padding-bottom')),\n        right: parseInt(elementStyle.getPropertyValue('padding-right')),\n        left: parseInt(elementStyle.getPropertyValue('padding-left'))\n    };\n    var elementPaddingVer = elementPadding.top + elementPadding.bottom;\n    var elementPaddingHor = elementPadding.right + elementPadding.left;\n    var availableHeight = parentElementHeight - elementPaddingVer;\n    var availableWidth = parentElementWidth - elementPaddingHor - term._core.viewport.scrollBarWidth;\n    var geometry = {\n        cols: Math.floor(availableWidth / term._core.renderer.dimensions.actualCellWidth),\n        rows: Math.floor(availableHeight / term._core.renderer.dimensions.actualCellHeight)\n    };\n    return geometry;\n}\nexports.proposeGeometry = proposeGeometry;\nfunction fit(term) {\n    var geometry = proposeGeometry(term);\n    if (geometry) {\n        if (term.rows !== geometry.rows || term.cols !== geometry.cols) {\n            term._core.renderer.clear();\n            term.resize(geometry.cols, geometry.rows);\n        }\n    }\n}\nexports.fit = fit;\nfunction apply(terminalConstructor) {\n    terminalConstructor.prototype.proposeGeometry = function () {\n        return proposeGeometry(this);\n    };\n    terminalConstructor.prototype.fit = function () {\n        fit(this);\n    };\n}\nexports.apply = apply;\n//# sourceMappingURL=fit.js.map"],"sourceRoot":""}